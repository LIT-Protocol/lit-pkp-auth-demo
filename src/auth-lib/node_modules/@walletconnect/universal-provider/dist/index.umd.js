(function(Un,wt){typeof exports=="object"&&typeof module<"u"?wt(exports):typeof define=="function"&&define.amd?define(["exports"],wt):(Un=typeof globalThis<"u"?globalThis:Un||self,wt(Un["@walletconnect/universal-provider"]={}))})(this,function(Un){"use strict";var wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Eg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Mn(n){var e=n.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var o=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:function(){return n[s]}})}),t}var Qt={exports:{}},ci=typeof Reflect=="object"?Reflect:null,tf=ci&&typeof ci.apply=="function"?ci.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},Ps;ci&&typeof ci.ownKeys=="function"?Ps=ci.ownKeys:Object.getOwnPropertySymbols?Ps=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ps=function(e){return Object.getOwnPropertyNames(e)};function Sg(n){console&&console.warn&&console.warn(n)}var rf=Number.isNaN||function(e){return e!==e};function st(){st.init.call(this)}Qt.exports=st,Qt.exports.once=Ig,st.EventEmitter=st,st.prototype._events=void 0,st.prototype._eventsCount=0,st.prototype._maxListeners=void 0;var nf=10;function Ts(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(st,"defaultMaxListeners",{enumerable:!0,get:function(){return nf},set:function(n){if(typeof n!="number"||n<0||rf(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");nf=n}}),st.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},st.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||rf(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function sf(n){return n._maxListeners===void 0?st.defaultMaxListeners:n._maxListeners}st.prototype.getMaxListeners=function(){return sf(this)},st.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var o=e==="error",u=this._events;if(u!==void 0)o=o&&u.error===void 0;else if(!o)return!1;if(o){var f;if(t.length>0&&(f=t[0]),f instanceof Error)throw f;var l=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw l.context=f,l}var _=u[e];if(_===void 0)return!1;if(typeof _=="function")tf(_,this,t);else for(var p=_.length,E=ff(_,p),s=0;s<p;++s)tf(E[s],this,t);return!0};function of(n,e,t,s){var o,u,f;if(Ts(t),u=n._events,u===void 0?(u=n._events=Object.create(null),n._eventsCount=0):(u.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),u=n._events),f=u[e]),f===void 0)f=u[e]=t,++n._eventsCount;else if(typeof f=="function"?f=u[e]=s?[t,f]:[f,t]:s?f.unshift(t):f.push(t),o=sf(n),o>0&&f.length>o&&!f.warned){f.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=n,l.type=e,l.count=f.length,Sg(l)}return n}st.prototype.addListener=function(e,t){return of(this,e,t,!1)},st.prototype.on=st.prototype.addListener,st.prototype.prependListener=function(e,t){return of(this,e,t,!0)};function Dg(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function af(n,e,t){var s={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},o=Dg.bind(s);return o.listener=t,s.wrapFn=o,o}st.prototype.once=function(e,t){return Ts(t),this.on(e,af(this,e,t)),this},st.prototype.prependOnceListener=function(e,t){return Ts(t),this.prependListener(e,af(this,e,t)),this},st.prototype.removeListener=function(e,t){var s,o,u,f,l;if(Ts(t),o=this._events,o===void 0)return this;if(s=o[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(u=-1,f=s.length-1;f>=0;f--)if(s[f]===t||s[f].listener===t){l=s[f].listener,u=f;break}if(u<0)return this;u===0?s.shift():xg(s,u),s.length===1&&(o[e]=s[0]),o.removeListener!==void 0&&this.emit("removeListener",e,l||t)}return this},st.prototype.off=st.prototype.removeListener,st.prototype.removeAllListeners=function(e){var t,s,o;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var u=Object.keys(s),f;for(o=0;o<u.length;++o)f=u[o],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this};function uf(n,e,t){var s=n._events;if(s===void 0)return[];var o=s[e];return o===void 0?[]:typeof o=="function"?t?[o.listener||o]:[o]:t?Og(o):ff(o,o.length)}st.prototype.listeners=function(e){return uf(this,e,!0)},st.prototype.rawListeners=function(e){return uf(this,e,!1)},st.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):cf.call(n,e)},st.prototype.listenerCount=cf;function cf(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}st.prototype.eventNames=function(){return this._eventsCount>0?Ps(this._events):[]};function ff(n,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=n[s];return t}function xg(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function Og(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function Ig(n,e){return new Promise(function(t,s){function o(f){n.removeListener(e,u),s(f)}function u(){typeof n.removeListener=="function"&&n.removeListener("error",o),t([].slice.call(arguments))}hf(n,e,u,{once:!0}),e!=="error"&&Ag(n,o,{once:!0})})}function Ag(n,e,t){typeof n.on=="function"&&hf(n,"error",e,t)}function hf(n,e,t,s){if(typeof n.on=="function")s.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function o(u){s.once&&n.removeEventListener(e,o),t(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var Cs={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ca=function(n,e){return ca=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},ca(n,e)};function Pg(n,e){ca(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var fa=function(){return fa=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},fa.apply(this,arguments)};function Tg(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function Cg(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(f=n[l])&&(u=(o<3?f(u):o>3?f(e,t,u):f(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function Rg(n,e){return function(t,s){e(t,s,n)}}function Ng(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Lg(n,e,t,s){function o(u){return u instanceof t?u:new t(function(f){f(u)})}return new(t||(t=Promise))(function(u,f){function l(E){try{p(s.next(E))}catch(T){f(T)}}function _(E){try{p(s.throw(E))}catch(T){f(T)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function Fg(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,f;return f={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function $g(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function Ug(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function ha(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],f;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){f={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(f)throw f.error}}return u}function Mg(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(lf(arguments[e]));return n}function Bg(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],f=0,l=u.length;f<l;f++,o++)s[o]=u[f];return s}function Bi(n){return this instanceof Bi?(this.v=n,this):new Bi(n)}function qg(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(D){s[D]&&(o[D]=function(C){return new Promise(function(R,j){u.push([D,C,R,j])>1||l(D,C)})})}function l(D,C){try{_(s[D](C))}catch(R){T(u[0][3],R)}}function _(D){D.value instanceof Bi?Promise.resolve(D.value.v).then(p,E):T(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function T(D,C){D(C),u.shift(),u.length&&l(u[0][0],u[0][1])}}function Hg(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(f){return(t=!t)?{value:Bi(n[o](f)),done:o==="return"}:u?u(f):f}:u}}function jg(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ha=="function"?ha(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(f){return new Promise(function(l,_){f=n[u](f),o(l,_,f.done,f.value)})}}function o(u,f,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},f)}}function zg(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function Kg(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function Gg(n){return n&&n.__esModule?n:{default:n}}function Wg(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function Vg(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var kg=Object.freeze({__proto__:null,__extends:Pg,get __assign(){return fa},__rest:Tg,__decorate:Cg,__param:Rg,__metadata:Ng,__awaiter:Lg,__generator:Fg,__createBinding:$g,__exportStar:Ug,__values:ha,__read:lf,__spread:Mg,__spreadArrays:Bg,__await:Bi,__asyncGenerator:qg,__asyncDelegator:Hg,__asyncValues:jg,__makeTemplateObject:zg,__importStar:Kg,__importDefault:Gg,__classPrivateFieldGet:Wg,__classPrivateFieldSet:Vg}),df=Mn(kg),qi={};Object.defineProperty(qi,"__esModule",{value:!0});function Yg(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}qi.safeJsonParse=Yg;function Jg(n){return typeof n=="string"?n:JSON.stringify(n,(e,t)=>typeof t>"u"?null:t)}qi.safeJsonStringify=Jg;var Hi={exports:{}},pf;function Xg(){return pf||(pf=1,function(){let n;function e(){}n=e,n.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},n.prototype.setItem=function(t,s){this[t]=String(s)},n.prototype.removeItem=function(t){delete this[t]},n.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},n.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof wt<"u"&&wt.localStorage?Hi.exports=wt.localStorage:typeof window<"u"&&window.localStorage?Hi.exports=window.localStorage:Hi.exports=new e}()),Hi.exports}var la={},ji={},gf;function Zg(){if(gf)return ji;gf=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.IKeyValueStorage=void 0;class n{}return ji.IKeyValueStorage=n,ji}var zi={},_f;function Qg(){if(_f)return zi;_f=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.parseEntry=void 0;const n=qi;function e(t){var s;return[t[0],n.safeJsonParse((s=t[1])!==null&&s!==void 0?s:"")]}return zi.parseEntry=e,zi}var yf;function e0(){return yf||(yf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=df;e.__exportStar(Zg(),n),e.__exportStar(Qg(),n)}(la)),la}Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.KeyValueStorage=void 0;const fi=df,vf=qi,t0=fi.__importDefault(Xg()),r0=e0();class bf{constructor(){this.localStorage=t0.default}getKeys(){return fi.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return fi.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(r0.parseEntry)})}getItem(e){return fi.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return vf.safeJsonParse(t)})}setItem(e,t){return fi.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,vf.safeJsonStringify(t))})}removeItem(e){return fi.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Cs.KeyValueStorage=bf;var n0=Cs.default=bf,hi={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var da=function(n,e){return da=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},da(n,e)};function i0(n,e){da(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var pa=function(){return pa=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},pa.apply(this,arguments)};function s0(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function o0(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(f=n[l])&&(u=(o<3?f(u):o>3?f(e,t,u):f(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function a0(n,e){return function(t,s){e(t,s,n)}}function u0(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function c0(n,e,t,s){function o(u){return u instanceof t?u:new t(function(f){f(u)})}return new(t||(t=Promise))(function(u,f){function l(E){try{p(s.next(E))}catch(T){f(T)}}function _(E){try{p(s.throw(E))}catch(T){f(T)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function f0(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,f;return f={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function h0(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function l0(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function ga(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],f;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){f={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(f)throw f.error}}return u}function d0(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(wf(arguments[e]));return n}function p0(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],f=0,l=u.length;f<l;f++,o++)s[o]=u[f];return s}function Ki(n){return this instanceof Ki?(this.v=n,this):new Ki(n)}function g0(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(D){s[D]&&(o[D]=function(C){return new Promise(function(R,j){u.push([D,C,R,j])>1||l(D,C)})})}function l(D,C){try{_(s[D](C))}catch(R){T(u[0][3],R)}}function _(D){D.value instanceof Ki?Promise.resolve(D.value.v).then(p,E):T(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function T(D,C){D(C),u.shift(),u.length&&l(u[0][0],u[0][1])}}function _0(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(f){return(t=!t)?{value:Ki(n[o](f)),done:o==="return"}:u?u(f):f}:u}}function y0(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ga=="function"?ga(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(f){return new Promise(function(l,_){f=n[u](f),o(l,_,f.done,f.value)})}}function o(u,f,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},f)}}function v0(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function b0(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function w0(n){return n&&n.__esModule?n:{default:n}}function m0(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function E0(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var S0=Object.freeze({__proto__:null,__extends:i0,get __assign(){return pa},__rest:s0,__decorate:o0,__param:a0,__metadata:u0,__awaiter:c0,__generator:f0,__createBinding:h0,__exportStar:l0,__values:ga,__read:wf,__spread:d0,__spreadArrays:p0,__await:Ki,__asyncGenerator:g0,__asyncDelegator:_0,__asyncValues:y0,__makeTemplateObject:v0,__importStar:b0,__importDefault:w0,__classPrivateFieldGet:m0,__classPrivateFieldSet:E0}),Rs=Mn(S0),Gi={},_e={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var _a=function(n,e){return _a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},_a(n,e)};function D0(n,e){_a(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ya=function(){return ya=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},ya.apply(this,arguments)};function x0(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function O0(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(f=n[l])&&(u=(o<3?f(u):o>3?f(e,t,u):f(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function I0(n,e){return function(t,s){e(t,s,n)}}function A0(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function P0(n,e,t,s){function o(u){return u instanceof t?u:new t(function(f){f(u)})}return new(t||(t=Promise))(function(u,f){function l(E){try{p(s.next(E))}catch(T){f(T)}}function _(E){try{p(s.throw(E))}catch(T){f(T)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function T0(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,f;return f={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function C0(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function R0(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function va(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],f;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){f={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(f)throw f.error}}return u}function N0(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(mf(arguments[e]));return n}function L0(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],f=0,l=u.length;f<l;f++,o++)s[o]=u[f];return s}function Wi(n){return this instanceof Wi?(this.v=n,this):new Wi(n)}function F0(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(D){s[D]&&(o[D]=function(C){return new Promise(function(R,j){u.push([D,C,R,j])>1||l(D,C)})})}function l(D,C){try{_(s[D](C))}catch(R){T(u[0][3],R)}}function _(D){D.value instanceof Wi?Promise.resolve(D.value.v).then(p,E):T(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function T(D,C){D(C),u.shift(),u.length&&l(u[0][0],u[0][1])}}function $0(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(f){return(t=!t)?{value:Wi(n[o](f)),done:o==="return"}:u?u(f):f}:u}}function U0(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof va=="function"?va(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(f){return new Promise(function(l,_){f=n[u](f),o(l,_,f.done,f.value)})}}function o(u,f,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},f)}}function M0(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function B0(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function q0(n){return n&&n.__esModule?n:{default:n}}function H0(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function j0(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var z0=Object.freeze({__proto__:null,__extends:D0,get __assign(){return ya},__rest:x0,__decorate:O0,__param:I0,__metadata:A0,__awaiter:P0,__generator:T0,__createBinding:C0,__exportStar:R0,__values:va,__read:mf,__spread:N0,__spreadArrays:L0,__await:Wi,__asyncGenerator:F0,__asyncDelegator:$0,__asyncValues:U0,__makeTemplateObject:M0,__importStar:B0,__importDefault:q0,__classPrivateFieldGet:H0,__classPrivateFieldSet:j0}),Ns=Mn(z0),ba={},Vi={},Ef;function K0(){if(Ef)return Vi;Ef=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.delay=void 0;function n(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Vi.delay=n,Vi}var Bn={},wa={},qn={},Sf;function G0(){return Sf||(Sf=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.ONE_THOUSAND=qn.ONE_HUNDRED=void 0,qn.ONE_HUNDRED=100,qn.ONE_THOUSAND=1e3),qn}var ma={},Df;function W0(){return Df||(Df=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(ma)),ma}var xf;function Of(){return xf||(xf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Ns;e.__exportStar(G0(),n),e.__exportStar(W0(),n)}(wa)),wa}var If;function V0(){if(If)return Bn;If=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.fromMiliseconds=Bn.toMiliseconds=void 0;const n=Of();function e(s){return s*n.ONE_THOUSAND}Bn.toMiliseconds=e;function t(s){return Math.floor(s/n.ONE_THOUSAND)}return Bn.fromMiliseconds=t,Bn}var Af;function k0(){return Af||(Af=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Ns;e.__exportStar(K0(),n),e.__exportStar(V0(),n)}(ba)),ba}var li={},Pf;function Y0(){if(Pf)return li;Pf=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return li.Watch=n,li.default=n,li}var Ea={},ki={},Tf;function J0(){if(Tf)return ki;Tf=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.IWatch=void 0;class n{}return ki.IWatch=n,ki}var Cf;function X0(){return Cf||(Cf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ns.__exportStar(J0(),n)}(Ea)),Ea}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Ns;e.__exportStar(k0(),n),e.__exportStar(Y0(),n),e.__exportStar(X0(),n),e.__exportStar(Of(),n)})(_e);var Sa={},Yi={};class Hn{}var Z0=Object.freeze({__proto__:null,IEvents:Hn}),Q0=Mn(Z0),Rf;function e_(){if(Rf)return Yi;Rf=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.IHeartBeat=void 0;const n=Q0;class e extends n.IEvents{constructor(s){super()}}return Yi.IHeartBeat=e,Yi}var Nf;function Lf(){return Nf||(Nf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Rs.__exportStar(e_(),n)}(Sa)),Sa}var Da={},jn={},Ff;function t_(){if(Ff)return jn;Ff=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.HEARTBEAT_EVENTS=jn.HEARTBEAT_INTERVAL=void 0;const n=_e;return jn.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,jn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},jn}var $f;function Uf(){return $f||($f=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Rs.__exportStar(t_(),n)}(Da)),Da}var Mf;function r_(){if(Mf)return Gi;Mf=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.HeartBeat=void 0;const n=Rs,e=Qt.exports,t=_e,s=Lf(),o=Uf();class u extends s.IHeartBeat{constructor(l){super(l),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=l?.interval||o.HEARTBEAT_INTERVAL}static init(l){return n.__awaiter(this,void 0,void 0,function*(){const _=new u(l);return yield _.init(),_})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(l,_){this.events.on(l,_)}once(l,_){this.events.once(l,_)}off(l,_){this.events.off(l,_)}removeListener(l,_){this.events.removeListener(l,_)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Gi.HeartBeat=u,Gi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Rs;e.__exportStar(r_(),n),e.__exportStar(Lf(),n),e.__exportStar(Uf(),n)})(hi);var Je={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xa=function(n,e){return xa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},xa(n,e)};function n_(n,e){xa(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Oa=function(){return Oa=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},Oa.apply(this,arguments)};function i_(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function s_(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(f=n[l])&&(u=(o<3?f(u):o>3?f(e,t,u):f(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function o_(n,e){return function(t,s){e(t,s,n)}}function a_(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function u_(n,e,t,s){function o(u){return u instanceof t?u:new t(function(f){f(u)})}return new(t||(t=Promise))(function(u,f){function l(E){try{p(s.next(E))}catch(T){f(T)}}function _(E){try{p(s.throw(E))}catch(T){f(T)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function c_(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,f;return f={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function f_(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function h_(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Ia(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],f;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){f={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(f)throw f.error}}return u}function l_(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Bf(arguments[e]));return n}function d_(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],f=0,l=u.length;f<l;f++,o++)s[o]=u[f];return s}function Ji(n){return this instanceof Ji?(this.v=n,this):new Ji(n)}function p_(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(D){s[D]&&(o[D]=function(C){return new Promise(function(R,j){u.push([D,C,R,j])>1||l(D,C)})})}function l(D,C){try{_(s[D](C))}catch(R){T(u[0][3],R)}}function _(D){D.value instanceof Ji?Promise.resolve(D.value.v).then(p,E):T(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function T(D,C){D(C),u.shift(),u.length&&l(u[0][0],u[0][1])}}function g_(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(f){return(t=!t)?{value:Ji(n[o](f)),done:o==="return"}:u?u(f):f}:u}}function __(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Ia=="function"?Ia(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(f){return new Promise(function(l,_){f=n[u](f),o(l,_,f.done,f.value)})}}function o(u,f,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},f)}}function y_(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function v_(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function b_(n){return n&&n.__esModule?n:{default:n}}function w_(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function m_(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var E_=Object.freeze({__proto__:null,__extends:n_,get __assign(){return Oa},__rest:i_,__decorate:s_,__param:o_,__metadata:a_,__awaiter:u_,__generator:c_,__createBinding:f_,__exportStar:h_,__values:Ia,__read:Bf,__spread:l_,__spreadArrays:d_,__await:Ji,__asyncGenerator:p_,__asyncDelegator:g_,__asyncValues:__,__makeTemplateObject:y_,__importStar:v_,__importDefault:b_,__classPrivateFieldGet:w_,__classPrivateFieldSet:m_}),S_=Mn(E_),Aa,qf;function D_(){if(qf)return Aa;qf=1;function n(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Aa=e;function e(t,s,o){var u=o&&o.stringify||n,f=1;if(typeof t=="object"&&t!==null){var l=s.length+f;if(l===1)return t;var _=new Array(l);_[0]=u(t);for(var p=1;p<l;p++)_[p]=u(s[p]);return _.join(" ")}if(typeof t!="string")return t;var E=s.length;if(E===0)return t;for(var T="",D=1-f,C=-1,R=t&&t.length||0,j=0;j<R;){if(t.charCodeAt(j)===37&&j+1<R){switch(C=C>-1?C:0,t.charCodeAt(j+1)){case 100:case 102:if(D>=E||s[D]==null)break;C<j&&(T+=t.slice(C,j)),T+=Number(s[D]),C=j+2,j++;break;case 105:if(D>=E||s[D]==null)break;C<j&&(T+=t.slice(C,j)),T+=Math.floor(Number(s[D])),C=j+2,j++;break;case 79:case 111:case 106:if(D>=E||s[D]===void 0)break;C<j&&(T+=t.slice(C,j));var K=typeof s[D];if(K==="string"){T+="'"+s[D]+"'",C=j+2,j++;break}if(K==="function"){T+=s[D].name||"<anonymous>",C=j+2,j++;break}T+=u(s[D]),C=j+2,j++;break;case 115:if(D>=E)break;C<j&&(T+=t.slice(C,j)),T+=String(s[D]),C=j+2,j++;break;case 37:C<j&&(T+=t.slice(C,j)),T+="%",C=j+2,j++,D--;break}++D}++j}return C===-1?t:(C<R&&(T+=t.slice(C)),T)}return Aa}var Pa,Hf;function x_(){if(Hf)return Pa;Hf=1;const n=D_();Pa=o;const e=P().console||{},t={mapHttpRequest:R,mapHttpResponse:R,wrapRequestSerializer:j,wrapResponseSerializer:j,wrapErrorSerializer:j,req:R,res:R,err:D};function s(m,c){return Array.isArray(m)?m.filter(function(V){return V!=="!stdSerializers.err"}):m===!0?Object.keys(c):!1}function o(m){m=m||{},m.browser=m.browser||{};const c=m.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const b=m.browser.write||e;m.browser.write&&(m.browser.asObject=!0);const V=m.serializers||{},Y=s(m.browser.serialize,V);let ie=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ie=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),m.enabled===!1&&(m.level="silent");const de=m.level||"info",w=Object.create(b);w.log||(w.log=K),Object.defineProperty(w,"levelVal",{get:ee}),Object.defineProperty(w,"level",{get:X,set:G});const I={transmit:c,serialize:Y,asObject:m.browser.asObject,levels:ue,timestamp:C(m)};w.levels=o.levels,w.level=de,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=K,w.serializers=V,w._serialize=Y,w._stdErrSerialize=ie,w.child=W,c&&(w._logEvent=T());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function G(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,u(I,w,"error","log"),u(I,w,"fatal","error"),u(I,w,"warn","error"),u(I,w,"info","log"),u(I,w,"debug","log"),u(I,w,"trace","log")}function W(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},Y&&J.serializers&&(re.serializers=J.serializers);const we=re.serializers;if(Y&&we){var oe=Object.assign({},V,we),me=m.browser.serialize===!0?Object.keys(oe):Y;delete J.serializers,_([J],me,oe,this._stdErrSerialize)}function he(ve){this._childLevel=(ve._childLevel|0)+1,this.error=p(ve,J,"error"),this.fatal=p(ve,J,"fatal"),this.warn=p(ve,J,"warn"),this.info=p(ve,J,"info"),this.debug=p(ve,J,"debug"),this.trace=p(ve,J,"trace"),oe&&(this.serializers=oe,this._serialize=me),c&&(this._logEvent=T([].concat(ve._logEvent.bindings,J)))}return he.prototype=this,new he(this)}return w}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:se,epochTime:L,unixTime:M,isoTime:x});function u(m,c,b,V){const Y=Object.getPrototypeOf(c);c[b]=c.levelVal>c.levels.values[b]?K:Y[b]?Y[b]:e[b]||e[V]||K,f(m,c,b)}function f(m,c,b){!m.transmit&&c[b]===K||(c[b]=function(V){return function(){const ie=m.timestamp(),ue=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var w=0;w<ue.length;w++)ue[w]=arguments[w];if(m.serialize&&!m.asObject&&_(ue,this._serialize,this.serializers,this._stdErrSerialize),m.asObject?V.call(de,l(this,b,ue,ie)):V.apply(de,ue),m.transmit){const I=m.transmit.level||c.level,ee=o.levels.values[I],X=o.levels.values[b];if(X<ee)return;E(this,{ts:ie,methodLevel:b,methodValue:X,transmitLevel:I,transmitValue:o.levels.values[m.transmit.level||c.level],send:m.transmit.send,val:c.levelVal},ue)}}}(c[b]))}function l(m,c,b,V){m._serialize&&_(b,m._serialize,m.serializers,m._stdErrSerialize);const Y=b.slice();let ie=Y[0];const ue={};V&&(ue.time=V),ue.level=o.levels.values[c];let de=(m._childLevel|0)+1;if(de<1&&(de=1),ie!==null&&typeof ie=="object"){for(;de--&&typeof Y[0]=="object";)Object.assign(ue,Y.shift());ie=Y.length?n(Y.shift(),Y):void 0}else typeof ie=="string"&&(ie=n(Y.shift(),Y));return ie!==void 0&&(ue.msg=ie),ue}function _(m,c,b,V){for(const Y in m)if(V&&m[Y]instanceof Error)m[Y]=o.stdSerializers.err(m[Y]);else if(typeof m[Y]=="object"&&!Array.isArray(m[Y]))for(const ie in m[Y])c&&c.indexOf(ie)>-1&&ie in b&&(m[Y][ie]=b[ie](m[Y][ie]))}function p(m,c,b){return function(){const V=new Array(1+arguments.length);V[0]=c;for(var Y=1;Y<V.length;Y++)V[Y]=arguments[Y-1];return m[b].apply(this,V)}}function E(m,c,b){const V=c.send,Y=c.ts,ie=c.methodLevel,ue=c.methodValue,de=c.val,w=m._logEvent.bindings;_(b,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=Y,m._logEvent.messages=b.filter(function(I){return w.indexOf(I)===-1}),m._logEvent.level.label=ie,m._logEvent.level.value=ue,V(ie,m._logEvent,de),m._logEvent=T(w)}function T(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function D(m){const c={type:m.constructor.name,msg:m.message,stack:m.stack};for(const b in m)c[b]===void 0&&(c[b]=m[b]);return c}function C(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?se:L}function R(){return{}}function j(m){return m}function K(){}function se(){return!1}function L(){return Date.now()}function M(){return Math.round(Date.now()/1e3)}function x(){return new Date(Date.now()).toISOString()}function P(){function m(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}return Pa}var zn={},jf;function zf(){return jf||(jf=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.PINO_CUSTOM_CONTEXT_KEY=zn.PINO_LOGGER_DEFAULTS=void 0,zn.PINO_LOGGER_DEFAULTS={level:"info"},zn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),zn}var nr={},Kf;function O_(){if(Kf)return nr;Kf=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.generateChildLogger=nr.formatChildLoggerContext=nr.getLoggerContext=nr.setBrowserLoggerContext=nr.getBrowserLoggerContext=nr.getDefaultLoggerOptions=void 0;const n=zf();function e(l){return Object.assign(Object.assign({},l),{level:l?.level||n.PINO_LOGGER_DEFAULTS.level})}nr.getDefaultLoggerOptions=e;function t(l,_=n.PINO_CUSTOM_CONTEXT_KEY){return l[_]||""}nr.getBrowserLoggerContext=t;function s(l,_,p=n.PINO_CUSTOM_CONTEXT_KEY){return l[p]=_,l}nr.setBrowserLoggerContext=s;function o(l,_=n.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof l.bindings>"u"?p=t(l,_):p=l.bindings().context||"",p}nr.getLoggerContext=o;function u(l,_,p=n.PINO_CUSTOM_CONTEXT_KEY){const E=o(l,p);return E.trim()?`${E}/${_}`:_}nr.formatChildLoggerContext=u;function f(l,_,p=n.PINO_CUSTOM_CONTEXT_KEY){const E=u(l,_,p),T=l.child({context:E});return s(T,E,p)}return nr.generateChildLogger=f,nr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=S_,t=e.__importDefault(x_());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(zf(),n),e.__exportStar(O_(),n)})(Je);class I_ extends Hn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class A_ extends Hn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class P_{constructor(e,t){this.logger=e,this.core=t}}class T_ extends Hn{constructor(e,t){super(),this.relayer=e,this.logger=t}}class C_ extends Hn{constructor(e){super()}}class R_{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}}class N_ extends Hn{constructor(e,t){super(),this.relayer=e,this.logger=t}}class L_ extends Hn{constructor(e,t){super(),this.core=e,this.logger=t}}class F_{constructor(e,t){this.projectId=e,this.logger=t}}class $_{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class U_{constructor(e){this.client=e}}const M_=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),B_=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=n.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ta(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return B_(n)}catch{return n}}function Xi(n){return typeof n=="string"?n:M_(n)||""}var Ca={},di={},Ls={},Fs={};Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.BrowserRandomSource=void 0;const Gf=65536;class q_{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=Gf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,Gf)));return t}}Fs.BrowserRandomSource=q_;function H_(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $s={},Er={};Object.defineProperty(Er,"__esModule",{value:!0});function j_(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Er.wipe=j_;var z_={},K_=Object.freeze({__proto__:null,default:z_}),G_=Mn(K_);Object.defineProperty($s,"__esModule",{value:!0}),$s.NodeRandomSource=void 0;const W_=Er;class V_{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof H_<"u"){const e=G_;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,W_.wipe)(t),s}}$s.NodeRandomSource=V_,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.SystemRandomSource=void 0;const k_=Fs,Y_=$s;class J_{constructor(){if(this.isAvailable=!1,this.name="",this._source=new k_.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Y_.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Ls.SystemRandomSource=J_;var Ne={},Wf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(l,_){var p=l>>>16&65535,E=l&65535,T=_>>>16&65535,D=_&65535;return E*D+(p*D+E*T<<16>>>0)|0}n.mul=Math.imul||e;function t(l,_){return l+_|0}n.add=t;function s(l,_){return l-_|0}n.sub=s;function o(l,_){return l<<_|l>>>32-_}n.rotl=o;function u(l,_){return l<<32-_|l>>>_}n.rotr=u;function f(l){return typeof l=="number"&&isFinite(l)&&Math.floor(l)===l}n.isInteger=Number.isInteger||f,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(l){return n.isInteger(l)&&l>=-n.MAX_SAFE_INTEGER&&l<=n.MAX_SAFE_INTEGER}})(Wf),Object.defineProperty(Ne,"__esModule",{value:!0});var Vf=Wf;function X_(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Ne.readInt16BE=X_;function Z_(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Ne.readUint16BE=Z_;function Q_(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Ne.readInt16LE=Q_;function ey(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Ne.readUint16LE=ey;function kf(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>8,e[t+1]=n>>>0,e}Ne.writeUint16BE=kf,Ne.writeInt16BE=kf;function Yf(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e}Ne.writeUint16LE=Yf,Ne.writeInt16LE=Yf;function Ra(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Ne.readInt32BE=Ra;function Na(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Ne.readUint32BE=Na;function La(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Ne.readInt32LE=La;function Fa(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Ne.readUint32LE=Fa;function Us(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>24,e[t+1]=n>>>16,e[t+2]=n>>>8,e[t+3]=n>>>0,e}Ne.writeUint32BE=Us,Ne.writeInt32BE=Us;function Ms(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e[t+2]=n>>>16,e[t+3]=n>>>24,e}Ne.writeUint32LE=Ms,Ne.writeInt32LE=Ms;function ty(n,e){e===void 0&&(e=0);var t=Ra(n,e),s=Ra(n,e+4);return t*4294967296+s-(s>>31)*4294967296}Ne.readInt64BE=ty;function ry(n,e){e===void 0&&(e=0);var t=Na(n,e),s=Na(n,e+4);return t*4294967296+s}Ne.readUint64BE=ry;function ny(n,e){e===void 0&&(e=0);var t=La(n,e),s=La(n,e+4);return s*4294967296+t-(t>>31)*4294967296}Ne.readInt64LE=ny;function iy(n,e){e===void 0&&(e=0);var t=Fa(n,e),s=Fa(n,e+4);return s*4294967296+t}Ne.readUint64LE=iy;function Jf(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Us(n/4294967296>>>0,e,t),Us(n>>>0,e,t+4),e}Ne.writeUint64BE=Jf,Ne.writeInt64BE=Jf;function Xf(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Ms(n>>>0,e,t),Ms(n/4294967296>>>0,e,t+4),e}Ne.writeUint64LE=Xf,Ne.writeInt64LE=Xf;function sy(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,u=n/8+t-1;u>=t;u--)s+=e[u]*o,o*=256;return s}Ne.readUintBE=sy;function oy(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,u=t;u<t+n/8;u++)s+=e[u]*o,o*=256;return s}Ne.readUintLE=oy;function ay(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Vf.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,u=n/8+s-1;u>=s;u--)t[u]=e/o&255,o*=256;return t}Ne.writeUintBE=ay;function uy(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Vf.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,u=s;u<s+n/8;u++)t[u]=e/o&255,o*=256;return t}Ne.writeUintLE=uy;function cy(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e)}Ne.readFloat32BE=cy;function fy(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e,!0)}Ne.readFloat32LE=fy;function hy(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e)}Ne.readFloat64BE=hy;function ly(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e,!0)}Ne.readFloat64LE=ly;function dy(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n),e}Ne.writeFloat32BE=dy;function py(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n,!0),e}Ne.writeFloat32LE=py;function gy(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n),e}Ne.writeFloat64BE=gy;function _y(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n,!0),e}Ne.writeFloat64LE=_y,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=Ls,t=Ne,s=Er;n.defaultRandomSource=new e.SystemRandomSource;function o(p,E=n.defaultRandomSource){return E.randomBytes(p)}n.randomBytes=o;function u(p=n.defaultRandomSource){const E=o(4,p),T=(0,t.readUint32LE)(E);return(0,s.wipe)(E),T}n.randomUint32=u;const f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(p,E=f,T=n.defaultRandomSource){if(E.length<2)throw new Error("randomString charset is too short");if(E.length>256)throw new Error("randomString charset is too long");let D="";const C=E.length,R=256-256%C;for(;p>0;){const j=o(Math.ceil(p*256/R),T);for(let K=0;K<j.length&&p>0;K++){const se=j[K];se<R&&(D+=E.charAt(se%C),p--)}(0,s.wipe)(j)}return D}n.randomString=l;function _(p,E=f,T=n.defaultRandomSource){const D=Math.ceil(p/(Math.log(E.length)/Math.LN2));return l(D,E,T)}n.randomStringForEntropy=_}(di);var Zf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ne,t=Er;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function l(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},l.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=_[E++],p--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(E=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,E,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[E++],p--;return this},l.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,E=this._bufferLength,T=p/536870912|0,D=p<<3,C=p%128<112?128:256;this._buffer[E]=128;for(var R=E+1;R<C-8;R++)this._buffer[R]=0;e.writeUint32BE(T,this._buffer,C-8),e.writeUint32BE(D,this._buffer,C-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,C),this._finished=!0}for(var R=0;R<this.digestLength/8;R++)e.writeUint32BE(this._stateHi[R],_,R*8),e.writeUint32BE(this._stateLo[R],_,R*8+4);return this},l.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(_){t.wipe(_.stateHi),t.wipe(_.stateLo),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},l}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(l,_,p,E,T,D,C){for(var R=p[0],j=p[1],K=p[2],se=p[3],L=p[4],M=p[5],x=p[6],P=p[7],m=E[0],c=E[1],b=E[2],V=E[3],Y=E[4],ie=E[5],ue=E[6],de=E[7],w,I,ee,X,G,W,J,re;C>=128;){for(var we=0;we<16;we++){var oe=8*we+D;l[we]=e.readUint32BE(T,oe),_[we]=e.readUint32BE(T,oe+4)}for(var we=0;we<80;we++){var me=R,he=j,ve=K,H=se,q=L,F=M,d=x,A=P,ae=m,le=c,xe=b,je=V,Ge=Y,Ue=ie,gt=ue,_t=de;if(w=P,I=de,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=(L>>>14|Y<<32-14)^(L>>>18|Y<<32-18)^(Y>>>41-32|L<<32-(41-32)),I=(Y>>>14|L<<32-14)^(Y>>>18|L<<32-18)^(L>>>41-32|Y<<32-(41-32)),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=L&M^~L&x,I=Y&ie^~Y&ue,G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=o[we*2],I=o[we*2+1],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=l[we%16],I=_[we%16],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,ee=J&65535|re<<16,X=G&65535|W<<16,w=ee,I=X,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=(R>>>28|m<<32-28)^(m>>>34-32|R<<32-(34-32))^(m>>>39-32|R<<32-(39-32)),I=(m>>>28|R<<32-28)^(R>>>34-32|m<<32-(34-32))^(R>>>39-32|m<<32-(39-32)),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=R&j^R&K^j&K,I=m&c^m&b^c&b,G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,A=J&65535|re<<16,_t=G&65535|W<<16,w=H,I=je,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=ee,I=X,G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,H=J&65535|re<<16,je=G&65535|W<<16,j=me,K=he,se=ve,L=H,M=q,x=F,P=d,R=A,c=ae,b=le,V=xe,Y=je,ie=Ge,ue=Ue,de=gt,m=_t,we%16===15)for(var oe=0;oe<16;oe++)w=l[oe],I=_[oe],G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=l[(oe+9)%16],I=_[(oe+9)%16],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,ee=l[(oe+1)%16],X=_[(oe+1)%16],w=(ee>>>1|X<<32-1)^(ee>>>8|X<<32-8)^ee>>>7,I=(X>>>1|ee<<32-1)^(X>>>8|ee<<32-8)^(X>>>7|ee<<32-7),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,ee=l[(oe+14)%16],X=_[(oe+14)%16],w=(ee>>>19|X<<32-19)^(X>>>61-32|ee<<32-(61-32))^ee>>>6,I=(X>>>19|ee<<32-19)^(ee>>>61-32|X<<32-(61-32))^(X>>>6|ee<<32-6),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,l[oe]=J&65535|re<<16,_[oe]=G&65535|W<<16}w=R,I=m,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[0],I=E[0],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[0]=R=J&65535|re<<16,E[0]=m=G&65535|W<<16,w=j,I=c,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[1],I=E[1],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[1]=j=J&65535|re<<16,E[1]=c=G&65535|W<<16,w=K,I=b,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[2],I=E[2],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[2]=K=J&65535|re<<16,E[2]=b=G&65535|W<<16,w=se,I=V,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[3],I=E[3],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[3]=se=J&65535|re<<16,E[3]=V=G&65535|W<<16,w=L,I=Y,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[4],I=E[4],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[4]=L=J&65535|re<<16,E[4]=Y=G&65535|W<<16,w=M,I=ie,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[5],I=E[5],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[5]=M=J&65535|re<<16,E[5]=ie=G&65535|W<<16,w=x,I=ue,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[6],I=E[6],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[6]=x=J&65535|re<<16,E[6]=ue=G&65535|W<<16,w=P,I=de,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[7],I=E[7],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[7]=P=J&65535|re<<16,E[7]=de=G&65535|W<<16,D+=128,C-=128}return D}function f(l){var _=new s;_.update(l);var p=_.digest();return _.clean(),p}n.hash=f})(Zf),function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=di,t=Zf,s=Er;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(H){const q=new Float64Array(16);if(H)for(let F=0;F<H.length;F++)q[F]=H[F];return q}const u=new Uint8Array(32);u[0]=9;const f=o(),l=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),D=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function C(H,q){for(let F=0;F<16;F++)H[F]=q[F]|0}function R(H){let q=1;for(let F=0;F<16;F++){let d=H[F]+q+65535;q=Math.floor(d/65536),H[F]=d-q*65536}H[0]+=q-1+37*(q-1)}function j(H,q,F){const d=~(F-1);for(let A=0;A<16;A++){const ae=d&(H[A]^q[A]);H[A]^=ae,q[A]^=ae}}function K(H,q){const F=o(),d=o();for(let A=0;A<16;A++)d[A]=q[A];R(d),R(d),R(d);for(let A=0;A<2;A++){F[0]=d[0]-65517;for(let le=1;le<15;le++)F[le]=d[le]-65535-(F[le-1]>>16&1),F[le-1]&=65535;F[15]=d[15]-32767-(F[14]>>16&1);const ae=F[15]>>16&1;F[14]&=65535,j(d,F,1-ae)}for(let A=0;A<16;A++)H[2*A]=d[A]&255,H[2*A+1]=d[A]>>8}function se(H,q){let F=0;for(let d=0;d<32;d++)F|=H[d]^q[d];return(1&F-1>>>8)-1}function L(H,q){const F=new Uint8Array(32),d=new Uint8Array(32);return K(F,H),K(d,q),se(F,d)}function M(H){const q=new Uint8Array(32);return K(q,H),q[0]&1}function x(H,q){for(let F=0;F<16;F++)H[F]=q[2*F]+(q[2*F+1]<<8);H[15]&=32767}function P(H,q,F){for(let d=0;d<16;d++)H[d]=q[d]+F[d]}function m(H,q,F){for(let d=0;d<16;d++)H[d]=q[d]-F[d]}function c(H,q,F){let d,A,ae=0,le=0,xe=0,je=0,Ge=0,Ue=0,gt=0,_t=0,Be=0,Oe=0,Le=0,Fe=0,qe=0,Ae=0,$e=0,De=0,Pe=0,ze=0,Ie=0,We=0,ke=0,et=0,tt=0,Xe=0,ur=0,_r=0,Zr=0,cr=0,un=0,On=0,Yn=0,Dt=F[0],yt=F[1],xt=F[2],Ot=F[3],mt=F[4],vt=F[5],Mt=F[6],Bt=F[7],It=F[8],qt=F[9],At=F[10],Rt=F[11],Pt=F[12],lt=F[13],Ht=F[14],jt=F[15];d=q[0],ae+=d*Dt,le+=d*yt,xe+=d*xt,je+=d*Ot,Ge+=d*mt,Ue+=d*vt,gt+=d*Mt,_t+=d*Bt,Be+=d*It,Oe+=d*qt,Le+=d*At,Fe+=d*Rt,qe+=d*Pt,Ae+=d*lt,$e+=d*Ht,De+=d*jt,d=q[1],le+=d*Dt,xe+=d*yt,je+=d*xt,Ge+=d*Ot,Ue+=d*mt,gt+=d*vt,_t+=d*Mt,Be+=d*Bt,Oe+=d*It,Le+=d*qt,Fe+=d*At,qe+=d*Rt,Ae+=d*Pt,$e+=d*lt,De+=d*Ht,Pe+=d*jt,d=q[2],xe+=d*Dt,je+=d*yt,Ge+=d*xt,Ue+=d*Ot,gt+=d*mt,_t+=d*vt,Be+=d*Mt,Oe+=d*Bt,Le+=d*It,Fe+=d*qt,qe+=d*At,Ae+=d*Rt,$e+=d*Pt,De+=d*lt,Pe+=d*Ht,ze+=d*jt,d=q[3],je+=d*Dt,Ge+=d*yt,Ue+=d*xt,gt+=d*Ot,_t+=d*mt,Be+=d*vt,Oe+=d*Mt,Le+=d*Bt,Fe+=d*It,qe+=d*qt,Ae+=d*At,$e+=d*Rt,De+=d*Pt,Pe+=d*lt,ze+=d*Ht,Ie+=d*jt,d=q[4],Ge+=d*Dt,Ue+=d*yt,gt+=d*xt,_t+=d*Ot,Be+=d*mt,Oe+=d*vt,Le+=d*Mt,Fe+=d*Bt,qe+=d*It,Ae+=d*qt,$e+=d*At,De+=d*Rt,Pe+=d*Pt,ze+=d*lt,Ie+=d*Ht,We+=d*jt,d=q[5],Ue+=d*Dt,gt+=d*yt,_t+=d*xt,Be+=d*Ot,Oe+=d*mt,Le+=d*vt,Fe+=d*Mt,qe+=d*Bt,Ae+=d*It,$e+=d*qt,De+=d*At,Pe+=d*Rt,ze+=d*Pt,Ie+=d*lt,We+=d*Ht,ke+=d*jt,d=q[6],gt+=d*Dt,_t+=d*yt,Be+=d*xt,Oe+=d*Ot,Le+=d*mt,Fe+=d*vt,qe+=d*Mt,Ae+=d*Bt,$e+=d*It,De+=d*qt,Pe+=d*At,ze+=d*Rt,Ie+=d*Pt,We+=d*lt,ke+=d*Ht,et+=d*jt,d=q[7],_t+=d*Dt,Be+=d*yt,Oe+=d*xt,Le+=d*Ot,Fe+=d*mt,qe+=d*vt,Ae+=d*Mt,$e+=d*Bt,De+=d*It,Pe+=d*qt,ze+=d*At,Ie+=d*Rt,We+=d*Pt,ke+=d*lt,et+=d*Ht,tt+=d*jt,d=q[8],Be+=d*Dt,Oe+=d*yt,Le+=d*xt,Fe+=d*Ot,qe+=d*mt,Ae+=d*vt,$e+=d*Mt,De+=d*Bt,Pe+=d*It,ze+=d*qt,Ie+=d*At,We+=d*Rt,ke+=d*Pt,et+=d*lt,tt+=d*Ht,Xe+=d*jt,d=q[9],Oe+=d*Dt,Le+=d*yt,Fe+=d*xt,qe+=d*Ot,Ae+=d*mt,$e+=d*vt,De+=d*Mt,Pe+=d*Bt,ze+=d*It,Ie+=d*qt,We+=d*At,ke+=d*Rt,et+=d*Pt,tt+=d*lt,Xe+=d*Ht,ur+=d*jt,d=q[10],Le+=d*Dt,Fe+=d*yt,qe+=d*xt,Ae+=d*Ot,$e+=d*mt,De+=d*vt,Pe+=d*Mt,ze+=d*Bt,Ie+=d*It,We+=d*qt,ke+=d*At,et+=d*Rt,tt+=d*Pt,Xe+=d*lt,ur+=d*Ht,_r+=d*jt,d=q[11],Fe+=d*Dt,qe+=d*yt,Ae+=d*xt,$e+=d*Ot,De+=d*mt,Pe+=d*vt,ze+=d*Mt,Ie+=d*Bt,We+=d*It,ke+=d*qt,et+=d*At,tt+=d*Rt,Xe+=d*Pt,ur+=d*lt,_r+=d*Ht,Zr+=d*jt,d=q[12],qe+=d*Dt,Ae+=d*yt,$e+=d*xt,De+=d*Ot,Pe+=d*mt,ze+=d*vt,Ie+=d*Mt,We+=d*Bt,ke+=d*It,et+=d*qt,tt+=d*At,Xe+=d*Rt,ur+=d*Pt,_r+=d*lt,Zr+=d*Ht,cr+=d*jt,d=q[13],Ae+=d*Dt,$e+=d*yt,De+=d*xt,Pe+=d*Ot,ze+=d*mt,Ie+=d*vt,We+=d*Mt,ke+=d*Bt,et+=d*It,tt+=d*qt,Xe+=d*At,ur+=d*Rt,_r+=d*Pt,Zr+=d*lt,cr+=d*Ht,un+=d*jt,d=q[14],$e+=d*Dt,De+=d*yt,Pe+=d*xt,ze+=d*Ot,Ie+=d*mt,We+=d*vt,ke+=d*Mt,et+=d*Bt,tt+=d*It,Xe+=d*qt,ur+=d*At,_r+=d*Rt,Zr+=d*Pt,cr+=d*lt,un+=d*Ht,On+=d*jt,d=q[15],De+=d*Dt,Pe+=d*yt,ze+=d*xt,Ie+=d*Ot,We+=d*mt,ke+=d*vt,et+=d*Mt,tt+=d*Bt,Xe+=d*It,ur+=d*qt,_r+=d*At,Zr+=d*Rt,cr+=d*Pt,un+=d*lt,On+=d*Ht,Yn+=d*jt,ae+=38*Pe,le+=38*ze,xe+=38*Ie,je+=38*We,Ge+=38*ke,Ue+=38*et,gt+=38*tt,_t+=38*Xe,Be+=38*ur,Oe+=38*_r,Le+=38*Zr,Fe+=38*cr,qe+=38*un,Ae+=38*On,$e+=38*Yn,A=1,d=ae+A+65535,A=Math.floor(d/65536),ae=d-A*65536,d=le+A+65535,A=Math.floor(d/65536),le=d-A*65536,d=xe+A+65535,A=Math.floor(d/65536),xe=d-A*65536,d=je+A+65535,A=Math.floor(d/65536),je=d-A*65536,d=Ge+A+65535,A=Math.floor(d/65536),Ge=d-A*65536,d=Ue+A+65535,A=Math.floor(d/65536),Ue=d-A*65536,d=gt+A+65535,A=Math.floor(d/65536),gt=d-A*65536,d=_t+A+65535,A=Math.floor(d/65536),_t=d-A*65536,d=Be+A+65535,A=Math.floor(d/65536),Be=d-A*65536,d=Oe+A+65535,A=Math.floor(d/65536),Oe=d-A*65536,d=Le+A+65535,A=Math.floor(d/65536),Le=d-A*65536,d=Fe+A+65535,A=Math.floor(d/65536),Fe=d-A*65536,d=qe+A+65535,A=Math.floor(d/65536),qe=d-A*65536,d=Ae+A+65535,A=Math.floor(d/65536),Ae=d-A*65536,d=$e+A+65535,A=Math.floor(d/65536),$e=d-A*65536,d=De+A+65535,A=Math.floor(d/65536),De=d-A*65536,ae+=A-1+37*(A-1),A=1,d=ae+A+65535,A=Math.floor(d/65536),ae=d-A*65536,d=le+A+65535,A=Math.floor(d/65536),le=d-A*65536,d=xe+A+65535,A=Math.floor(d/65536),xe=d-A*65536,d=je+A+65535,A=Math.floor(d/65536),je=d-A*65536,d=Ge+A+65535,A=Math.floor(d/65536),Ge=d-A*65536,d=Ue+A+65535,A=Math.floor(d/65536),Ue=d-A*65536,d=gt+A+65535,A=Math.floor(d/65536),gt=d-A*65536,d=_t+A+65535,A=Math.floor(d/65536),_t=d-A*65536,d=Be+A+65535,A=Math.floor(d/65536),Be=d-A*65536,d=Oe+A+65535,A=Math.floor(d/65536),Oe=d-A*65536,d=Le+A+65535,A=Math.floor(d/65536),Le=d-A*65536,d=Fe+A+65535,A=Math.floor(d/65536),Fe=d-A*65536,d=qe+A+65535,A=Math.floor(d/65536),qe=d-A*65536,d=Ae+A+65535,A=Math.floor(d/65536),Ae=d-A*65536,d=$e+A+65535,A=Math.floor(d/65536),$e=d-A*65536,d=De+A+65535,A=Math.floor(d/65536),De=d-A*65536,ae+=A-1+37*(A-1),H[0]=ae,H[1]=le,H[2]=xe,H[3]=je,H[4]=Ge,H[5]=Ue,H[6]=gt,H[7]=_t,H[8]=Be,H[9]=Oe,H[10]=Le,H[11]=Fe,H[12]=qe,H[13]=Ae,H[14]=$e,H[15]=De}function b(H,q){c(H,q,q)}function V(H,q){const F=o();let d;for(d=0;d<16;d++)F[d]=q[d];for(d=253;d>=0;d--)b(F,F),d!==2&&d!==4&&c(F,F,q);for(d=0;d<16;d++)H[d]=F[d]}function Y(H,q){const F=o();let d;for(d=0;d<16;d++)F[d]=q[d];for(d=250;d>=0;d--)b(F,F),d!==1&&c(F,F,q);for(d=0;d<16;d++)H[d]=F[d]}function ie(H,q){const F=o(),d=o(),A=o(),ae=o(),le=o(),xe=o(),je=o(),Ge=o(),Ue=o();m(F,H[1],H[0]),m(Ue,q[1],q[0]),c(F,F,Ue),P(d,H[0],H[1]),P(Ue,q[0],q[1]),c(d,d,Ue),c(A,H[3],q[3]),c(A,A,p),c(ae,H[2],q[2]),P(ae,ae,ae),m(le,d,F),m(xe,ae,A),P(je,ae,A),P(Ge,d,F),c(H[0],le,xe),c(H[1],Ge,je),c(H[2],je,xe),c(H[3],le,Ge)}function ue(H,q,F){for(let d=0;d<4;d++)j(H[d],q[d],F)}function de(H,q){const F=o(),d=o(),A=o();V(A,q[2]),c(F,q[0],A),c(d,q[1],A),K(H,d),H[31]^=M(F)<<7}function w(H,q,F){C(H[0],f),C(H[1],l),C(H[2],l),C(H[3],f);for(let d=255;d>=0;--d){const A=F[d/8|0]>>(d&7)&1;ue(H,q,A),ie(q,H),ie(H,H),ue(H,q,A)}}function I(H,q){const F=[o(),o(),o(),o()];C(F[0],E),C(F[1],T),C(F[2],l),c(F[3],E,T),w(H,F,q)}function ee(H){if(H.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const q=(0,t.hash)(H);q[0]&=248,q[31]&=127,q[31]|=64;const F=new Uint8Array(32),d=[o(),o(),o(),o()];I(d,q),de(F,d);const A=new Uint8Array(64);return A.set(H),A.set(F,32),{publicKey:F,secretKey:A}}n.generateKeyPairFromSeed=ee;function X(H){const q=(0,e.randomBytes)(32,H),F=ee(q);return(0,s.wipe)(q),F}n.generateKeyPair=X;function G(H){if(H.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(H.subarray(32))}n.extractPublicKeyFromSecretKey=G;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(H,q){let F,d,A,ae;for(d=63;d>=32;--d){for(F=0,A=d-32,ae=d-12;A<ae;++A)q[A]+=F-16*q[d]*W[A-(d-32)],F=Math.floor((q[A]+128)/256),q[A]-=F*256;q[A]+=F,q[d]=0}for(F=0,A=0;A<32;A++)q[A]+=F-(q[31]>>4)*W[A],F=q[A]>>8,q[A]&=255;for(A=0;A<32;A++)q[A]-=F*W[A];for(d=0;d<32;d++)q[d+1]+=q[d]>>8,H[d]=q[d]&255}function re(H){const q=new Float64Array(64);for(let F=0;F<64;F++)q[F]=H[F];for(let F=0;F<64;F++)H[F]=0;J(H,q)}function we(H,q){const F=new Float64Array(64),d=[o(),o(),o(),o()],A=(0,t.hash)(H.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const ae=new Uint8Array(64);ae.set(A.subarray(32),32);const le=new t.SHA512;le.update(ae.subarray(32)),le.update(q);const xe=le.digest();le.clean(),re(xe),I(d,xe),de(ae,d),le.reset(),le.update(ae.subarray(0,32)),le.update(H.subarray(32)),le.update(q);const je=le.digest();re(je);for(let Ge=0;Ge<32;Ge++)F[Ge]=xe[Ge];for(let Ge=0;Ge<32;Ge++)for(let Ue=0;Ue<32;Ue++)F[Ge+Ue]+=je[Ge]*A[Ue];return J(ae.subarray(32),F),ae}n.sign=we;function oe(H,q){const F=o(),d=o(),A=o(),ae=o(),le=o(),xe=o(),je=o();return C(H[2],l),x(H[1],q),b(A,H[1]),c(ae,A,_),m(A,A,H[2]),P(ae,H[2],ae),b(le,ae),b(xe,le),c(je,xe,le),c(F,je,A),c(F,F,ae),Y(F,F),c(F,F,A),c(F,F,ae),c(F,F,ae),c(H[0],F,ae),b(d,H[0]),c(d,d,ae),L(d,A)&&c(H[0],H[0],D),b(d,H[0]),c(d,d,ae),L(d,A)?-1:(M(H[0])===q[31]>>7&&m(H[0],f,H[0]),c(H[3],H[0],H[1]),0)}function me(H,q,F){const d=new Uint8Array(32),A=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(F.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(oe(ae,H))return!1;const le=new t.SHA512;le.update(F.subarray(0,32)),le.update(H),le.update(q);const xe=le.digest();return re(xe),w(A,ae,xe),I(ae,F.subarray(32)),ie(A,ae),de(d,A),!se(F,d)}n.verify=me;function he(H){let q=[o(),o(),o(),o()];if(oe(q,H))throw new Error("Ed25519: invalid public key");let F=o(),d=o(),A=q[1];P(F,l,A),m(d,l,A),V(d,d),c(F,F,d);let ae=new Uint8Array(32);return K(ae,F),ae}n.convertPublicKeyToX25519=he;function ve(H){const q=(0,t.hash)(H.subarray(0,32));q[0]&=248,q[31]&=127,q[31]|=64;const F=new Uint8Array(q.subarray(0,32));return(0,s.wipe)(q),F}n.convertSecretKeyToX25519=ve}(Ca);const yy="EdDSA",vy="JWT",Qf=".",eh="base64url",by="utf8",wy="utf8",my=":",Ey="did",Sy="key",th="base58btc",Dy="z",xy="K36",Oy=32;function $a(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function rh(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?$a(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Ua(n,e){e||(e=n.reduce((o,u)=>o+u.length,0));const t=rh(e);let s=0;for(const o of n)t.set(o,s),s+=o.length;return $a(t)}function Iy(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<n.length;o++){var u=n.charAt(o),f=u.charCodeAt(0);if(t[f]!==255)throw new TypeError(u+" is ambiguous");t[f]=o}var l=n.length,_=n.charAt(0),p=Math.log(l)/Math.log(256),E=Math.log(256)/Math.log(l);function T(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var j=0,K=0,se=0,L=R.length;se!==L&&R[se]===0;)se++,j++;for(var M=(L-se)*E+1>>>0,x=new Uint8Array(M);se!==L;){for(var P=R[se],m=0,c=M-1;(P!==0||m<K)&&c!==-1;c--,m++)P+=256*x[c]>>>0,x[c]=P%l>>>0,P=P/l>>>0;if(P!==0)throw new Error("Non-zero carry");K=m,se++}for(var b=M-K;b!==M&&x[b]===0;)b++;for(var V=_.repeat(j);b<M;++b)V+=n.charAt(x[b]);return V}function D(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var j=0;if(R[j]!==" "){for(var K=0,se=0;R[j]===_;)K++,j++;for(var L=(R.length-j)*p+1>>>0,M=new Uint8Array(L);R[j];){var x=t[R.charCodeAt(j)];if(x===255)return;for(var P=0,m=L-1;(x!==0||P<se)&&m!==-1;m--,P++)x+=l*M[m]>>>0,M[m]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");se=P,j++}if(R[j]!==" "){for(var c=L-se;c!==L&&M[c]===0;)c++;for(var b=new Uint8Array(K+(L-c)),V=K;c!==L;)b[V++]=M[c++];return b}}}function C(R){var j=D(R);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:D,decode:C}}var Ay=Iy,Py=Ay;const nh=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Ty=n=>new TextEncoder().encode(n),Cy=n=>new TextDecoder().decode(n);class Ry{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ny{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ih(this,e)}}class Ly{constructor(e){this.decoders=e}or(e){return ih(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ih=(n,e)=>new Ly({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class Fy{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new Ry(e,t,s),this.decoder=new Ny(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Bs=({name:n,prefix:e,encode:t,decode:s})=>new Fy(n,e,t,s),Zi=({prefix:n,name:e,alphabet:t})=>{const{encode:s,decode:o}=Py(t,e);return Bs({prefix:n,name:e,encode:s,decode:u=>nh(o(u))})},$y=(n,e,t,s)=>{const o={};for(let E=0;E<e.length;++E)o[e[E]]=E;let u=n.length;for(;n[u-1]==="=";)--u;const f=new Uint8Array(u*t/8|0);let l=0,_=0,p=0;for(let E=0;E<u;++E){const T=o[n[E]];if(T===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<t|T,l+=t,l>=8&&(l-=8,f[p++]=255&_>>l)}if(l>=t||255&_<<8-l)throw new SyntaxError("Unexpected end of data");return f},Uy=(n,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let u="",f=0,l=0;for(let _=0;_<n.length;++_)for(l=l<<8|n[_],f+=8;f>t;)f-=t,u+=e[o&l>>f];if(f&&(u+=e[o&l<<t-f]),s)for(;u.length*t&7;)u+="=";return u},Jt=({name:n,prefix:e,bitsPerChar:t,alphabet:s})=>Bs({prefix:e,name:n,encode(o){return Uy(o,s,t)},decode(o){return $y(o,s,t,n)}}),My=Bs({prefix:"\0",name:"identity",encode:n=>Cy(n),decode:n=>Ty(n)});var By=Object.freeze({__proto__:null,identity:My});const qy=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Hy=Object.freeze({__proto__:null,base2:qy});const jy=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zy=Object.freeze({__proto__:null,base8:jy});const Ky=Zi({prefix:"9",name:"base10",alphabet:"0123456789"});var Gy=Object.freeze({__proto__:null,base10:Ky});const Wy=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Vy=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ky=Object.freeze({__proto__:null,base16:Wy,base16upper:Vy});const Yy=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Jy=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Xy=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Zy=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Qy=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),e1=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),t1=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),r1=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),n1=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var i1=Object.freeze({__proto__:null,base32:Yy,base32upper:Jy,base32pad:Xy,base32padupper:Zy,base32hex:Qy,base32hexupper:e1,base32hexpad:t1,base32hexpadupper:r1,base32z:n1});const s1=Zi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),o1=Zi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var a1=Object.freeze({__proto__:null,base36:s1,base36upper:o1});const u1=Zi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),c1=Zi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var f1=Object.freeze({__proto__:null,base58btc:u1,base58flickr:c1});const h1=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),l1=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),d1=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),p1=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var g1=Object.freeze({__proto__:null,base64:h1,base64pad:l1,base64url:d1,base64urlpad:p1});const sh=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),_1=sh.reduce((n,e,t)=>(n[t]=e,n),[]),y1=sh.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function v1(n){return n.reduce((e,t)=>(e+=_1[t],e),"")}function b1(n){const e=[];for(const t of n){const s=y1[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const w1=Bs({prefix:"\u{1F680}",name:"base256emoji",encode:v1,decode:b1});var m1=Object.freeze({__proto__:null,base256emoji:w1}),E1=ah,oh=128,S1=127,D1=~S1,x1=Math.pow(2,31);function ah(n,e,t){e=e||[],t=t||0;for(var s=t;n>=x1;)e[t++]=n&255|oh,n/=128;for(;n&D1;)e[t++]=n&255|oh,n>>>=7;return e[t]=n|0,ah.bytes=t-s+1,e}var O1=Ma,I1=128,uh=127;function Ma(n,s){var t=0,s=s||0,o=0,u=s,f,l=n.length;do{if(u>=l)throw Ma.bytes=0,new RangeError("Could not decode varint");f=n[u++],t+=o<28?(f&uh)<<o:(f&uh)*Math.pow(2,o),o+=7}while(f>=I1);return Ma.bytes=u-s,t}var A1=Math.pow(2,7),P1=Math.pow(2,14),T1=Math.pow(2,21),C1=Math.pow(2,28),R1=Math.pow(2,35),N1=Math.pow(2,42),L1=Math.pow(2,49),F1=Math.pow(2,56),$1=Math.pow(2,63),U1=function(n){return n<A1?1:n<P1?2:n<T1?3:n<C1?4:n<R1?5:n<N1?6:n<L1?7:n<F1?8:n<$1?9:10},M1={encode:E1,decode:O1,encodingLength:U1},ch=M1;const fh=(n,e,t=0)=>(ch.encode(n,e,t),e),hh=n=>ch.encodingLength(n),Ba=(n,e)=>{const t=e.byteLength,s=hh(n),o=s+hh(t),u=new Uint8Array(o+t);return fh(n,u,0),fh(t,u,s),u.set(e,o),new B1(n,t,e,u)};class B1{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const lh=({name:n,code:e,encode:t})=>new q1(n,e,t);class q1{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ba(this.code,t):t.then(s=>Ba(this.code,s))}else throw Error("Unknown type, must be binary type")}}const dh=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),H1=lh({name:"sha2-256",code:18,encode:dh("SHA-256")}),j1=lh({name:"sha2-512",code:19,encode:dh("SHA-512")});var z1=Object.freeze({__proto__:null,sha256:H1,sha512:j1});const ph=0,K1="identity",gh=nh;var G1=Object.freeze({__proto__:null,identity:{code:ph,name:K1,encode:gh,digest:n=>Ba(ph,gh(n))}});new TextEncoder,new TextDecoder;const _h={...By,...Hy,...zy,...Gy,...ky,...i1,...a1,...f1,...g1,...m1};({...z1,...G1});function yh(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const vh=yh("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),qa=yh("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=rh(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),bh={utf8:vh,"utf-8":vh,hex:_h.base16,latin1:qa,ascii:qa,binary:qa,..._h};function ir(n,e="utf8"){const t=bh[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}function pr(n,e="utf8"){const t=bh[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?$a(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function qs(n){return ir(pr(Xi(n),by),eh)}function wh(n){const e=pr(xy,th),t=Dy+ir(Ua([e,n]),th);return[Ey,Sy,t].join(my)}function W1(n){return ir(n,eh)}function V1(n){return pr([qs(n.header),qs(n.payload)].join(Qf),wy)}function k1(n){return[qs(n.header),qs(n.payload),W1(n.signature)].join(Qf)}function mh(n=di.randomBytes(Oy)){return Ca.generateKeyPairFromSeed(n)}async function Y1(n,e,t,s,o=_e.fromMiliseconds(Date.now())){const u={alg:yy,typ:vy},f=wh(s.publicKey),l=o+t,_={iss:f,sub:n,aud:e,iat:o,exp:l},p=V1({header:u,payload:_}),E=Ca.sign(s.secretKey,p);return k1({header:u,payload:_,signature:E})}var Ha={},Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});var er=Ne,ja=Er,J1=20;function X1(n,e,t){for(var s=1634760805,o=857760878,u=2036477234,f=1797285236,l=t[3]<<24|t[2]<<16|t[1]<<8|t[0],_=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],E=t[15]<<24|t[14]<<16|t[13]<<8|t[12],T=t[19]<<24|t[18]<<16|t[17]<<8|t[16],D=t[23]<<24|t[22]<<16|t[21]<<8|t[20],C=t[27]<<24|t[26]<<16|t[25]<<8|t[24],R=t[31]<<24|t[30]<<16|t[29]<<8|t[28],j=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],se=e[11]<<24|e[10]<<16|e[9]<<8|e[8],L=e[15]<<24|e[14]<<16|e[13]<<8|e[12],M=s,x=o,P=u,m=f,c=l,b=_,V=p,Y=E,ie=T,ue=D,de=C,w=R,I=j,ee=K,X=se,G=L,W=0;W<J1;W+=2)M=M+c|0,I^=M,I=I>>>32-16|I<<16,ie=ie+I|0,c^=ie,c=c>>>32-12|c<<12,x=x+b|0,ee^=x,ee=ee>>>32-16|ee<<16,ue=ue+ee|0,b^=ue,b=b>>>32-12|b<<12,P=P+V|0,X^=P,X=X>>>32-16|X<<16,de=de+X|0,V^=de,V=V>>>32-12|V<<12,m=m+Y|0,G^=m,G=G>>>32-16|G<<16,w=w+G|0,Y^=w,Y=Y>>>32-12|Y<<12,P=P+V|0,X^=P,X=X>>>32-8|X<<8,de=de+X|0,V^=de,V=V>>>32-7|V<<7,m=m+Y|0,G^=m,G=G>>>32-8|G<<8,w=w+G|0,Y^=w,Y=Y>>>32-7|Y<<7,x=x+b|0,ee^=x,ee=ee>>>32-8|ee<<8,ue=ue+ee|0,b^=ue,b=b>>>32-7|b<<7,M=M+c|0,I^=M,I=I>>>32-8|I<<8,ie=ie+I|0,c^=ie,c=c>>>32-7|c<<7,M=M+b|0,G^=M,G=G>>>32-16|G<<16,de=de+G|0,b^=de,b=b>>>32-12|b<<12,x=x+V|0,I^=x,I=I>>>32-16|I<<16,w=w+I|0,V^=w,V=V>>>32-12|V<<12,P=P+Y|0,ee^=P,ee=ee>>>32-16|ee<<16,ie=ie+ee|0,Y^=ie,Y=Y>>>32-12|Y<<12,m=m+c|0,X^=m,X=X>>>32-16|X<<16,ue=ue+X|0,c^=ue,c=c>>>32-12|c<<12,P=P+Y|0,ee^=P,ee=ee>>>32-8|ee<<8,ie=ie+ee|0,Y^=ie,Y=Y>>>32-7|Y<<7,m=m+c|0,X^=m,X=X>>>32-8|X<<8,ue=ue+X|0,c^=ue,c=c>>>32-7|c<<7,x=x+V|0,I^=x,I=I>>>32-8|I<<8,w=w+I|0,V^=w,V=V>>>32-7|V<<7,M=M+b|0,G^=M,G=G>>>32-8|G<<8,de=de+G|0,b^=de,b=b>>>32-7|b<<7;er.writeUint32LE(M+s|0,n,0),er.writeUint32LE(x+o|0,n,4),er.writeUint32LE(P+u|0,n,8),er.writeUint32LE(m+f|0,n,12),er.writeUint32LE(c+l|0,n,16),er.writeUint32LE(b+_|0,n,20),er.writeUint32LE(V+p|0,n,24),er.writeUint32LE(Y+E|0,n,28),er.writeUint32LE(ie+T|0,n,32),er.writeUint32LE(ue+D|0,n,36),er.writeUint32LE(de+C|0,n,40),er.writeUint32LE(w+R|0,n,44),er.writeUint32LE(I+j|0,n,48),er.writeUint32LE(ee+K|0,n,52),er.writeUint32LE(X+se|0,n,56),er.writeUint32LE(G+L|0,n,60)}function Eh(n,e,t,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var u,f;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");u=new Uint8Array(16),f=u.length-e.length,u.set(e,f)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");u=e,f=o}for(var l=new Uint8Array(64),_=0;_<t.length;_+=64){X1(l,u,n);for(var p=_;p<_+64&&p<t.length;p++)s[p]=t[p]^l[p-_];Q1(u,0,f)}return ja.wipe(l),o===0&&ja.wipe(u),s}Hs.streamXOR=Eh;function Z1(n,e,t,s){return s===void 0&&(s=0),ja.wipe(t),Eh(n,e,t,t,s)}Hs.stream=Z1;function Q1(n,e,t){for(var s=1;t--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Sh={},wn={};Object.defineProperty(wn,"__esModule",{value:!0});function ev(n,e,t){return~(n-1)&e|n-1&t}wn.select=ev;function tv(n,e){return(n|0)-(e|0)-1>>>31&1}wn.lessOrEqual=tv;function Dh(n,e){if(n.length!==e.length)return 0;for(var t=0,s=0;s<n.length;s++)t|=n[s]^e[s];return 1&t-1>>>8}wn.compare=Dh;function rv(n,e){return n.length===0||e.length===0?!1:Dh(n,e)!==0}wn.equal=rv,function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=wn,t=Er;n.DIGEST_LENGTH=16;var s=function(){function f(l){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var _=l[0]|l[1]<<8;this._r[0]=_&8191;var p=l[2]|l[3]<<8;this._r[1]=(_>>>13|p<<3)&8191;var E=l[4]|l[5]<<8;this._r[2]=(p>>>10|E<<6)&7939;var T=l[6]|l[7]<<8;this._r[3]=(E>>>7|T<<9)&8191;var D=l[8]|l[9]<<8;this._r[4]=(T>>>4|D<<12)&255,this._r[5]=D>>>1&8190;var C=l[10]|l[11]<<8;this._r[6]=(D>>>14|C<<2)&8191;var R=l[12]|l[13]<<8;this._r[7]=(C>>>11|R<<5)&8065;var j=l[14]|l[15]<<8;this._r[8]=(R>>>8|j<<8)&8191,this._r[9]=j>>>5&127,this._pad[0]=l[16]|l[17]<<8,this._pad[1]=l[18]|l[19]<<8,this._pad[2]=l[20]|l[21]<<8,this._pad[3]=l[22]|l[23]<<8,this._pad[4]=l[24]|l[25]<<8,this._pad[5]=l[26]|l[27]<<8,this._pad[6]=l[28]|l[29]<<8,this._pad[7]=l[30]|l[31]<<8}return f.prototype._blocks=function(l,_,p){for(var E=this._fin?0:2048,T=this._h[0],D=this._h[1],C=this._h[2],R=this._h[3],j=this._h[4],K=this._h[5],se=this._h[6],L=this._h[7],M=this._h[8],x=this._h[9],P=this._r[0],m=this._r[1],c=this._r[2],b=this._r[3],V=this._r[4],Y=this._r[5],ie=this._r[6],ue=this._r[7],de=this._r[8],w=this._r[9];p>=16;){var I=l[_+0]|l[_+1]<<8;T+=I&8191;var ee=l[_+2]|l[_+3]<<8;D+=(I>>>13|ee<<3)&8191;var X=l[_+4]|l[_+5]<<8;C+=(ee>>>10|X<<6)&8191;var G=l[_+6]|l[_+7]<<8;R+=(X>>>7|G<<9)&8191;var W=l[_+8]|l[_+9]<<8;j+=(G>>>4|W<<12)&8191,K+=W>>>1&8191;var J=l[_+10]|l[_+11]<<8;se+=(W>>>14|J<<2)&8191;var re=l[_+12]|l[_+13]<<8;L+=(J>>>11|re<<5)&8191;var we=l[_+14]|l[_+15]<<8;M+=(re>>>8|we<<8)&8191,x+=we>>>5|E;var oe=0,me=oe;me+=T*P,me+=D*(5*w),me+=C*(5*de),me+=R*(5*ue),me+=j*(5*ie),oe=me>>>13,me&=8191,me+=K*(5*Y),me+=se*(5*V),me+=L*(5*b),me+=M*(5*c),me+=x*(5*m),oe+=me>>>13,me&=8191;var he=oe;he+=T*m,he+=D*P,he+=C*(5*w),he+=R*(5*de),he+=j*(5*ue),oe=he>>>13,he&=8191,he+=K*(5*ie),he+=se*(5*Y),he+=L*(5*V),he+=M*(5*b),he+=x*(5*c),oe+=he>>>13,he&=8191;var ve=oe;ve+=T*c,ve+=D*m,ve+=C*P,ve+=R*(5*w),ve+=j*(5*de),oe=ve>>>13,ve&=8191,ve+=K*(5*ue),ve+=se*(5*ie),ve+=L*(5*Y),ve+=M*(5*V),ve+=x*(5*b),oe+=ve>>>13,ve&=8191;var H=oe;H+=T*b,H+=D*c,H+=C*m,H+=R*P,H+=j*(5*w),oe=H>>>13,H&=8191,H+=K*(5*de),H+=se*(5*ue),H+=L*(5*ie),H+=M*(5*Y),H+=x*(5*V),oe+=H>>>13,H&=8191;var q=oe;q+=T*V,q+=D*b,q+=C*c,q+=R*m,q+=j*P,oe=q>>>13,q&=8191,q+=K*(5*w),q+=se*(5*de),q+=L*(5*ue),q+=M*(5*ie),q+=x*(5*Y),oe+=q>>>13,q&=8191;var F=oe;F+=T*Y,F+=D*V,F+=C*b,F+=R*c,F+=j*m,oe=F>>>13,F&=8191,F+=K*P,F+=se*(5*w),F+=L*(5*de),F+=M*(5*ue),F+=x*(5*ie),oe+=F>>>13,F&=8191;var d=oe;d+=T*ie,d+=D*Y,d+=C*V,d+=R*b,d+=j*c,oe=d>>>13,d&=8191,d+=K*m,d+=se*P,d+=L*(5*w),d+=M*(5*de),d+=x*(5*ue),oe+=d>>>13,d&=8191;var A=oe;A+=T*ue,A+=D*ie,A+=C*Y,A+=R*V,A+=j*b,oe=A>>>13,A&=8191,A+=K*c,A+=se*m,A+=L*P,A+=M*(5*w),A+=x*(5*de),oe+=A>>>13,A&=8191;var ae=oe;ae+=T*de,ae+=D*ue,ae+=C*ie,ae+=R*Y,ae+=j*V,oe=ae>>>13,ae&=8191,ae+=K*b,ae+=se*c,ae+=L*m,ae+=M*P,ae+=x*(5*w),oe+=ae>>>13,ae&=8191;var le=oe;le+=T*w,le+=D*de,le+=C*ue,le+=R*ie,le+=j*Y,oe=le>>>13,le&=8191,le+=K*V,le+=se*b,le+=L*c,le+=M*m,le+=x*P,oe+=le>>>13,le&=8191,oe=(oe<<2)+oe|0,oe=oe+me|0,me=oe&8191,oe=oe>>>13,he+=oe,T=me,D=he,C=ve,R=H,j=q,K=F,se=d,L=A,M=ae,x=le,_+=16,p-=16}this._h[0]=T,this._h[1]=D,this._h[2]=C,this._h[3]=R,this._h[4]=j,this._h[5]=K,this._h[6]=se,this._h[7]=L,this._h[8]=M,this._h[9]=x},f.prototype.finish=function(l,_){_===void 0&&(_=0);var p=new Uint16Array(10),E,T,D,C;if(this._leftover){for(C=this._leftover,this._buffer[C++]=1;C<16;C++)this._buffer[C]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(E=this._h[1]>>>13,this._h[1]&=8191,C=2;C<10;C++)this._h[C]+=E,E=this._h[C]>>>13,this._h[C]&=8191;for(this._h[0]+=E*5,E=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=E,E=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=E,p[0]=this._h[0]+5,E=p[0]>>>13,p[0]&=8191,C=1;C<10;C++)p[C]=this._h[C]+E,E=p[C]>>>13,p[C]&=8191;for(p[9]-=8192,T=(E^1)-1,C=0;C<10;C++)p[C]&=T;for(T=~T,C=0;C<10;C++)this._h[C]=this._h[C]&T|p[C];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,D=this._h[0]+this._pad[0],this._h[0]=D&65535,C=1;C<8;C++)D=(this._h[C]+this._pad[C]|0)+(D>>>16)|0,this._h[C]=D&65535;return l[_+0]=this._h[0]>>>0,l[_+1]=this._h[0]>>>8,l[_+2]=this._h[1]>>>0,l[_+3]=this._h[1]>>>8,l[_+4]=this._h[2]>>>0,l[_+5]=this._h[2]>>>8,l[_+6]=this._h[3]>>>0,l[_+7]=this._h[3]>>>8,l[_+8]=this._h[4]>>>0,l[_+9]=this._h[4]>>>8,l[_+10]=this._h[5]>>>0,l[_+11]=this._h[5]>>>8,l[_+12]=this._h[6]>>>0,l[_+13]=this._h[6]>>>8,l[_+14]=this._h[7]>>>0,l[_+15]=this._h[7]>>>8,this._finished=!0,this},f.prototype.update=function(l){var _=0,p=l.length,E;if(this._leftover){E=16-this._leftover,E>p&&(E=p);for(var T=0;T<E;T++)this._buffer[this._leftover+T]=l[_+T];if(p-=E,_+=E,this._leftover+=E,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(E=p-p%16,this._blocks(l,_,E),_+=E,p-=E),p){for(var T=0;T<p;T++)this._buffer[this._leftover+T]=l[_+T];this._leftover+=p}return this},f.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var l=new Uint8Array(16);return this.finish(l),l},f.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},f}();n.Poly1305=s;function o(f,l){var _=new s(f);_.update(l);var p=_.digest();return _.clean(),p}n.oneTimeAuth=o;function u(f,l){return f.length!==n.DIGEST_LENGTH||l.length!==n.DIGEST_LENGTH?!1:e.equal(f,l)}n.equal=u}(Sh),function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Hs,t=Sh,s=Er,o=Ne,u=wn;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var f=new Uint8Array(16),l=function(){function _(p){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,p.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return _.prototype.seal=function(p,E,T,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var C=new Uint8Array(16);C.set(p,C.length-p.length);var R=new Uint8Array(32);e.stream(this._key,C,R,4);var j=E.length+this.tagLength,K;if(D){if(D.length!==j)throw new Error("ChaCha20Poly1305: incorrect destination length");K=D}else K=new Uint8Array(j);return e.streamXOR(this._key,C,E,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),R,K.subarray(0,K.length-this.tagLength),T),s.wipe(C),K},_.prototype.open=function(p,E,T,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(E.length<this.tagLength)return null;var C=new Uint8Array(16);C.set(p,C.length-p.length);var R=new Uint8Array(32);e.stream(this._key,C,R,4);var j=new Uint8Array(this.tagLength);if(this._authenticate(j,R,E.subarray(0,E.length-this.tagLength),T),!u.equal(j,E.subarray(E.length-this.tagLength,E.length)))return null;var K=E.length-this.tagLength,se;if(D){if(D.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");se=D}else se=new Uint8Array(K);return e.streamXOR(this._key,C,E.subarray(0,E.length-this.tagLength),se,4),s.wipe(C),se},_.prototype.clean=function(){return s.wipe(this._key),this},_.prototype._authenticate=function(p,E,T,D){var C=new t.Poly1305(E);D&&(C.update(D),D.length%16>0&&C.update(f.subarray(D.length%16))),C.update(T),T.length%16>0&&C.update(f.subarray(T.length%16));var R=new Uint8Array(8);D&&o.writeUint64LE(D.length,R),C.update(R),o.writeUint64LE(T.length,R),C.update(R);for(var j=C.digest(),K=0;K<j.length;K++)p[K]=j[K];C.clean(),s.wipe(j),s.wipe(R)},_}();n.ChaCha20Poly1305=l}(Ha);var xh={},Qi={},za={};Object.defineProperty(za,"__esModule",{value:!0});function nv(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}za.isSerializableHash=nv,Object.defineProperty(Qi,"__esModule",{value:!0});var Yr=za,iv=wn,sv=Er,Oh=function(){function n(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Yr.isSerializableHash(this._inner)&&Yr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),sv.wipe(s)}return n.prototype.reset=function(){if(!Yr.isSerializableHash(this._inner)||!Yr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Yr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Yr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!Yr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!Yr.isSerializableHash(this._inner)||!Yr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!Yr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();Qi.HMAC=Oh;function ov(n,e,t){var s=new Oh(n,e);s.update(t);var o=s.digest();return s.clean(),o}Qi.hmac=ov,Qi.equal=iv.equal,Object.defineProperty(xh,"__esModule",{value:!0});var Ih=Qi,Ah=Er,av=function(){function n(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var u=Ih.hmac(this._hash,s,t);this._hmac=new Ih.HMAC(e,u),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},n.prototype.clean=function(){this._hmac.clean(),Ah.wipe(this._buffer),Ah.wipe(this._counter),this._bufpos=0},n}(),uv=xh.HKDF=av,js={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ne,t=Er;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function l(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},l.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var E=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=_[E++],p--;this._bufferLength===this.blockSize&&(u(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(E=u(this._temp,this._state,_,E,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[E++],p--;return this},l.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,E=this._bufferLength,T=p/536870912|0,D=p<<3,C=p%64<56?64:128;this._buffer[E]=128;for(var R=E+1;R<C-8;R++)this._buffer[R]=0;e.writeUint32BE(T,this._buffer,C-8),e.writeUint32BE(D,this._buffer,C-4),u(this._temp,this._state,this._buffer,0,C),this._finished=!0}for(var R=0;R<this.digestLength/4;R++)e.writeUint32BE(this._state[R],_,R*4);return this},l.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(_){return this._state.set(_.state),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(_){t.wipe(_.state),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},l}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function u(l,_,p,E,T){for(;T>=64;){for(var D=_[0],C=_[1],R=_[2],j=_[3],K=_[4],se=_[5],L=_[6],M=_[7],x=0;x<16;x++){var P=E+x*4;l[x]=e.readUint32BE(p,P)}for(var x=16;x<64;x++){var m=l[x-2],c=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=l[x-15];var b=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;l[x]=(c+l[x-7]|0)+(b+l[x-16]|0)}for(var x=0;x<64;x++){var c=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&se^~K&L)|0)+(M+(o[x]+l[x]|0)|0)|0,b=((D>>>2|D<<32-2)^(D>>>13|D<<32-13)^(D>>>22|D<<32-22))+(D&C^D&R^C&R)|0;M=L,L=se,se=K,K=j+c|0,j=R,R=C,C=D,D=c+b|0}_[0]+=D,_[1]+=C,_[2]+=R,_[3]+=j,_[4]+=K,_[5]+=se,_[6]+=L,_[7]+=M,E+=64,T-=64}return E}function f(l){var _=new s;_.update(l);var p=_.digest();return _.clean(),p}n.hash=f})(js);var Ka={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=di,t=Er;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(x){const P=new Float64Array(16);if(x)for(let m=0;m<x.length;m++)P[m]=x[m];return P}const o=new Uint8Array(32);o[0]=9;const u=s([56129,1]);function f(x){let P=1;for(let m=0;m<16;m++){let c=x[m]+P+65535;P=Math.floor(c/65536),x[m]=c-P*65536}x[0]+=P-1+37*(P-1)}function l(x,P,m){const c=~(m-1);for(let b=0;b<16;b++){const V=c&(x[b]^P[b]);x[b]^=V,P[b]^=V}}function _(x,P){const m=s(),c=s();for(let b=0;b<16;b++)c[b]=P[b];f(c),f(c),f(c);for(let b=0;b<2;b++){m[0]=c[0]-65517;for(let Y=1;Y<15;Y++)m[Y]=c[Y]-65535-(m[Y-1]>>16&1),m[Y-1]&=65535;m[15]=c[15]-32767-(m[14]>>16&1);const V=m[15]>>16&1;m[14]&=65535,l(c,m,1-V)}for(let b=0;b<16;b++)x[2*b]=c[b]&255,x[2*b+1]=c[b]>>8}function p(x,P){for(let m=0;m<16;m++)x[m]=P[2*m]+(P[2*m+1]<<8);x[15]&=32767}function E(x,P,m){for(let c=0;c<16;c++)x[c]=P[c]+m[c]}function T(x,P,m){for(let c=0;c<16;c++)x[c]=P[c]-m[c]}function D(x,P,m){let c,b,V=0,Y=0,ie=0,ue=0,de=0,w=0,I=0,ee=0,X=0,G=0,W=0,J=0,re=0,we=0,oe=0,me=0,he=0,ve=0,H=0,q=0,F=0,d=0,A=0,ae=0,le=0,xe=0,je=0,Ge=0,Ue=0,gt=0,_t=0,Be=m[0],Oe=m[1],Le=m[2],Fe=m[3],qe=m[4],Ae=m[5],$e=m[6],De=m[7],Pe=m[8],ze=m[9],Ie=m[10],We=m[11],ke=m[12],et=m[13],tt=m[14],Xe=m[15];c=P[0],V+=c*Be,Y+=c*Oe,ie+=c*Le,ue+=c*Fe,de+=c*qe,w+=c*Ae,I+=c*$e,ee+=c*De,X+=c*Pe,G+=c*ze,W+=c*Ie,J+=c*We,re+=c*ke,we+=c*et,oe+=c*tt,me+=c*Xe,c=P[1],Y+=c*Be,ie+=c*Oe,ue+=c*Le,de+=c*Fe,w+=c*qe,I+=c*Ae,ee+=c*$e,X+=c*De,G+=c*Pe,W+=c*ze,J+=c*Ie,re+=c*We,we+=c*ke,oe+=c*et,me+=c*tt,he+=c*Xe,c=P[2],ie+=c*Be,ue+=c*Oe,de+=c*Le,w+=c*Fe,I+=c*qe,ee+=c*Ae,X+=c*$e,G+=c*De,W+=c*Pe,J+=c*ze,re+=c*Ie,we+=c*We,oe+=c*ke,me+=c*et,he+=c*tt,ve+=c*Xe,c=P[3],ue+=c*Be,de+=c*Oe,w+=c*Le,I+=c*Fe,ee+=c*qe,X+=c*Ae,G+=c*$e,W+=c*De,J+=c*Pe,re+=c*ze,we+=c*Ie,oe+=c*We,me+=c*ke,he+=c*et,ve+=c*tt,H+=c*Xe,c=P[4],de+=c*Be,w+=c*Oe,I+=c*Le,ee+=c*Fe,X+=c*qe,G+=c*Ae,W+=c*$e,J+=c*De,re+=c*Pe,we+=c*ze,oe+=c*Ie,me+=c*We,he+=c*ke,ve+=c*et,H+=c*tt,q+=c*Xe,c=P[5],w+=c*Be,I+=c*Oe,ee+=c*Le,X+=c*Fe,G+=c*qe,W+=c*Ae,J+=c*$e,re+=c*De,we+=c*Pe,oe+=c*ze,me+=c*Ie,he+=c*We,ve+=c*ke,H+=c*et,q+=c*tt,F+=c*Xe,c=P[6],I+=c*Be,ee+=c*Oe,X+=c*Le,G+=c*Fe,W+=c*qe,J+=c*Ae,re+=c*$e,we+=c*De,oe+=c*Pe,me+=c*ze,he+=c*Ie,ve+=c*We,H+=c*ke,q+=c*et,F+=c*tt,d+=c*Xe,c=P[7],ee+=c*Be,X+=c*Oe,G+=c*Le,W+=c*Fe,J+=c*qe,re+=c*Ae,we+=c*$e,oe+=c*De,me+=c*Pe,he+=c*ze,ve+=c*Ie,H+=c*We,q+=c*ke,F+=c*et,d+=c*tt,A+=c*Xe,c=P[8],X+=c*Be,G+=c*Oe,W+=c*Le,J+=c*Fe,re+=c*qe,we+=c*Ae,oe+=c*$e,me+=c*De,he+=c*Pe,ve+=c*ze,H+=c*Ie,q+=c*We,F+=c*ke,d+=c*et,A+=c*tt,ae+=c*Xe,c=P[9],G+=c*Be,W+=c*Oe,J+=c*Le,re+=c*Fe,we+=c*qe,oe+=c*Ae,me+=c*$e,he+=c*De,ve+=c*Pe,H+=c*ze,q+=c*Ie,F+=c*We,d+=c*ke,A+=c*et,ae+=c*tt,le+=c*Xe,c=P[10],W+=c*Be,J+=c*Oe,re+=c*Le,we+=c*Fe,oe+=c*qe,me+=c*Ae,he+=c*$e,ve+=c*De,H+=c*Pe,q+=c*ze,F+=c*Ie,d+=c*We,A+=c*ke,ae+=c*et,le+=c*tt,xe+=c*Xe,c=P[11],J+=c*Be,re+=c*Oe,we+=c*Le,oe+=c*Fe,me+=c*qe,he+=c*Ae,ve+=c*$e,H+=c*De,q+=c*Pe,F+=c*ze,d+=c*Ie,A+=c*We,ae+=c*ke,le+=c*et,xe+=c*tt,je+=c*Xe,c=P[12],re+=c*Be,we+=c*Oe,oe+=c*Le,me+=c*Fe,he+=c*qe,ve+=c*Ae,H+=c*$e,q+=c*De,F+=c*Pe,d+=c*ze,A+=c*Ie,ae+=c*We,le+=c*ke,xe+=c*et,je+=c*tt,Ge+=c*Xe,c=P[13],we+=c*Be,oe+=c*Oe,me+=c*Le,he+=c*Fe,ve+=c*qe,H+=c*Ae,q+=c*$e,F+=c*De,d+=c*Pe,A+=c*ze,ae+=c*Ie,le+=c*We,xe+=c*ke,je+=c*et,Ge+=c*tt,Ue+=c*Xe,c=P[14],oe+=c*Be,me+=c*Oe,he+=c*Le,ve+=c*Fe,H+=c*qe,q+=c*Ae,F+=c*$e,d+=c*De,A+=c*Pe,ae+=c*ze,le+=c*Ie,xe+=c*We,je+=c*ke,Ge+=c*et,Ue+=c*tt,gt+=c*Xe,c=P[15],me+=c*Be,he+=c*Oe,ve+=c*Le,H+=c*Fe,q+=c*qe,F+=c*Ae,d+=c*$e,A+=c*De,ae+=c*Pe,le+=c*ze,xe+=c*Ie,je+=c*We,Ge+=c*ke,Ue+=c*et,gt+=c*tt,_t+=c*Xe,V+=38*he,Y+=38*ve,ie+=38*H,ue+=38*q,de+=38*F,w+=38*d,I+=38*A,ee+=38*ae,X+=38*le,G+=38*xe,W+=38*je,J+=38*Ge,re+=38*Ue,we+=38*gt,oe+=38*_t,b=1,c=V+b+65535,b=Math.floor(c/65536),V=c-b*65536,c=Y+b+65535,b=Math.floor(c/65536),Y=c-b*65536,c=ie+b+65535,b=Math.floor(c/65536),ie=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=w+b+65535,b=Math.floor(c/65536),w=c-b*65536,c=I+b+65535,b=Math.floor(c/65536),I=c-b*65536,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=X+b+65535,b=Math.floor(c/65536),X=c-b*65536,c=G+b+65535,b=Math.floor(c/65536),G=c-b*65536,c=W+b+65535,b=Math.floor(c/65536),W=c-b*65536,c=J+b+65535,b=Math.floor(c/65536),J=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,V+=b-1+37*(b-1),b=1,c=V+b+65535,b=Math.floor(c/65536),V=c-b*65536,c=Y+b+65535,b=Math.floor(c/65536),Y=c-b*65536,c=ie+b+65535,b=Math.floor(c/65536),ie=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=w+b+65535,b=Math.floor(c/65536),w=c-b*65536,c=I+b+65535,b=Math.floor(c/65536),I=c-b*65536,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=X+b+65535,b=Math.floor(c/65536),X=c-b*65536,c=G+b+65535,b=Math.floor(c/65536),G=c-b*65536,c=W+b+65535,b=Math.floor(c/65536),W=c-b*65536,c=J+b+65535,b=Math.floor(c/65536),J=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,V+=b-1+37*(b-1),x[0]=V,x[1]=Y,x[2]=ie,x[3]=ue,x[4]=de,x[5]=w,x[6]=I,x[7]=ee,x[8]=X,x[9]=G,x[10]=W,x[11]=J,x[12]=re,x[13]=we,x[14]=oe,x[15]=me}function C(x,P){D(x,P,P)}function R(x,P){const m=s();for(let c=0;c<16;c++)m[c]=P[c];for(let c=253;c>=0;c--)C(m,m),c!==2&&c!==4&&D(m,m,P);for(let c=0;c<16;c++)x[c]=m[c]}function j(x,P){const m=new Uint8Array(32),c=new Float64Array(80),b=s(),V=s(),Y=s(),ie=s(),ue=s(),de=s();for(let X=0;X<31;X++)m[X]=x[X];m[31]=x[31]&127|64,m[0]&=248,p(c,P);for(let X=0;X<16;X++)V[X]=c[X];b[0]=ie[0]=1;for(let X=254;X>=0;--X){const G=m[X>>>3]>>>(X&7)&1;l(b,V,G),l(Y,ie,G),E(ue,b,Y),T(b,b,Y),E(Y,V,ie),T(V,V,ie),C(ie,ue),C(de,b),D(b,Y,b),D(Y,V,ue),E(ue,b,Y),T(b,b,Y),C(V,b),T(Y,ie,de),D(b,Y,u),E(b,b,ie),D(Y,Y,b),D(b,ie,de),D(ie,V,c),C(V,ue),l(b,V,G),l(Y,ie,G)}for(let X=0;X<16;X++)c[X+16]=b[X],c[X+32]=Y[X],c[X+48]=V[X],c[X+64]=ie[X];const w=c.subarray(32),I=c.subarray(16);R(w,w),D(I,I,w);const ee=new Uint8Array(32);return _(ee,I),ee}n.scalarMult=j;function K(x){return j(x,o)}n.scalarMultBase=K;function se(x){if(x.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const P=new Uint8Array(x);return{publicKey:K(P),secretKey:P}}n.generateKeyPairFromSeed=se;function L(x){const P=(0,e.randomBytes)(32,x),m=se(P);return(0,t.wipe)(P),m}n.generateKeyPair=L;function M(x,P,m=!1){if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(P.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=j(x,P);if(m){let b=0;for(let V=0;V<c.length;V++)b|=c[V];if(b===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=M})(Ka);var Ph=function(n,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,u;s<o;s++)(u||!(s in e))&&(u||(u=Array.prototype.slice.call(e,0,s)),u[s]=e[s]);return n.concat(u||Array.prototype.slice.call(e))},cv=function(){function n(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return n}(),fv=function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return n}(),hv=function(){function n(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return n}(),lv=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),dv=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),pv=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,gv=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Th=3,_v=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",pv]],Ch=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function yv(n){return n?Rh(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new dv:typeof navigator<"u"?Rh(navigator.userAgent):wv()}function vv(n){return n!==""&&_v.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var u=o.exec(n);return!!u&&[s,u]},!1)}function Rh(n){var e=vv(n);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new lv;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<Th&&(o=Ph(Ph([],o,!0),mv(Th-o.length),!0)):o=[];var u=o.join("."),f=bv(n),l=gv.exec(n);return l&&l[1]?new hv(t,u,f,l[1]):new cv(t,u,f)}function bv(n){for(var e=0,t=Ch.length;e<t;e++){var s=Ch[e],o=s[0],u=s[1],f=u.exec(n);if(f)return o}return null}function wv(){var n=typeof process<"u"&&process.version;return n?new fv(process.version.slice(1)):null}function mv(n){for(var e=[],t=0;t<n;t++)e.push("0");return e}var ht={};Object.defineProperty(ht,"__esModule",{value:!0}),ht.getLocalStorage=ht.getLocalStorageOrThrow=ht.getCrypto=ht.getCryptoOrThrow=Lh=ht.getLocation=ht.getLocationOrThrow=Ga=ht.getNavigator=ht.getNavigatorOrThrow=Nh=ht.getDocument=ht.getDocumentOrThrow=ht.getFromWindowOrThrow=ht.getFromWindow=void 0;function Kn(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}ht.getFromWindow=Kn;function pi(n){const e=Kn(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}ht.getFromWindowOrThrow=pi;function Ev(){return pi("document")}ht.getDocumentOrThrow=Ev;function Sv(){return Kn("document")}var Nh=ht.getDocument=Sv;function Dv(){return pi("navigator")}ht.getNavigatorOrThrow=Dv;function xv(){return Kn("navigator")}var Ga=ht.getNavigator=xv;function Ov(){return pi("location")}ht.getLocationOrThrow=Ov;function Iv(){return Kn("location")}var Lh=ht.getLocation=Iv;function Av(){return pi("crypto")}ht.getCryptoOrThrow=Av;function Pv(){return Kn("crypto")}ht.getCrypto=Pv;function Tv(){return pi("localStorage")}ht.getLocalStorageOrThrow=Tv;function Cv(){return Kn("localStorage")}ht.getLocalStorage=Cv;var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});var Fh=Wa.getWindowMetadata=void 0;const $h=ht;function Rv(){let n,e;try{n=$h.getDocumentOrThrow(),e=$h.getLocationOrThrow()}catch{return null}function t(){const T=n.getElementsByTagName("link"),D=[];for(let C=0;C<T.length;C++){const R=T[C],j=R.getAttribute("rel");if(j&&j.toLowerCase().indexOf("icon")>-1){const K=R.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let se=e.protocol+"//"+e.host;if(K.indexOf("/")===0)se+=K;else{const L=e.pathname.split("/");L.pop();const M=L.join("/");se+=M+"/"+K}D.push(se)}else if(K.indexOf("//")===0){const se=e.protocol+K;D.push(se)}else D.push(K)}}return D}function s(...T){const D=n.getElementsByTagName("meta");for(let C=0;C<D.length;C++){const R=D[C],j=["itemprop","property","name"].map(K=>R.getAttribute(K)).filter(K=>K?T.includes(K):!1);if(j.length&&j){const K=R.getAttribute("content");if(K)return K}}return""}function o(){let T=s("name","og:site_name","og:title","twitter:title");return T||(T=n.title),T}function u(){return s("description","og:description","twitter:description","keywords")}const f=o(),l=u(),_=e.origin,p=t();return{description:l,url:_,icons:p,name:f}}Fh=Wa.getWindowMetadata=Rv;var es={},Nv=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Uh="%[a-f0-9]{2}",Mh=new RegExp("("+Uh+")|([^%]+?)","gi"),Bh=new RegExp("("+Uh+")+","gi");function Va(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var t=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],Va(t),Va(s))}function Lv(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(Mh)||[],t=1;t<e.length;t++)n=Va(e,t).join(""),e=n.match(Mh)||[];return n}}function Fv(n){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},t=Bh.exec(n);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=Lv(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Bh.exec(n)}e["%C2"]="\uFFFD";for(var o=Object.keys(e),u=0;u<o.length;u++){var f=o[u];n=n.replace(new RegExp(f,"g"),e[f])}return n}var $v=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return Fv(n)}},Uv=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const t=n.indexOf(e);return t===-1?[n]:[n.slice(0,t),n.slice(t+e.length)]},Mv=function(n,e){for(var t={},s=Object.keys(n),o=Array.isArray(e),u=0;u<s.length;u++){var f=s[u],l=n[f];(o?e.indexOf(f)!==-1:e(f,l,n))&&(t[f]=l)}return t};(function(n){const e=Nv,t=$v,s=Uv,o=Mv,u=L=>L==null,f=Symbol("encodeFragmentIdentifier");function l(L){switch(L.arrayFormat){case"index":return M=>(x,P)=>{const m=x.length;return P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,[E(M,L),"[",m,"]"].join("")]:[...x,[E(M,L),"[",E(m,L),"]=",E(P,L)].join("")]};case"bracket":return M=>(x,P)=>P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,[E(M,L),"[]"].join("")]:[...x,[E(M,L),"[]=",E(P,L)].join("")];case"colon-list-separator":return M=>(x,P)=>P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,[E(M,L),":list="].join("")]:[...x,[E(M,L),":list=",E(P,L)].join("")];case"comma":case"separator":case"bracket-separator":{const M=L.arrayFormat==="bracket-separator"?"[]=":"=";return x=>(P,m)=>m===void 0||L.skipNull&&m===null||L.skipEmptyString&&m===""?P:(m=m===null?"":m,P.length===0?[[E(x,L),M,E(m,L)].join("")]:[[P,E(m,L)].join(L.arrayFormatSeparator)])}default:return M=>(x,P)=>P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,E(M,L)]:[...x,[E(M,L),"=",E(P,L)].join("")]}}function _(L){let M;switch(L.arrayFormat){case"index":return(x,P,m)=>{if(M=/\[(\d*)\]$/.exec(x),x=x.replace(/\[\d*\]$/,""),!M){m[x]=P;return}m[x]===void 0&&(m[x]={}),m[x][M[1]]=P};case"bracket":return(x,P,m)=>{if(M=/(\[\])$/.exec(x),x=x.replace(/\[\]$/,""),!M){m[x]=P;return}if(m[x]===void 0){m[x]=[P];return}m[x]=[].concat(m[x],P)};case"colon-list-separator":return(x,P,m)=>{if(M=/(:list)$/.exec(x),x=x.replace(/:list$/,""),!M){m[x]=P;return}if(m[x]===void 0){m[x]=[P];return}m[x]=[].concat(m[x],P)};case"comma":case"separator":return(x,P,m)=>{const c=typeof P=="string"&&P.includes(L.arrayFormatSeparator),b=typeof P=="string"&&!c&&T(P,L).includes(L.arrayFormatSeparator);P=b?T(P,L):P;const V=c||b?P.split(L.arrayFormatSeparator).map(Y=>T(Y,L)):P===null?P:T(P,L);m[x]=V};case"bracket-separator":return(x,P,m)=>{const c=/(\[\])$/.test(x);if(x=x.replace(/\[\]$/,""),!c){m[x]=P&&T(P,L);return}const b=P===null?[]:P.split(L.arrayFormatSeparator).map(V=>T(V,L));if(m[x]===void 0){m[x]=b;return}m[x]=[].concat(m[x],b)};default:return(x,P,m)=>{if(m[x]===void 0){m[x]=P;return}m[x]=[].concat(m[x],P)}}}function p(L){if(typeof L!="string"||L.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(L,M){return M.encode?M.strict?e(L):encodeURIComponent(L):L}function T(L,M){return M.decode?t(L):L}function D(L){return Array.isArray(L)?L.sort():typeof L=="object"?D(Object.keys(L)).sort((M,x)=>Number(M)-Number(x)).map(M=>L[M]):L}function C(L){const M=L.indexOf("#");return M!==-1&&(L=L.slice(0,M)),L}function R(L){let M="";const x=L.indexOf("#");return x!==-1&&(M=L.slice(x)),M}function j(L){L=C(L);const M=L.indexOf("?");return M===-1?"":L.slice(M+1)}function K(L,M){return M.parseNumbers&&!Number.isNaN(Number(L))&&typeof L=="string"&&L.trim()!==""?L=Number(L):M.parseBooleans&&L!==null&&(L.toLowerCase()==="true"||L.toLowerCase()==="false")&&(L=L.toLowerCase()==="true"),L}function se(L,M){M=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},M),p(M.arrayFormatSeparator);const x=_(M),P=Object.create(null);if(typeof L!="string"||(L=L.trim().replace(/^[?#&]/,""),!L))return P;for(const m of L.split("&")){if(m==="")continue;let[c,b]=s(M.decode?m.replace(/\+/g," "):m,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(M.arrayFormat)?b:T(b,M),x(T(c,M),b,P)}for(const m of Object.keys(P)){const c=P[m];if(typeof c=="object"&&c!==null)for(const b of Object.keys(c))c[b]=K(c[b],M);else P[m]=K(c,M)}return M.sort===!1?P:(M.sort===!0?Object.keys(P).sort():Object.keys(P).sort(M.sort)).reduce((m,c)=>{const b=P[c];return b&&typeof b=="object"&&!Array.isArray(b)?m[c]=D(b):m[c]=b,m},Object.create(null))}n.extract=j,n.parse=se,n.stringify=(L,M)=>{if(!L)return"";M=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},M),p(M.arrayFormatSeparator);const x=b=>M.skipNull&&u(L[b])||M.skipEmptyString&&L[b]==="",P=l(M),m={};for(const b of Object.keys(L))x(b)||(m[b]=L[b]);const c=Object.keys(m);return M.sort!==!1&&c.sort(M.sort),c.map(b=>{const V=L[b];return V===void 0?"":V===null?E(b,M):Array.isArray(V)?V.length===0&&M.arrayFormat==="bracket-separator"?E(b,M)+"[]":V.reduce(P(b),[]).join("&"):E(b,M)+"="+E(V,M)}).filter(b=>b.length>0).join("&")},n.parseUrl=(L,M)=>{M=Object.assign({decode:!0},M);const[x,P]=s(L,"#");return Object.assign({url:x.split("?")[0]||"",query:se(j(L),M)},M&&M.parseFragmentIdentifier&&P?{fragmentIdentifier:T(P,M)}:{})},n.stringifyUrl=(L,M)=>{M=Object.assign({encode:!0,strict:!0,[f]:!0},M);const x=C(L.url).split("?")[0]||"",P=n.extract(L.url),m=n.parse(P,{sort:!1}),c=Object.assign(m,L.query);let b=n.stringify(c,M);b&&(b=`?${b}`);let V=R(L.url);return L.fragmentIdentifier&&(V=`#${M[f]?E(L.fragmentIdentifier,M):L.fragmentIdentifier}`),`${x}${b}${V}`},n.pick=(L,M,x)=>{x=Object.assign({parseFragmentIdentifier:!0,[f]:!1},x);const{url:P,query:m,fragmentIdentifier:c}=n.parseUrl(L,x);return n.stringifyUrl({url:P,query:o(m,M),fragmentIdentifier:c},x)},n.exclude=(L,M,x)=>{const P=Array.isArray(M)?m=>!M.includes(m):(m,c)=>!M(m,c);return n.pick(L,P,x)}})(es);const Bv={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function qh(n,e){return n.includes(":")?[n]:e.chains||[]}const Hh="base10",sr="base16",ka="base64pad",Ya="utf8",jh=0,Gn=1,qv=0,zh=1,Ja=12,Xa=32;function Hv(){const n=Ka.generateKeyPair();return{privateKey:ir(n.secretKey,sr),publicKey:ir(n.publicKey,sr)}}function Za(){const n=di.randomBytes(Xa);return ir(n,sr)}function jv(n,e){const t=Ka.sharedKey(pr(n,sr),pr(e,sr)),s=new uv(js.SHA256,t).expand(Xa);return ir(s,sr)}function zv(n){const e=js.hash(pr(n,sr));return ir(e,sr)}function gi(n){const e=js.hash(pr(n,Ya));return ir(e,sr)}function Kv(n){return pr(`${n}`,Hh)}function ts(n){return Number(ir(n,Hh))}function Gv(n){const e=Kv(typeof n.type<"u"?n.type:jh);if(ts(e)===Gn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof n.senderPublicKey<"u"?pr(n.senderPublicKey,sr):void 0,s=typeof n.iv<"u"?pr(n.iv,sr):di.randomBytes(Ja),o=new Ha.ChaCha20Poly1305(pr(n.symKey,sr)).seal(s,pr(n.message,Ya));return Vv({type:e,sealed:o,iv:s,senderPublicKey:t})}function Wv(n){const e=new Ha.ChaCha20Poly1305(pr(n.symKey,sr)),{sealed:t,iv:s}=zs(n.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return ir(o,Ya)}function Vv(n){if(ts(n.type)===Gn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ir(Ua([n.type,n.senderPublicKey,n.iv,n.sealed]),ka)}return ir(Ua([n.type,n.iv,n.sealed]),ka)}function zs(n){const e=pr(n,ka),t=e.slice(qv,zh),s=zh;if(ts(t)===Gn){const l=s+Xa,_=l+Ja,p=e.slice(s,l),E=e.slice(l,_),T=e.slice(_);return{type:t,sealed:T,iv:E,senderPublicKey:p}}const o=s+Ja,u=e.slice(s,o),f=e.slice(o);return{type:t,sealed:f,iv:u}}function kv(n,e){const t=zs(n);return Kh({type:ts(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ir(t.senderPublicKey,sr):void 0,receiverPublicKey:e?.receiverPublicKey})}function Kh(n){const e=n?.type||jh;if(e===Gn){if(typeof n?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof n?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n?.senderPublicKey,receiverPublicKey:n?.receiverPublicKey}}function Gh(n){return n.type===Gn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Yv=Object.defineProperty,Wh=Object.getOwnPropertySymbols,Jv=Object.prototype.hasOwnProperty,Xv=Object.prototype.propertyIsEnumerable,Vh=(n,e,t)=>e in n?Yv(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,kh=(n,e)=>{for(var t in e||(e={}))Jv.call(e,t)&&Vh(n,t,e[t]);if(Wh)for(var t of Wh(e))Xv.call(e,t)&&Vh(n,t,e[t]);return n};const Zv="ReactNative",mn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Qv="js";function Qa(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Yh(){return!Nh()&&!!Ga()&&navigator.product===Zv}function eu(){return!Qa()&&!!Ga()}function tu(){return Yh()?mn.reactNative:Qa()?mn.node:eu()?mn.browser:mn.unknown}function eb(n,e){let t=es.parse(n);return t=kh(kh({},t),e),n=es.stringify(t),n}function tb(){return Fh()||{name:"",description:"",url:"",icons:[""]}}function rb(){if(tu()===mn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const n=yv();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function nb(){var n;const e=tu();return e===mn.browser?[e,((n=Lh())==null?void 0:n.host)||"unknown"].join(":"):e}function ib(n,e,t){const s=rb(),o=nb();return[[n,e].join("-"),[Qv,t].join("-"),s,o].join("/")}function sb({protocol:n,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:u,useOnCloseEvent:f}){const l=t.split("?"),_=ib(n,e,s),p={auth:o,ua:_,projectId:u,useOnCloseEvent:f||void 0},E=eb(l[1]||"",p);return l[0]+"?"+E}function Wn(n,e){return n.filter(t=>e.includes(t)).length===n.length}function Jh(n){return Object.fromEntries(n.entries())}function Xh(n){return new Map(Object.entries(n))}function _i(n=_e.FIVE_MINUTES,e){const t=_e.toMiliseconds(n||_e.FIVE_MINUTES);let s,o,u;return{resolve:f=>{u&&s&&(clearTimeout(u),s(f))},reject:f=>{u&&o&&(clearTimeout(u),o(f))},done:()=>new Promise((f,l)=>{u=setTimeout(()=>{l(new Error(e))},t),s=f,o=l})}}function Ks(n,e,t){return new Promise(async(s,o)=>{const u=setTimeout(()=>o(new Error(t)),e);try{const f=await n;s(f)}catch(f){o(f)}clearTimeout(u)})}function Zh(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function ob(n){return Zh("topic",n)}function ab(n){return Zh("id",n)}function Qh(n){const[e,t]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Hr(n,e){return _e.fromMiliseconds((e||Date.now())+_e.toMiliseconds(n))}function En(n){return Date.now()>=_e.toMiliseconds(n)}function $t(n,e){return`${n}${e?`:${e}`:""}`}function ru(n=[],e=[]){return[...new Set([...n,...e])]}async function ub({id:n,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s?.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const u=`${o}/wc?requestId=${n}&sessionTopic=${e}`,f=tu();f===mn.browser?u.startsWith("https://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):f===mn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(u)}catch(s){console.error(s)}}const cb="irn";function nu(n){return n?.relay||{protocol:cb}}function Gs(n){const e=Bv[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var fb=Object.defineProperty,el=Object.getOwnPropertySymbols,hb=Object.prototype.hasOwnProperty,lb=Object.prototype.propertyIsEnumerable,tl=(n,e,t)=>e in n?fb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,db=(n,e)=>{for(var t in e||(e={}))hb.call(e,t)&&tl(n,t,e[t]);if(el)for(var t of el(e))lb.call(e,t)&&tl(n,t,e[t]);return n};function pb(n,e="-"){const t={},s="relay"+e;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const u=o.replace(s,""),f=n[o];t[u]=f}}),t}function gb(n){const e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),o=n.substring(e+1,t).split("@"),u=typeof t<"u"?n.substring(t):"",f=es.parse(u);return{protocol:s,topic:_b(o[0]),version:parseInt(o[1],10),symKey:f.symKey,relay:pb(f)}}function _b(n){return n.startsWith("//")?n.substring(2):n}function yb(n,e="-"){const t="relay",s={};return Object.keys(n).forEach(o=>{const u=t+e+o;n[o]&&(s[u]=n[o])}),s}function vb(n){return`${n.protocol}:${n.topic}@${n.version}?`+es.stringify(db({symKey:n.symKey},yb(n.relay)))}function yi(n){const e=[];return n.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function bb(n){const e=[];return Object.values(n).forEach(t=>{e.push(...yi(t.accounts))}),e}function wb(n,e){const t=[];return Object.values(n).forEach(s=>{yi(s.accounts).includes(e)&&t.push(...s.methods)}),t}function mb(n,e){const t=[];return Object.values(n).forEach(s=>{yi(s.accounts).includes(e)&&t.push(...s.events)}),t}function Eb(n,e){const t=ks(n,e);if(t)throw new Error(t.message);const s={};for(const[o,u]of Object.entries(n))s[o]={methods:u.methods,events:u.events,chains:u.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}function iu(n){return n.includes(":")}function Ws(n){return iu(n)?n.split(":")[0]:n}const Sb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Db={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function fe(n,e){const{message:t,code:s}=Db[n];return{message:e?`${t} ${e}`:t,code:s}}function Ut(n,e){const{message:t,code:s}=Sb[n];return{message:e?`${t} ${e}`:t,code:s}}function Vn(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function vi(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function or(n){return typeof n>"u"}function Vt(n,e){return e&&or(n)?!0:typeof n=="string"&&!!n.trim().length}function su(n,e){return e&&or(n)?!0:typeof n=="number"&&!isNaN(n)}function xb(n,e){const{requiredNamespaces:t}=e,s=Object.keys(n.namespaces),o=Object.keys(t);let u=!0;return Wn(o,s)?(s.forEach(f=>{const{accounts:l,methods:_,events:p}=n.namespaces[f],E=yi(l),T=t[f];(!Wn(qh(f,T),E)||!Wn(T.methods,_)||!Wn(T.events,p))&&(u=!1)}),u):!1}function Vs(n){return Vt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function Ob(n){if(Vt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Vs(t)}}return!1}function Ib(n){if(Vt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Ab(n){var e;return(e=n?.proposer)==null?void 0:e.publicKey}function Pb(n){return n?.topic}function Tb(n,e){let t=null;return Vt(n?.publicKey,!1)||(t=fe("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function rl(n){let e=!0;return Vn(n)?n.length&&(e=n.every(t=>Vt(t,!1))):e=!1,e}function Cb(n,e,t){let s=null;return Vn(e)&&e.length?e.forEach(o=>{s||Vs(o)||(s=Ut("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Vs(n)||(s=Ut("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Rb(n,e,t){let s=null;return Object.entries(n).forEach(([o,u])=>{if(s)return;const f=Cb(o,qh(o,u),`${e} ${t}`);f&&(s=f)}),s}function Nb(n,e){let t=null;return Vn(n)?n.forEach(s=>{t||Ob(s)||(t=Ut("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=Ut("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Lb(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=Nb(s?.accounts,`${e} namespace`);o&&(t=o)}),t}function Fb(n,e){let t=null;return rl(n?.methods)?rl(n?.events)||(t=Ut("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ut("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function nl(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=Fb(s,`${e}, namespace`);o&&(t=o)}),t}function $b(n,e,t){let s=null;if(n&&vi(n)){const o=nl(n,e);o&&(s=o);const u=Rb(n,e,t);u&&(s=u)}else s=fe("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function ks(n,e){let t=null;if(n&&vi(n)){const s=nl(n,e);s&&(t=s);const o=Lb(n,e);o&&(t=o)}else t=fe("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function il(n){return Vt(n.protocol,!0)}function Ub(n,e){let t=!1;return e&&!n?t=!0:n&&Vn(n)&&n.length&&n.forEach(s=>{t=il(s)}),t}function Mb(n){return typeof n=="number"}function gr(n){return typeof n<"u"&&typeof n!==null}function Bb(n){return!(!n||typeof n!="object"||!n.code||!su(n.code,!1)||!n.message||!Vt(n.message,!1))}function qb(n){return!(or(n)||!Vt(n.method,!1))}function Hb(n){return!(or(n)||or(n.result)&&or(n.error)||!su(n.id,!1)||!Vt(n.jsonrpc,!1))}function jb(n){return!(or(n)||!Vt(n.name,!1))}function sl(n,e){return!(!Vs(e)||!bb(n).includes(e))}function zb(n,e,t){return Vt(t,!1)?wb(n,e).includes(t):!1}function Kb(n,e,t){return Vt(t,!1)?mb(n,e).includes(t):!1}function ol(n,e,t){let s=null;const o=Gb(n),u=Wb(e),f=Object.keys(o),l=Object.keys(u),_=al(Object.keys(n)),p=al(Object.keys(e)),E=_.filter(T=>!p.includes(T));return E.length&&(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${E.toString()}
      Received: ${Object.keys(e).toString()}`)),Wn(f,l)||(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${l.toString()}`)),Object.keys(e).forEach(T=>{if(!T.includes(":")||s)return;const D=yi(e[T].accounts);D.includes(T)||(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${T}
        Required: ${T}
        Approved: ${D.toString()}`))}),f.forEach(T=>{s||(Wn(o[T].methods,u[T].methods)?Wn(o[T].events,u[T].events)||(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${T}`)):s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${T}`))}),s}function Gb(n){const e={};return Object.keys(n).forEach(t=>{var s;t.includes(":")?e[t]=n[t]:(s=n[t].chains)==null||s.forEach(o=>{e[o]={methods:n[t].methods,events:n[t].events}})}),e}function al(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Wb(n){const e={};return Object.keys(n).forEach(t=>{if(t.includes(":"))e[t]=n[t];else{const s=yi(n[t].accounts);s?.forEach(o=>{e[o]={accounts:n[t].accounts.filter(u=>u.includes(`${o}:`)),methods:n[t].methods,events:n[t].events}})}}),e}function Vb(n,e){return su(n,!1)&&n<=e.max&&n>=e.min}const kb="PARSE_ERROR",Yb="INVALID_REQUEST",Jb="METHOD_NOT_FOUND",Xb="INVALID_PARAMS",ul="INTERNAL_ERROR",ou="SERVER_ERROR",Zb=[-32700,-32600,-32601,-32602,-32603],rs={[kb]:{code:-32700,message:"Parse error"},[Yb]:{code:-32600,message:"Invalid Request"},[Jb]:{code:-32601,message:"Method not found"},[Xb]:{code:-32602,message:"Invalid params"},[ul]:{code:-32603,message:"Internal error"},[ou]:{code:-32e3,message:"Server error"}},cl=ou;function Qb(n){return Zb.includes(n)}function fl(n){return Object.keys(rs).includes(n)?rs[n]:rs[cl]}function ew(n){const e=Object.values(rs).find(t=>t.code===n);return e||rs[cl]}function hl(n,e,t){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):n}var ll={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var au=function(n,e){return au=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},au(n,e)};function tw(n,e){au(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var uu=function(){return uu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},uu.apply(this,arguments)};function rw(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function nw(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(f=n[l])&&(u=(o<3?f(u):o>3?f(e,t,u):f(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function iw(n,e){return function(t,s){e(t,s,n)}}function sw(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function ow(n,e,t,s){function o(u){return u instanceof t?u:new t(function(f){f(u)})}return new(t||(t=Promise))(function(u,f){function l(E){try{p(s.next(E))}catch(T){f(T)}}function _(E){try{p(s.throw(E))}catch(T){f(T)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function aw(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,f;return f={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function uw(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function cw(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function cu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function dl(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],f;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){f={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(f)throw f.error}}return u}function fw(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(dl(arguments[e]));return n}function hw(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],f=0,l=u.length;f<l;f++,o++)s[o]=u[f];return s}function ns(n){return this instanceof ns?(this.v=n,this):new ns(n)}function lw(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(D){s[D]&&(o[D]=function(C){return new Promise(function(R,j){u.push([D,C,R,j])>1||l(D,C)})})}function l(D,C){try{_(s[D](C))}catch(R){T(u[0][3],R)}}function _(D){D.value instanceof ns?Promise.resolve(D.value.v).then(p,E):T(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function T(D,C){D(C),u.shift(),u.length&&l(u[0][0],u[0][1])}}function dw(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(f){return(t=!t)?{value:ns(n[o](f)),done:o==="return"}:u?u(f):f}:u}}function pw(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof cu=="function"?cu(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(f){return new Promise(function(l,_){f=n[u](f),o(l,_,f.done,f.value)})}}function o(u,f,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},f)}}function gw(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function _w(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function yw(n){return n&&n.__esModule?n:{default:n}}function vw(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function bw(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var ww=Object.freeze({__proto__:null,__extends:tw,get __assign(){return uu},__rest:rw,__decorate:nw,__param:iw,__metadata:sw,__awaiter:ow,__generator:aw,__createBinding:uw,__exportStar:cw,__values:cu,__read:dl,__spread:fw,__spreadArrays:hw,__await:ns,__asyncGenerator:lw,__asyncDelegator:dw,__asyncValues:pw,__makeTemplateObject:gw,__importStar:_w,__importDefault:yw,__classPrivateFieldGet:vw,__classPrivateFieldSet:bw}),mw=Mn(ww),sn={},pl;function Ew(){if(pl)return sn;pl=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.isBrowserCryptoAvailable=sn.getSubtleCrypto=sn.getBrowerCrypto=void 0;function n(){return wt?.crypto||wt?.msCrypto||{}}sn.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}sn.getSubtleCrypto=e;function t(){return!!n()&&!!e()}return sn.isBrowserCryptoAvailable=t,sn}var on={},gl;function Sw(){if(gl)return on;gl=1,Object.defineProperty(on,"__esModule",{value:!0}),on.isBrowser=on.isNode=on.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}on.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}on.isNode=e;function t(){return!n()&&!e()}return on.isBrowser=t,on}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=mw;e.__exportStar(Ew(),n),e.__exportStar(Sw(),n)})(ll);function _l(n=3){const e=Date.now()*Math.pow(10,n),t=Math.floor(Math.random()*Math.pow(10,n));return e+t}function fu(n=6){return BigInt(_l(n))}function Ys(n,e,t){return{id:t||_l(),jsonrpc:"2.0",method:n,params:e}}function hu(n,e){return{id:n,jsonrpc:"2.0",result:e}}function Js(n,e,t){return{id:n,jsonrpc:"2.0",error:Dw(e,t)}}function Dw(n,e){return typeof n>"u"?fl(ul):(typeof n=="string"&&(n=Object.assign(Object.assign({},fl(ou)),{message:n})),typeof e<"u"&&(n.data=e),Qb(n.code)&&(n=ew(n.code)),n)}class xw{}class Ow extends xw{constructor(){super()}}class Iw extends Ow{constructor(e){super()}}const Aw="^https?:",Pw="^wss?:";function Tw(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function yl(n,e){const t=Tw(n);return typeof t>"u"?!1:new RegExp(e).test(t)}function vl(n){return yl(n,Aw)}function bl(n){return yl(n,Pw)}function Cw(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function wl(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function lu(n){return wl(n)&&"method"in n}function Xs(n){return wl(n)&&(an(n)||jr(n))}function an(n){return"result"in n}function jr(n){return"error"in n}class Sn extends Iw{constructor(e){super(e),this.events=new Qt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ys(e.method,e.params||[],e.id||fu().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(u){o(u)}this.events.on(`${e.id}`,u=>{jr(u)?o(u.error):s(u.result)});try{await this.connection.send(e,t)}catch(u){o(u)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Xs(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Rw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Nw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ml=n=>n.split("?")[0],El=10,Lw=Rw();class Fw{constructor(e){if(this.url=e,this.events=new Qt.exports.EventEmitter,this.registering=!1,!bl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Xi(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!bl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=ll.isReactNative()?void 0:{rejectUnauthorized:!Cw(e)},u=new Lw(e,[],o);Nw()?u.onerror=f=>{const l=f;s(this.emitError(l.error))}:u.on("error",f=>{s(this.emitError(f))}),u.onopen=()=>{this.onOpen(u),t(u)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ta(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),u=Js(e,o);this.events.emit("payload",u)}parseError(e,t=this.url){return hl(e,ml(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>El&&this.events.setMaxListeners(El)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${ml(this.url)}`));return this.events.emit("register_error",t),t}}var du={exports:{}};(function(n,e){var t=200,s="__lodash_hash_undefined__",o=1,u=2,f=9007199254740991,l="[object Arguments]",_="[object Array]",p="[object AsyncFunction]",E="[object Boolean]",T="[object Date]",D="[object Error]",C="[object Function]",R="[object GeneratorFunction]",j="[object Map]",K="[object Number]",se="[object Null]",L="[object Object]",M="[object Promise]",x="[object Proxy]",P="[object RegExp]",m="[object Set]",c="[object String]",b="[object Symbol]",V="[object Undefined]",Y="[object WeakMap]",ie="[object ArrayBuffer]",ue="[object DataView]",de="[object Float32Array]",w="[object Float64Array]",I="[object Int8Array]",ee="[object Int16Array]",X="[object Int32Array]",G="[object Uint8Array]",W="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",we=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,he={};he[de]=he[w]=he[I]=he[ee]=he[X]=he[G]=he[W]=he[J]=he[re]=!0,he[l]=he[_]=he[ie]=he[E]=he[ue]=he[T]=he[D]=he[C]=he[j]=he[K]=he[L]=he[P]=he[m]=he[c]=he[Y]=!1;var ve=typeof wt=="object"&&wt&&wt.Object===Object&&wt,H=typeof self=="object"&&self&&self.Object===Object&&self,q=ve||H||Function("return this")(),F=e&&!e.nodeType&&e,d=F&&!0&&n&&!n.nodeType&&n,A=d&&d.exports===F,ae=A&&ve.process,le=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),xe=le&&le.isTypedArray;function je(S,U){for(var te=-1,pe=S==null?0:S.length,ut=0,Ce=[];++te<pe;){var dt=S[te];U(dt,te,S)&&(Ce[ut++]=dt)}return Ce}function Ge(S,U){for(var te=-1,pe=U.length,ut=S.length;++te<pe;)S[ut+te]=U[te];return S}function Ue(S,U){for(var te=-1,pe=S==null?0:S.length;++te<pe;)if(U(S[te],te,S))return!0;return!1}function gt(S,U){for(var te=-1,pe=Array(S);++te<S;)pe[te]=U(te);return pe}function _t(S){return function(U){return S(U)}}function Be(S,U){return S.has(U)}function Oe(S,U){return S?.[U]}function Le(S){var U=-1,te=Array(S.size);return S.forEach(function(pe,ut){te[++U]=[ut,pe]}),te}function Fe(S,U){return function(te){return S(U(te))}}function qe(S){var U=-1,te=Array(S.size);return S.forEach(function(pe){te[++U]=pe}),te}var Ae=Array.prototype,$e=Function.prototype,De=Object.prototype,Pe=q["__core-js_shared__"],ze=$e.toString,Ie=De.hasOwnProperty,We=function(){var S=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}(),ke=De.toString,et=RegExp("^"+ze.call(Ie).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=A?q.Buffer:void 0,Xe=q.Symbol,ur=q.Uint8Array,_r=De.propertyIsEnumerable,Zr=Ae.splice,cr=Xe?Xe.toStringTag:void 0,un=Object.getOwnPropertySymbols,On=tt?tt.isBuffer:void 0,Yn=Fe(Object.keys,Object),Dt=Sr(q,"DataView"),yt=Sr(q,"Map"),xt=Sr(q,"Promise"),Ot=Sr(q,"Set"),mt=Sr(q,"WeakMap"),vt=Sr(Object,"create"),Mt=fn(Dt),Bt=fn(yt),It=fn(xt),qt=fn(Ot),At=fn(mt),Rt=Xe?Xe.prototype:void 0,Pt=Rt?Rt.valueOf:void 0;function lt(S){var U=-1,te=S==null?0:S.length;for(this.clear();++U<te;){var pe=S[U];this.set(pe[0],pe[1])}}function Ht(){this.__data__=vt?vt(null):{},this.size=0}function jt(S){var U=this.has(S)&&delete this.__data__[S];return this.size-=U?1:0,U}function Cu(S){var U=this.__data__;if(vt){var te=U[S];return te===s?void 0:te}return Ie.call(U,S)?U[S]:void 0}function Ru(S){var U=this.__data__;return vt?U[S]!==void 0:Ie.call(U,S)}function Nu(S,U){var te=this.__data__;return this.size+=this.has(S)?0:1,te[S]=vt&&U===void 0?s:U,this}lt.prototype.clear=Ht,lt.prototype.delete=jt,lt.prototype.get=Cu,lt.prototype.has=Ru,lt.prototype.set=Nu;function Rr(S){var U=-1,te=S==null?0:S.length;for(this.clear();++U<te;){var pe=S[U];this.set(pe[0],pe[1])}}function Lu(){this.__data__=[],this.size=0}function Fu(S){var U=this.__data__,te=Jn(U,S);if(te<0)return!1;var pe=U.length-1;return te==pe?U.pop():Zr.call(U,te,1),--this.size,!0}function $u(S){var U=this.__data__,te=Jn(U,S);return te<0?void 0:U[te][1]}function Uu(S){return Jn(this.__data__,S)>-1}function Mu(S,U){var te=this.__data__,pe=Jn(te,S);return pe<0?(++this.size,te.push([S,U])):te[pe][1]=U,this}Rr.prototype.clear=Lu,Rr.prototype.delete=Fu,Rr.prototype.get=$u,Rr.prototype.has=Uu,Rr.prototype.set=Mu;function cn(S){var U=-1,te=S==null?0:S.length;for(this.clear();++U<te;){var pe=S[U];this.set(pe[0],pe[1])}}function bi(){this.size=0,this.__data__={hash:new lt,map:new(yt||Rr),string:new lt}}function Bu(S){var U=In(this,S).delete(S);return this.size-=U?1:0,U}function wi(S){return In(this,S).get(S)}function qu(S){return In(this,S).has(S)}function Hu(S,U){var te=In(this,S),pe=te.size;return te.set(S,U),this.size+=te.size==pe?0:1,this}cn.prototype.clear=bi,cn.prototype.delete=Bu,cn.prototype.get=wi,cn.prototype.has=qu,cn.prototype.set=Hu;function mi(S){var U=-1,te=S==null?0:S.length;for(this.__data__=new cn;++U<te;)this.add(S[U])}function io(S){return this.__data__.set(S,s),this}function so(S){return this.__data__.has(S)}mi.prototype.add=mi.prototype.push=io,mi.prototype.has=so;function zr(S){var U=this.__data__=new Rr(S);this.size=U.size}function ju(){this.__data__=new Rr,this.size=0}function zu(S){var U=this.__data__,te=U.delete(S);return this.size=U.size,te}function Ku(S){return this.__data__.get(S)}function Gu(S){return this.__data__.has(S)}function oo(S,U){var te=this.__data__;if(te instanceof Rr){var pe=te.__data__;if(!yt||pe.length<t-1)return pe.push([S,U]),this.size=++te.size,this;te=this.__data__=new cn(pe)}return te.set(S,U),this.size=te.size,this}zr.prototype.clear=ju,zr.prototype.delete=zu,zr.prototype.get=Ku,zr.prototype.has=Gu,zr.prototype.set=oo;function ao(S,U){var te=Di(S),pe=!te&&wo(S),ut=!te&&!pe&&ls(S),Ce=!te&&!pe&&!ut&&So(S),dt=te||pe||ut||Ce,zt=dt?gt(S.length,String):[],Ze=zt.length;for(var ct in S)(U||Ie.call(S,ct))&&!(dt&&(ct=="length"||ut&&(ct=="offset"||ct=="parent")||Ce&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||go(ct,Ze)))&&zt.push(ct);return zt}function Jn(S,U){for(var te=S.length;te--;)if(bo(S[te][0],U))return te;return-1}function fs(S,U,te){var pe=U(S);return Di(S)?pe:Ge(pe,te(S))}function Xn(S){return S==null?S===void 0?V:se:cr&&cr in Object(S)?lo(S):ku(S)}function hs(S){return Qn(S)&&Xn(S)==l}function Zn(S,U,te,pe,ut){return S===U?!0:S==null||U==null||!Qn(S)&&!Qn(U)?S!==S&&U!==U:uo(S,U,te,pe,Zn,ut)}function uo(S,U,te,pe,ut,Ce){var dt=Di(S),zt=Di(U),Ze=dt?_:Qr(S),ct=zt?_:Qr(U);Ze=Ze==l?L:Ze,ct=ct==l?L:ct;var Nt=Ze==L,yr=ct==L,Kt=Ze==ct;if(Kt&&ls(S)){if(!ls(U))return!1;dt=!0,Nt=!1}if(Kt&&!Nt)return Ce||(Ce=new zr),dt||So(S)?Ei(S,U,te,pe,ut,Ce):Vu(S,U,Ze,te,pe,ut,Ce);if(!(te&o)){var pt=Nt&&Ie.call(S,"__wrapped__"),fr=yr&&Ie.call(U,"__wrapped__");if(pt||fr){var Kr=pt?S.value():S,Nr=fr?U.value():U;return Ce||(Ce=new zr),ut(Kr,Nr,te,pe,Ce)}}return Kt?(Ce||(Ce=new zr),ho(S,U,te,pe,ut,Ce)):!1}function Wu(S){if(!Eo(S)||yo(S))return!1;var U=xi(S)?et:oe;return U.test(fn(S))}function co(S){return Qn(S)&&mo(S.length)&&!!he[Xn(S)]}function fo(S){if(!vo(S))return Yn(S);var U=[];for(var te in Object(S))Ie.call(S,te)&&te!="constructor"&&U.push(te);return U}function Ei(S,U,te,pe,ut,Ce){var dt=te&o,zt=S.length,Ze=U.length;if(zt!=Ze&&!(dt&&Ze>zt))return!1;var ct=Ce.get(S);if(ct&&Ce.get(U))return ct==U;var Nt=-1,yr=!0,Kt=te&u?new mi:void 0;for(Ce.set(S,U),Ce.set(U,S);++Nt<zt;){var pt=S[Nt],fr=U[Nt];if(pe)var Kr=dt?pe(fr,pt,Nt,U,S,Ce):pe(pt,fr,Nt,S,U,Ce);if(Kr!==void 0){if(Kr)continue;yr=!1;break}if(Kt){if(!Ue(U,function(Nr,en){if(!Be(Kt,en)&&(pt===Nr||ut(pt,Nr,te,pe,Ce)))return Kt.push(en)})){yr=!1;break}}else if(!(pt===fr||ut(pt,fr,te,pe,Ce))){yr=!1;break}}return Ce.delete(S),Ce.delete(U),yr}function Vu(S,U,te,pe,ut,Ce,dt){switch(te){case ue:if(S.byteLength!=U.byteLength||S.byteOffset!=U.byteOffset)return!1;S=S.buffer,U=U.buffer;case ie:return!(S.byteLength!=U.byteLength||!Ce(new ur(S),new ur(U)));case E:case T:case K:return bo(+S,+U);case D:return S.name==U.name&&S.message==U.message;case P:case c:return S==U+"";case j:var zt=Le;case m:var Ze=pe&o;if(zt||(zt=qe),S.size!=U.size&&!Ze)return!1;var ct=dt.get(S);if(ct)return ct==U;pe|=u,dt.set(S,U);var Nt=Ei(zt(S),zt(U),pe,ut,Ce,dt);return dt.delete(S),Nt;case b:if(Pt)return Pt.call(S)==Pt.call(U)}return!1}function ho(S,U,te,pe,ut,Ce){var dt=te&o,zt=Si(S),Ze=zt.length,ct=Si(U),Nt=ct.length;if(Ze!=Nt&&!dt)return!1;for(var yr=Ze;yr--;){var Kt=zt[yr];if(!(dt?Kt in U:Ie.call(U,Kt)))return!1}var pt=Ce.get(S);if(pt&&Ce.get(U))return pt==U;var fr=!0;Ce.set(S,U),Ce.set(U,S);for(var Kr=dt;++yr<Ze;){Kt=zt[yr];var Nr=S[Kt],en=U[Kt];if(pe)var ds=dt?pe(en,Nr,Kt,U,S,Ce):pe(Nr,en,Kt,S,U,Ce);if(!(ds===void 0?Nr===en||ut(Nr,en,te,pe,Ce):ds)){fr=!1;break}Kr||(Kr=Kt=="constructor")}if(fr&&!Kr){var ei=S.constructor,kt=U.constructor;ei!=kt&&"constructor"in S&&"constructor"in U&&!(typeof ei=="function"&&ei instanceof ei&&typeof kt=="function"&&kt instanceof kt)&&(fr=!1)}return Ce.delete(S),Ce.delete(U),fr}function Si(S){return fs(S,Xu,po)}function In(S,U){var te=S.__data__;return _o(U)?te[typeof U=="string"?"string":"hash"]:te.map}function Sr(S,U){var te=Oe(S,U);return Wu(te)?te:void 0}function lo(S){var U=Ie.call(S,cr),te=S[cr];try{S[cr]=void 0;var pe=!0}catch{}var ut=ke.call(S);return pe&&(U?S[cr]=te:delete S[cr]),ut}var po=un?function(S){return S==null?[]:(S=Object(S),je(un(S),function(U){return _r.call(S,U)}))}:at,Qr=Xn;(Dt&&Qr(new Dt(new ArrayBuffer(1)))!=ue||yt&&Qr(new yt)!=j||xt&&Qr(xt.resolve())!=M||Ot&&Qr(new Ot)!=m||mt&&Qr(new mt)!=Y)&&(Qr=function(S){var U=Xn(S),te=U==L?S.constructor:void 0,pe=te?fn(te):"";if(pe)switch(pe){case Mt:return ue;case Bt:return j;case It:return M;case qt:return m;case At:return Y}return U});function go(S,U){return U=U??f,!!U&&(typeof S=="number"||me.test(S))&&S>-1&&S%1==0&&S<U}function _o(S){var U=typeof S;return U=="string"||U=="number"||U=="symbol"||U=="boolean"?S!=="__proto__":S===null}function yo(S){return!!We&&We in S}function vo(S){var U=S&&S.constructor,te=typeof U=="function"&&U.prototype||De;return S===te}function ku(S){return ke.call(S)}function fn(S){if(S!=null){try{return ze.call(S)}catch{}try{return S+""}catch{}}return""}function bo(S,U){return S===U||S!==S&&U!==U}var wo=hs(function(){return arguments}())?hs:function(S){return Qn(S)&&Ie.call(S,"callee")&&!_r.call(S,"callee")},Di=Array.isArray;function Yu(S){return S!=null&&mo(S.length)&&!xi(S)}var ls=On||ot;function Ju(S,U){return Zn(S,U)}function xi(S){if(!Eo(S))return!1;var U=Xn(S);return U==C||U==R||U==p||U==x}function mo(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=f}function Eo(S){var U=typeof S;return S!=null&&(U=="object"||U=="function")}function Qn(S){return S!=null&&typeof S=="object"}var So=xe?_t(xe):co;function Xu(S){return Yu(S)?ao(S):fo(S)}function at(){return[]}function ot(){return!1}n.exports=Ju})(du,du.exports);var $w=du.exports,Uw=Object.defineProperty,Sl=Object.getOwnPropertySymbols,Mw=Object.prototype.hasOwnProperty,Bw=Object.prototype.propertyIsEnumerable,Dl=(n,e,t)=>e in n?Uw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ar=(n,e)=>{for(var t in e||(e={}))Mw.call(e,t)&&Dl(n,t,e[t]);if(Sl)for(var t of Sl(e))Bw.call(e,t)&&Dl(n,t,e[t]);return n};function qw(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<n.length;o++){var u=n.charAt(o),f=u.charCodeAt(0);if(t[f]!==255)throw new TypeError(u+" is ambiguous");t[f]=o}var l=n.length,_=n.charAt(0),p=Math.log(l)/Math.log(256),E=Math.log(256)/Math.log(l);function T(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var j=0,K=0,se=0,L=R.length;se!==L&&R[se]===0;)se++,j++;for(var M=(L-se)*E+1>>>0,x=new Uint8Array(M);se!==L;){for(var P=R[se],m=0,c=M-1;(P!==0||m<K)&&c!==-1;c--,m++)P+=256*x[c]>>>0,x[c]=P%l>>>0,P=P/l>>>0;if(P!==0)throw new Error("Non-zero carry");K=m,se++}for(var b=M-K;b!==M&&x[b]===0;)b++;for(var V=_.repeat(j);b<M;++b)V+=n.charAt(x[b]);return V}function D(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var j=0;if(R[j]!==" "){for(var K=0,se=0;R[j]===_;)K++,j++;for(var L=(R.length-j)*p+1>>>0,M=new Uint8Array(L);R[j];){var x=t[R.charCodeAt(j)];if(x===255)return;for(var P=0,m=L-1;(x!==0||P<se)&&m!==-1;m--,P++)x+=l*M[m]>>>0,M[m]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");se=P,j++}if(R[j]!==" "){for(var c=L-se;c!==L&&M[c]===0;)c++;for(var b=new Uint8Array(K+(L-c)),V=K;c!==L;)b[V++]=M[c++];return b}}}function C(R){var j=D(R);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:D,decode:C}}var Hw=qw,jw=Hw;const xl=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},zw=n=>new TextEncoder().encode(n),Kw=n=>new TextDecoder().decode(n);class Gw{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ww{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ol(this,e)}}class Vw{constructor(e){this.decoders=e}or(e){return Ol(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ol=(n,e)=>new Vw(ar(ar({},n.decoders||{[n.prefix]:n}),e.decoders||{[e.prefix]:e}));class kw{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new Gw(e,t,s),this.decoder=new Ww(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Zs=({name:n,prefix:e,encode:t,decode:s})=>new kw(n,e,t,s),is=({prefix:n,name:e,alphabet:t})=>{const{encode:s,decode:o}=jw(t,e);return Zs({prefix:n,name:e,encode:s,decode:u=>xl(o(u))})},Yw=(n,e,t,s)=>{const o={};for(let E=0;E<e.length;++E)o[e[E]]=E;let u=n.length;for(;n[u-1]==="=";)--u;const f=new Uint8Array(u*t/8|0);let l=0,_=0,p=0;for(let E=0;E<u;++E){const T=o[n[E]];if(T===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<t|T,l+=t,l>=8&&(l-=8,f[p++]=255&_>>l)}if(l>=t||255&_<<8-l)throw new SyntaxError("Unexpected end of data");return f},Jw=(n,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let u="",f=0,l=0;for(let _=0;_<n.length;++_)for(l=l<<8|n[_],f+=8;f>t;)f-=t,u+=e[o&l>>f];if(f&&(u+=e[o&l<<t-f]),s)for(;u.length*t&7;)u+="=";return u},Xt=({name:n,prefix:e,bitsPerChar:t,alphabet:s})=>Zs({prefix:e,name:n,encode(o){return Jw(o,s,t)},decode(o){return Yw(o,s,t,n)}}),Xw=Zs({prefix:"\0",name:"identity",encode:n=>Kw(n),decode:n=>zw(n)});var Zw=Object.freeze({__proto__:null,identity:Xw});const Qw=Xt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var em=Object.freeze({__proto__:null,base2:Qw});const tm=Xt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var rm=Object.freeze({__proto__:null,base8:tm});const nm=is({prefix:"9",name:"base10",alphabet:"0123456789"});var im=Object.freeze({__proto__:null,base10:nm});const sm=Xt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),om=Xt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var am=Object.freeze({__proto__:null,base16:sm,base16upper:om});const um=Xt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cm=Xt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),fm=Xt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hm=Xt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),lm=Xt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),dm=Xt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pm=Xt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gm=Xt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_m=Xt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ym=Object.freeze({__proto__:null,base32:um,base32upper:cm,base32pad:fm,base32padupper:hm,base32hex:lm,base32hexupper:dm,base32hexpad:pm,base32hexpadupper:gm,base32z:_m});const vm=is({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bm=is({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var wm=Object.freeze({__proto__:null,base36:vm,base36upper:bm});const mm=is({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Em=is({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Sm=Object.freeze({__proto__:null,base58btc:mm,base58flickr:Em});const Dm=Xt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),xm=Xt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Om=Xt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Im=Xt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Am=Object.freeze({__proto__:null,base64:Dm,base64pad:xm,base64url:Om,base64urlpad:Im});const Il=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Pm=Il.reduce((n,e,t)=>(n[t]=e,n),[]),Tm=Il.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function Cm(n){return n.reduce((e,t)=>(e+=Pm[t],e),"")}function Rm(n){const e=[];for(const t of n){const s=Tm[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const Nm=Zs({prefix:"\u{1F680}",name:"base256emoji",encode:Cm,decode:Rm});var Lm=Object.freeze({__proto__:null,base256emoji:Nm}),Fm=Pl,Al=128,$m=127,Um=~$m,Mm=Math.pow(2,31);function Pl(n,e,t){e=e||[],t=t||0;for(var s=t;n>=Mm;)e[t++]=n&255|Al,n/=128;for(;n&Um;)e[t++]=n&255|Al,n>>>=7;return e[t]=n|0,Pl.bytes=t-s+1,e}var Bm=pu,qm=128,Tl=127;function pu(n,s){var t=0,s=s||0,o=0,u=s,f,l=n.length;do{if(u>=l)throw pu.bytes=0,new RangeError("Could not decode varint");f=n[u++],t+=o<28?(f&Tl)<<o:(f&Tl)*Math.pow(2,o),o+=7}while(f>=qm);return pu.bytes=u-s,t}var Hm=Math.pow(2,7),jm=Math.pow(2,14),zm=Math.pow(2,21),Km=Math.pow(2,28),Gm=Math.pow(2,35),Wm=Math.pow(2,42),Vm=Math.pow(2,49),km=Math.pow(2,56),Ym=Math.pow(2,63),Jm=function(n){return n<Hm?1:n<jm?2:n<zm?3:n<Km?4:n<Gm?5:n<Wm?6:n<Vm?7:n<km?8:n<Ym?9:10},Xm={encode:Fm,decode:Bm,encodingLength:Jm},Cl=Xm;const Rl=(n,e,t=0)=>(Cl.encode(n,e,t),e),Nl=n=>Cl.encodingLength(n),gu=(n,e)=>{const t=e.byteLength,s=Nl(n),o=s+Nl(t),u=new Uint8Array(o+t);return Rl(n,u,0),Rl(t,u,s),u.set(e,o),new Zm(n,t,e,u)};class Zm{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Ll=({name:n,code:e,encode:t})=>new Qm(n,e,t);class Qm{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?gu(this.code,t):t.then(s=>gu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Fl=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),eE=Ll({name:"sha2-256",code:18,encode:Fl("SHA-256")}),tE=Ll({name:"sha2-512",code:19,encode:Fl("SHA-512")});var rE=Object.freeze({__proto__:null,sha256:eE,sha512:tE});const $l=0,nE="identity",Ul=xl;var iE=Object.freeze({__proto__:null,identity:{code:$l,name:nE,encode:Ul,digest:n=>gu($l,Ul(n))}});new TextEncoder,new TextDecoder;const Ml=ar(ar(ar(ar(ar(ar(ar(ar(ar(ar({},Zw),em),rm),im),am),ym),wm),Sm),Am),Lm);ar(ar({},rE),iE);function Bl(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function sE(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Bl(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function ql(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const Hl=ql("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),_u=ql("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=sE(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),oE=ar({utf8:Hl,"utf-8":Hl,hex:Ml.base16,latin1:_u,ascii:_u,binary:_u},Ml);function aE(n,e="utf8"){const t=oE[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Bl(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}const jl="wc",uE=2,yu="core",Dn=`${jl}@2:${yu}:`,cE={name:yu,logger:"error"},fE={database:":memory:"},hE="crypto",zl="client_ed25519_seed",lE=_e.ONE_DAY,dE="keychain",pE="0.3",gE="messages",_E="0.3",yE=_e.SIX_HOURS,vE="publisher",Kl="irn",bE="error",Gl="wss://relay.walletconnect.com",Wl="wss://relay.walletconnect.org",wE="relayer",St={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},mE="_subscription",ss={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},EE=_e.ONE_SECOND/2,SE="2.9.2",DE=1e4,xE="0.3",OE="WALLETCONNECT_CLIENT_ID",Jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},IE="subscription",AE="0.3",PE=_e.FIVE_SECONDS*1e3,TE="pairing",CE="0.3",os={wc_pairingDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:0},res:{ttl:_e.ONE_DAY,prompt:!1,tag:0}}},Xr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},RE="history",NE="0.3",LE="expirer",Pr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},FE="0.3",vu="verify-api",Vl="https://verify.walletconnect.com";class $E{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=dE,this.version=pE,this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:u}=fe("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Jh(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Xh(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class UE{constructor(e,t,s){this.core=e,this.logger=t,this.name=hE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),u=mh(o);return wh(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Hv();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const u=await this.getClientSeed(),f=mh(u),l=Za();return await Y1(l,o,lE,f)},this.generateSharedKey=(o,u,f)=>{this.isInitialized();const l=this.getPrivateKey(o),_=jv(l,u);return this.setSymKey(_,f)},this.setSymKey=async(o,u)=>{this.isInitialized();const f=u||zv(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,u,f)=>{this.isInitialized();const l=Kh(f),_=Xi(u);if(Gh(l)){const D=l.senderPublicKey,C=l.receiverPublicKey;o=await this.generateSharedKey(D,C)}const p=this.getSymKey(o),{type:E,senderPublicKey:T}=l;return Gv({type:E,symKey:p,message:_,senderPublicKey:T})},this.decode=async(o,u,f)=>{this.isInitialized();const l=kv(u,f);if(Gh(l)){const _=l.receiverPublicKey,p=l.senderPublicKey;o=await this.generateSharedKey(_,p)}try{const _=this.getSymKey(o),p=Wv({symKey:_,encoded:u});return Ta(p)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const u=zs(o);return ts(u.type)},this.getPayloadSenderPublicKey=o=>{const u=zs(o);return u.senderPublicKey?ir(u.senderPublicKey,sr):void 0},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.keychain=s||new $E(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(zl)}catch{e=Za(),await this.keychain.set(zl,e)}return aE(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ME extends P_{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=gE,this.version=_E,this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const u=gi(o);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[u]<"u"||(f[u]=o,this.messages.set(s,f),await this.persist()),u},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const u=this.get(s),f=gi(o);return typeof u[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=t}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Jh(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Xh(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class BE extends T_{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Qt.exports.EventEmitter,this.name=vE,this.queue=new Map,this.publishTimeout=_e.toMiliseconds(_e.TEN_SECONDS),this.queueTimeout=_e.toMiliseconds(_e.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,u)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:u}});try{const f=u?.ttl||yE,l=nu(u),_=u?.prompt||!1,p=u?.tag||0,E=u?.id||fu().toString(),T={topic:s,message:o,opts:{ttl:f,relay:l,prompt:_,tag:p,id:E}},D=setTimeout(()=>this.queue.set(E,T),this.queueTimeout);try{await await Ks(this.rpcPublish(s,o,f,l,_,p,E),this.publishTimeout),clearTimeout(D),this.relayer.events.emit(St.publish,T)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:u}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,u,f,l){var _,p,E,T;const D={method:Gs(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:u,tag:f},id:l};return or((_=D.params)==null?void 0:_.prompt)&&((p=D.params)==null||delete p.prompt),or((E=D.params)==null?void 0:E.tag)&&((T=D.params)==null||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.request(D)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(hi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(St.connection_stalled);return}this.checkQueue()}),this.relayer.on(St.message_ack,e=>{this.onPublish(e.id.toString())})}}class qE{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(u=>u!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var HE=Object.defineProperty,jE=Object.defineProperties,zE=Object.getOwnPropertyDescriptors,kl=Object.getOwnPropertySymbols,KE=Object.prototype.hasOwnProperty,GE=Object.prototype.propertyIsEnumerable,Yl=(n,e,t)=>e in n?HE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,as=(n,e)=>{for(var t in e||(e={}))KE.call(e,t)&&Yl(n,t,e[t]);if(kl)for(var t of kl(e))GE.call(e,t)&&Yl(n,t,e[t]);return n},bu=(n,e)=>jE(n,zE(e));class WE extends N_{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new qE,this.events=new Qt.exports.EventEmitter,this.name=IE,this.version=AE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Dn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const u=nu(o),f={topic:s,relay:u};this.pending.set(s,f);const l=await this.rpcSubscribe(s,u);return this.onSubscribe(l,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),l}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,u)=>{const f=new _e.Watch;f.start(this.pendingSubscriptionWatchLabel);const l=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(l),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=PE&&(clearInterval(l),f.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=nu(s);await this.rpcUnsubscribe(e,t,o);const u=Ut("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Gs(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ks(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(St.connection_stalled)}return gi(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Gs(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ks(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(St.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Gs(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,bu(as({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,as({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,as({},t)),this.topicMap.set(t.topic,e),this.events.emit(Jr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Jr.deleted,bu(as({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Jr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Jr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Vn(t)&&this.onBatchSubscribe(t.map((s,o)=>bu(as({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(hi.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(St.connect,async()=>{await this.onConnect()}),this.relayer.on(St.disconnect,()=>{this.onDisconnect()}),this.events.on(Jr.created,async e=>{const t=Jr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Jr.deleted,async e=>{const t=Jr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var VE=Object.defineProperty,Jl=Object.getOwnPropertySymbols,kE=Object.prototype.hasOwnProperty,YE=Object.prototype.propertyIsEnumerable,Xl=(n,e,t)=>e in n?VE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,JE=(n,e)=>{for(var t in e||(e={}))kE.call(e,t)&&Xl(n,t,e[t]);if(Jl)for(var t of Jl(e))YE.call(e,t)&&Xl(n,t,e[t]);return n};class XE extends C_{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Qt.exports.EventEmitter,this.name=wE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||bE})),this.messages=new ME(this.logger,e.core),this.subscriber=new WE(this,this.logger),this.publisher=new BE(this,this.logger),this.relayUrl=e?.relayUrl||Gl,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Wl}...`),await this.restartTransport(Wl)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},DE)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(u=>{this.subscriber.once(Jr.created,f=>{f.topic===e&&u()})}),new Promise(async u=>{o=await this.subscriber.subscribe(e,t),u()})]),o)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(St.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(Jr.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,s)=>{await Ks(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>s(o)).then(()=>t()).finally(()=>this.removeListener(St.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(St.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.events.emit(St.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(ss.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Sn(new Fw(sb({sdkVersion:SE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),lu(e)){if(!e.method.endsWith(mE))return;const t=e.params,{topic:s,message:o,publishedAt:u}=t.data,f={topic:s,message:o,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(JE({type:"event",event:t.id},f)),this.events.emit(t.id,f),await this.acknowledgePayload(e),await this.onMessageEvent(f)}else Xs(e)&&this.events.emit(St.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(St.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=hu(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(ss.payload,e=>this.onProviderPayload(e)),this.provider.on(ss.connect,()=>{this.events.emit(St.connect)}),this.provider.on(ss.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(ss.error,e=>{this.logger.error(e),this.events.emit(St.error,e)})}registerEventListeners(){this.events.on(St.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(St.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},_e.toMiliseconds(EE))}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var ZE=Object.defineProperty,Zl=Object.getOwnPropertySymbols,QE=Object.prototype.hasOwnProperty,e3=Object.prototype.propertyIsEnumerable,Ql=(n,e,t)=>e in n?ZE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ed=(n,e)=>{for(var t in e||(e={}))QE.call(e,t)&&Ql(n,t,e[t]);if(Zl)for(var t of Zl(e))e3.call(e,t)&&Ql(n,t,e[t]);return n};class Qs extends R_{constructor(e,t,s,o=Dn,u=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=xE,this.cached=[],this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!or(f)?this.map.set(this.getKey(f),f):Ab(f)?this.map.set(f.id,f):Pb(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,l)=>{this.isInitialized(),this.map.has(f)?await this.update(f,l):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:l}),this.map.set(f,l),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(l=>Object.keys(f).every(_=>$w(l[_],f[_]))):this.values),this.update=async(f,l)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:l});const _=ed(ed({},this.getData(f)),l);this.map.set(f,_),await this.persist()},this.delete=async(f,l)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:l}),this.map.delete(f),await this.persist())},this.logger=Je.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=u}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class t3{constructor(e,t){this.core=e,this.logger=t,this.name=TE,this.version=CE,this.events=new Qt.exports,this.initialized=!1,this.storagePrefix=Dn,this.ignoredPayloadTypes=[Gn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Za(),o=await this.core.crypto.setSymKey(s),u=Hr(_e.FIVE_MINUTES),f={protocol:Kl},l={topic:o,expiry:u,relay:f,active:!1},_=vb({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:f});return await this.pairings.set(o,l),await this.core.relayer.subscribe(o),this.core.expirer.set(o,u),{topic:o,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:u,relay:f}=gb(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const l=Hr(_e.FIVE_MINUTES),_={topic:o,relay:f,expiry:l,active:!1};return await this.pairings.set(o,_),await this.core.crypto.setSymKey(u,o),await this.core.relayer.subscribe(o,{relay:f}),this.core.expirer.set(o,l),s.activatePairing&&await this.activate({topic:o}),_},this.activate=async({topic:s})=>{this.isInitialized();const o=Hr(_e.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const u=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:l,reject:_}=_i();this.events.once($t("pairing_ping",u),({error:p})=>{p?_(p):l()}),await f()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Ut("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,u)=>{const f=Ys(o,u),l=await this.core.crypto.encode(s,f),_=os[o].req;return this.core.history.set(s,f),this.core.relayer.publish(s,l,_),f.id},this.sendResult=async(s,o,u)=>{const f=hu(s,u),l=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,s),p=os[_.request.method].res;await this.core.relayer.publish(o,l,p),await this.core.history.resolve(f)},this.sendError=async(s,o,u)=>{const f=Js(s,u),l=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,s),p=os[_.request.method]?os[_.request.method].res:os.unregistered_method.res;await this.core.relayer.publish(o,l,p),await this.core.history.resolve(f)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Ut("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>En(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(o,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,u);default:return this.onUnknownRpcMethodRequest(o,u)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:u}=s,f=(await this.core.history.get(o,u.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,u);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,o)=>{const{id:u}=o;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit("pairing_ping",{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,o)=>{const{id:u}=o;setTimeout(()=>{an(o)?this.events.emit($t("pairing_ping",u),{}):jr(o)&&this.events.emit($t("pairing_ping",u),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:u}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:u,method:f}=o;try{if(this.registeredMethods.includes(f))return;const l=Ut("WC_METHOD_UNSUPPORTED",f);await this.sendError(u,s,l),this.logger.error(l)}catch(l){await this.sendError(u,s,l),this.logger.error(l)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Ut("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!gr(s)){const{message:o}=fe("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!Ib(s.uri)){const{message:o}=fe("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!gr(s)){const{message:u}=fe("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:u}=fe("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Vt(s,!1)){const{message:o}=fe("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=fe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(En(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=fe("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.pairings=new Qs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(St.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{lu(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Xs(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Pr.expired,async e=>{const{topic:t}=Qh(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class r3 extends A_{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Qt.exports.EventEmitter,this.name=RE,this.version=NE,this.cached=[],this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:u}),this.records.has(o.id))return;const f={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:u,expiry:Hr(_e.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Xr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=jr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Xr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(u=>{if(u.topic===s){if(typeof o<"u"&&u.id!==o)return;this.records.delete(u.id),this.events.emit(Xr.deleted,u)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Ys(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Xr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Xr.created,e=>{const t=Xr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Xr.updated,e=>{const t=Xr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Xr.deleted,e=>{const t=Xr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(hi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{_e.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class n3 extends L_{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Qt.exports.EventEmitter,this.name=LE,this.version=FE,this.cached=[],this.initialized=!1,this.storagePrefix=Dn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const u=this.formatTarget(s),f={target:u,expiry:o};this.expirations.set(u,f),this.checkExpiry(u,f),this.events.emit(Pr.created,{target:u,expiration:f})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),u=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Pr.deleted,{target:o,expiration:u})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return ob(e);if(typeof e=="number")return ab(e);const{message:t}=fe("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Pr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;_e.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Pr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(hi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Pr.created,e=>{const t=Pr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Pr.expired,e=>{const t=Pr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Pr.deleted,e=>{const t=Pr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class i3 extends F_{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=vu,this.initialized=!1,this.init=async s=>{Yh()||!eu()||(this.verifyUrl=s?.verifyUrl||Vl,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const u=this.startAbortTimer(_e.FIVE_SECONDS),f=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?(o=await f.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(vu))return s();const u=document.createElement("iframe");u.setAttribute("id",vu),u.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),u.style.display="none",u.addEventListener("load",()=>{this.initialized=!0,s()}),u.addEventListener("error",f=>{o(f)}),document.body.append(u),this.iframe=u}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),_e.toMiliseconds(_e.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Je.generateChildLogger(t,this.name),this.verifyUrl=Vl,this.abortController=new AbortController,this.isDevEnv=Qa()&&process.env.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),_e.toMiliseconds(e))}}var s3=Object.defineProperty,td=Object.getOwnPropertySymbols,o3=Object.prototype.hasOwnProperty,a3=Object.prototype.propertyIsEnumerable,rd=(n,e,t)=>e in n?s3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,nd=(n,e)=>{for(var t in e||(e={}))o3.call(e,t)&&rd(n,t,e[t]);if(td)for(var t of td(e))a3.call(e,t)&&rd(n,t,e[t]);return n};class wu extends I_{constructor(e){super(e),this.protocol=jl,this.version=uE,this.name=yu,this.events=new Qt.exports.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Gl;const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:e?.logger||cE.logger}));this.logger=Je.generateChildLogger(t,this.name),this.heartbeat=new hi.HeartBeat,this.crypto=new UE(this,this.logger,e?.keychain),this.history=new r3(this,this.logger),this.expirer=new n3(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new n0(nd(nd({},fE),e?.storageOptions)),this.relayer=new XE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new t3(this,this.logger),this.verify=new i3(this.projectId||"",this.logger)}static async init(e){const t=new wu(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(OE,s),t}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const u3=wu,id="wc",sd=2,od="client",mu=`${id}@${sd}:${od}:`,Eu={name:od,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},ad="WALLETCONNECT_DEEPLINK_CHOICE",c3="proposal",ud="Proposal expired",f3="session",eo=_e.SEVEN_DAYS,h3="engine",us={wc_sessionPropose:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1104},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1106},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1112},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1115}}},Su={min:_e.FIVE_MINUTES,max:_e.SEVEN_DAYS},cs={idle:"idle",active:"active"},l3="request",d3=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var p3=Object.defineProperty,g3=Object.defineProperties,_3=Object.getOwnPropertyDescriptors,cd=Object.getOwnPropertySymbols,y3=Object.prototype.hasOwnProperty,v3=Object.prototype.propertyIsEnumerable,fd=(n,e,t)=>e in n?p3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Tr=(n,e)=>{for(var t in e||(e={}))y3.call(e,t)&&fd(n,t,e[t]);if(cd)for(var t of cd(e))v3.call(e,t)&&fd(n,t,e[t]);return n},Du=(n,e)=>g3(n,_3(e));class b3 extends U_{constructor(e){super(e),this.name=h3,this.events=new Qt.exports,this.initialized=!1,this.ignoredPayloadTypes=[Gn],this.requestQueue={state:cs.idle,requests:[]},this.requestQueueDelay=_e.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(us)}),this.initialized=!0,setTimeout(()=>{this.requestQueue.requests=this.getPendingSessionRequests(),this.processRequestQueue()},_e.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{this.isInitialized();const s=Du(Tr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:u,optionalNamespaces:f,sessionProperties:l,relays:_}=s;let p=o,E,T=!1;if(p&&(T=this.client.core.pairing.pairings.get(p).active),!p||!T){const{topic:M,uri:x}=await this.client.core.pairing.create();p=M,E=x}const D=await this.client.core.crypto.generateKeyPair(),C=Tr({requiredNamespaces:u,optionalNamespaces:f,relays:_??[{protocol:Kl}],proposer:{publicKey:D,metadata:this.client.metadata}},l&&{sessionProperties:l}),{reject:R,resolve:j,done:K}=_i(_e.FIVE_MINUTES,ud);if(this.events.once($t("session_connect"),async({error:M,session:x})=>{if(M)R(M);else if(x){x.self.publicKey=D;const P=Du(Tr({},x),{requiredNamespaces:x.requiredNamespaces,optionalNamespaces:x.optionalNamespaces});await this.client.session.set(x.topic,P),await this.setExpiry(x.topic,x.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:x.peer.metadata}),j(P)}}),!p){const{message:M}=fe("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(M)}const se=await this.sendRequest(p,"wc_sessionPropose",C),L=Hr(_e.FIVE_MINUTES);return await this.setProposal(se,Tr({id:se,expiry:L},C)),{uri:E,approval:K}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:u,sessionProperties:f}=t,l=this.client.proposal.get(s);let{pairingTopic:_,proposer:p,requiredNamespaces:E,optionalNamespaces:T}=l;_=_||"",vi(E)||(E=Eb(u,"approve()"));const D=await this.client.core.crypto.generateKeyPair(),C=p.publicKey,R=await this.client.core.crypto.generateSharedKey(D,C);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:p.metadata}),await this.sendResult(s,_,{relay:{protocol:o??"irn"},responderPublicKey:D}),await this.client.proposal.delete(s,Ut("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const j=Tr({relay:{protocol:o??"irn"},namespaces:u,requiredNamespaces:E,optionalNamespaces:T,pairingTopic:_,controller:{publicKey:D,metadata:this.client.metadata},expiry:Hr(eo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(R),await this.sendRequest(R,"wc_sessionSettle",j);const K=Du(Tr({},j),{topic:R,pairingTopic:_,acknowledged:!1,self:j.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:D});return await this.client.session.set(R,K),await this.setExpiry(R,Hr(eo)),{topic:R,acknowledged:()=>new Promise(se=>setTimeout(()=>se(this.client.session.get(R)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:u}=this.client.proposal.get(s);u&&(await this.sendError(s,u,o),await this.client.proposal.delete(s,Ut("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,u=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:f,resolve:l,reject:_}=_i();return this.events.once($t("session_update",u),({error:p})=>{p?_(p):l()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:f}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:u,resolve:f,reject:l}=_i();return this.events.once($t("session_extend",o),({error:_})=>{_?l(_):f()}),await this.setExpiry(s,Hr(eo)),{acknowledged:u}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:u,expiry:f}=t,l=await this.sendRequest(u,"wc_sessionRequest",{request:o,chainId:s},f),{done:_,resolve:p,reject:E}=_i(f);this.events.once($t("session_request",l),({error:D,result:C})=>{D?E(D):p(C)}),this.client.events.emit("session_request_sent",{topic:u,request:o,chainId:s,id:l});const T=await this.client.core.storage.getItem(ad);return ub({id:l,topic:u,wcDeepLink:T}),await _()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:u}=o;an(o)?await this.sendResult(u,s,o.result):jr(o)&&await this.sendError(u,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:u,resolve:f,reject:l}=_i();this.events.once($t("session_ping",o),({error:_})=>{_?l(_):f()}),await u()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:u}=t;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:u})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=fu().toString();let u;const f=l=>{l?.id.toString()===o&&(this.client.core.relayer.events.removeListener(St.message_ack,f),u())};await Promise.all([new Promise(l=>{u=l,this.client.core.relayer.on(St.message_ack,f)}),this.sendRequest(s,"wc_sessionDelete",Ut("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>xb(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(u=>{var f,l;return((f=u.peerMetadata)==null?void 0:f.url)&&((l=u.peerMetadata)==null?void 0:l.url)===t.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,Ut("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t),this.client.core.storage.removeItem(ad).catch(u=>this.client.logger.warn(u))},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,Ut("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.requestQueue.requests=this.requestQueue.requests.filter(u=>u.id!==t),o&&(this.requestQueue.state=cs.idle)},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=us.wc_sessionRequest.req.ttl,{id:o,topic:u,params:f}=t;await this.client.pendingRequest.set(o,{id:o,topic:u,params:f}),s&&this.client.core.expirer.set(o,Hr(s))},this.sendRequest=async(t,s,o,u,f)=>{const l=Ys(s,o);if(eu()&&d3.includes(s)){const E=gi(JSON.stringify(l));await this.client.core.verify.register({attestationId:E})}const _=await this.client.core.crypto.encode(t,l),p=us[s].req;return u&&(p.ttl=u),f&&(p.id=f),this.client.core.history.set(t,l),this.client.core.relayer.publish(t,_,p),l.id},this.sendResult=async(t,s,o)=>{const u=hu(t,o),f=await this.client.core.crypto.encode(s,u),l=await this.client.core.history.get(s,t),_=us[l.request.method].res;this.client.core.relayer.publish(s,f,_),await this.client.core.history.resolve(u)},this.sendError=async(t,s,o)=>{const u=Js(t,o),f=await this.client.core.crypto.encode(s,u),l=await this.client.core.history.get(s,t),_=us[l.request.method].res;this.client.core.relayer.publish(s,f,_),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{En(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{En(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=t=>{const{topic:s,payload:o}=t,u=o.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,u=(await this.client.core.history.get(s,o.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=fe("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:u}=s;try{this.isValidConnect(Tr({},s.params));const f=Hr(_e.FIVE_MINUTES),l=Tr({id:u,pairingTopic:t,expiry:f},o);await this.setProposal(u,l);const _=gi(JSON.stringify(s)),p=await this.getVerifyContext(_,l.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:l,verifyContext:p})}catch(f){await this.sendError(u,t,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(an(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const l=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l});const _=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const p=await this.client.core.crypto.generateSharedKey(l,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const E=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:t})}else jr(s)&&(await this.client.proposal.delete(o,Ut("USER_DISCONNECTED")),this.events.emit($t("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:f,controller:l,expiry:_,namespaces:p,requiredNamespaces:E,optionalNamespaces:T,sessionProperties:D,pairingTopic:C}=s.params,R=Tr({topic:t,relay:f,expiry:_,namespaces:p,acknowledged:!0,pairingTopic:C,requiredNamespaces:E,optionalNamespaces:T,controller:l.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:l.publicKey,metadata:l.metadata}},D&&{sessionProperties:D});await this.sendResult(s.id,t,!0),this.events.emit($t("session_connect"),{session:R}),this.cleanupDuplicatePairings(R)}catch(f){await this.sendError(o,t,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;an(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit($t("session_approve",o),{})):jr(s)&&(await this.client.session.delete(t,Ut("USER_DISCONNECTED")),this.events.emit($t("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:u}=s;try{this.isValidUpdate(Tr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult(u,t,!0),this.client.events.emit("session_update",{id:u,topic:t,params:o})}catch(f){await this.sendError(u,t,f),this.client.logger.error(f)}},this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;an(s)?this.events.emit($t("session_update",o),{}):jr(s)&&this.events.emit($t("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Hr(eo)),await this.sendResult(o,t,!0),this.client.events.emit("session_extend",{id:o,topic:t})}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;an(s)?this.events.emit($t("session_extend",o),{}):jr(s)&&this.events.emit($t("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult(o,t,!0),this.client.events.emit("session_ping",{id:o,topic:t})}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{an(s)?this.events.emit($t("session_ping",o),{}):jr(s)&&this.events.emit($t("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(St.publish,async()=>{u(await this.deleteSession(t))})}),this.sendResult(o,t,!0)]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:u}=s;try{this.isValidRequest(Tr({topic:t},u)),await this.setPendingSessionRequest({id:o,topic:t,params:u}),this.addRequestToQueue({id:o,topic:t,params:u}),await this.processRequestQueue()}catch(f){await this.sendError(o,t,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;an(s)?this.events.emit($t("session_request",o),{result:s.result}):jr(s)&&this.events.emit($t("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:u}=s;try{this.isValidEmit(Tr({topic:t},u)),this.client.events.emit("session_event",{id:o,topic:t,params:u})}catch(f){await this.sendError(o,t,f),this.client.logger.error(f)}},this.addRequestToQueue=t=>{this.requestQueue.requests.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.requestQueue.state=cs.idle,this.processRequestQueue()},_e.toMiliseconds(this.requestQueueDelay))},this.processRequestQueue=async()=>{if(this.requestQueue.state===cs.active){this.client.logger.info("session request queue is already active.");return}const t=this.requestQueue.requests[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{const{id:s,topic:o,params:u}=t,f=gi(JSON.stringify({id:s,params:u})),l=this.client.session.get(o),_=await this.getVerifyContext(f,l.peer.metadata);this.requestQueue.state=cs.active,this.client.events.emit("session_request",{id:s,topic:o,params:u,verifyContext:_})}catch(s){this.client.logger.error(s)}},this.isValidConnect=async t=>{if(!gr(t)){const{message:_}=fe("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:u,sessionProperties:f,relays:l}=t;if(or(s)||await this.isValidPairingTopic(s),!Ub(l,!0)){const{message:_}=fe("MISSING_OR_INVALID",`connect() relays: ${l}`);throw new Error(_)}!or(o)&&vi(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(u)&&vi(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),or(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=$b(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!gr(t))throw new Error(fe("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:u,sessionProperties:f}=t;await this.isValidProposalId(s);const l=this.client.proposal.get(s),_=ks(o,"approve()");if(_)throw new Error(_.message);const p=ol(l.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Vt(u,!0)){const{message:E}=fe("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(E)}or(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async t=>{if(!gr(t)){const{message:u}=fe("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(u)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!Bb(o)){const{message:u}=fe("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(u)}},this.isValidSessionSettleRequest=t=>{if(!gr(t)){const{message:p}=fe("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:u,expiry:f}=t;if(!il(s)){const{message:p}=fe("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const l=Tb(o,"onSessionSettleRequest()");if(l)throw new Error(l.message);const _=ks(u,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(En(f)){const{message:p}=fe("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!gr(t)){const{message:_}=fe("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(_)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const u=this.client.session.get(s),f=ks(o,"update()");if(f)throw new Error(f.message);const l=ol(u.requiredNamespaces,o,"update()");if(l)throw new Error(l.message)},this.isValidExtend=async t=>{if(!gr(t)){const{message:o}=fe("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!gr(t)){const{message:_}=fe("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(_)}const{topic:s,request:o,chainId:u,expiry:f}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!sl(l,u)){const{message:_}=fe("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(_)}if(!qb(o)){const{message:_}=fe("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!zb(l,u,o.method)){const{message:_}=fe("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(f&&!Vb(f,Su)){const{message:_}=fe("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${Su.min} and ${Su.max}`);throw new Error(_)}},this.isValidRespond=async t=>{if(!gr(t)){const{message:u}=fe("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(u)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!Hb(o)){const{message:u}=fe("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(u)}},this.isValidPing=async t=>{if(!gr(t)){const{message:o}=fe("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!gr(t)){const{message:l}=fe("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(l)}const{topic:s,event:o,chainId:u}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!sl(f,u)){const{message:l}=fe("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(l)}if(!jb(o)){const{message:l}=fe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}if(!Kb(f,u,o.name)){const{message:l}=fe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidDisconnect=async t=>{if(!gr(t)){const{message:o}=fe("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});u&&(o.verified.origin=u,o.verified.validation=u===s.url?"VALID":"INVALID")}catch(u){this.client.logger.error(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Vt(o,!1)){const{message:u}=fe("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(u)}})}}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(St.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{lu(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Xs(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Pr.expired,async e=>{const{topic:t,id:s}=Qh(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,fe("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Vt(e,!1)){const{message:t}=fe("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=fe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(En(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=fe("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Vt(e,!1)){const{message:t}=fe("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=fe("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(En(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=fe("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Vt(e,!1)){const{message:t}=fe("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=fe("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Mb(e)){const{message:t}=fe("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=fe("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(En(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=fe("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class w3 extends Qs{constructor(e,t){super(e,t,c3,mu),this.core=e,this.logger=t}}class m3 extends Qs{constructor(e,t){super(e,t,f3,mu),this.core=e,this.logger=t}}class E3 extends Qs{constructor(e,t){super(e,t,l3,mu,s=>s.id),this.core=e,this.logger=t}}class xu extends $_{constructor(e){super(e),this.protocol=id,this.version=sd,this.name=Eu.name,this.events=new Qt.exports.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=e?.name||Eu.name,this.metadata=e?.metadata||tb();const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:e?.logger||Eu.logger}));this.core=e?.core||new u3(e),this.logger=Je.generateChildLogger(t,this.name),this.session=new m3(this.core,this.logger),this.proposal=new w3(this.core,this.logger),this.pendingRequest=new E3(this.core,this.logger),this.engine=new b3(this)}static async init(e){const t=new xu(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const hd="error",S3="wss://relay.walletconnect.com",D3="wc",x3="universal_provider",ld=`${D3}@2:${x3}:`,O3="https://rpc.walletconnect.com/v1",xn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Ou={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){var t,s="4.17.21",o=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",l="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",p=500,E="__lodash_placeholder__",T=1,D=2,C=4,R=1,j=2,K=1,se=2,L=4,M=8,x=16,P=32,m=64,c=128,b=256,V=512,Y=30,ie="...",ue=800,de=16,w=1,I=2,ee=3,X=1/0,G=9007199254740991,W=17976931348623157e292,J=0/0,re=4294967295,we=re-1,oe=re>>>1,me=[["ary",c],["bind",K],["bindKey",se],["curry",M],["curryRight",x],["flip",V],["partial",P],["partialRight",m],["rearg",b]],he="[object Arguments]",ve="[object Array]",H="[object AsyncFunction]",q="[object Boolean]",F="[object Date]",d="[object DOMException]",A="[object Error]",ae="[object Function]",le="[object GeneratorFunction]",xe="[object Map]",je="[object Number]",Ge="[object Null]",Ue="[object Object]",gt="[object Promise]",_t="[object Proxy]",Be="[object RegExp]",Oe="[object Set]",Le="[object String]",Fe="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",$e="[object WeakSet]",De="[object ArrayBuffer]",Pe="[object DataView]",ze="[object Float32Array]",Ie="[object Float64Array]",We="[object Int8Array]",ke="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Xe="[object Uint8ClampedArray]",ur="[object Uint16Array]",_r="[object Uint32Array]",Zr=/\b__p \+= '';/g,cr=/\b(__p \+=) '' \+/g,un=/(__e\(.*?\)|\b__t\)) \+\n'';/g,On=/&(?:amp|lt|gt|quot|#39);/g,Yn=/[&<>"']/g,Dt=RegExp(On.source),yt=RegExp(Yn.source),xt=/<%-([\s\S]+?)%>/g,Ot=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mt=/^\w*$/,Bt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,qt=RegExp(It.source),At=/^\s+/,Rt=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ht=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Cu=/[()=,{}\[\]\/\s]/,Ru=/\\(\\)?/g,Nu=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Rr=/\w*$/,Lu=/^[-+]0x[0-9a-f]+$/i,Fu=/^0b[01]+$/i,$u=/^\[object .+?Constructor\]$/,Uu=/^0o[0-7]+$/i,Mu=/^(?:0|[1-9]\d*)$/,cn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bi=/($^)/,Bu=/['\n\r\u2028\u2029\\]/g,wi="\\ud800-\\udfff",qu="\\u0300-\\u036f",Hu="\\ufe20-\\ufe2f",mi="\\u20d0-\\u20ff",io=qu+Hu+mi,so="\\u2700-\\u27bf",zr="a-z\\xdf-\\xf6\\xf8-\\xff",ju="\\xac\\xb1\\xd7\\xf7",zu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ku="\\u2000-\\u206f",Gu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",oo="A-Z\\xc0-\\xd6\\xd8-\\xde",ao="\\ufe0e\\ufe0f",Jn=ju+zu+Ku+Gu,fs="['\u2019]",Xn="["+wi+"]",hs="["+Jn+"]",Zn="["+io+"]",uo="\\d+",Wu="["+so+"]",co="["+zr+"]",fo="[^"+wi+Jn+uo+so+zr+oo+"]",Ei="\\ud83c[\\udffb-\\udfff]",Vu="(?:"+Zn+"|"+Ei+")",ho="[^"+wi+"]",Si="(?:\\ud83c[\\udde6-\\uddff]){2}",In="[\\ud800-\\udbff][\\udc00-\\udfff]",Sr="["+oo+"]",lo="\\u200d",po="(?:"+co+"|"+fo+")",Qr="(?:"+Sr+"|"+fo+")",go="(?:"+fs+"(?:d|ll|m|re|s|t|ve))?",_o="(?:"+fs+"(?:D|LL|M|RE|S|T|VE))?",yo=Vu+"?",vo="["+ao+"]?",ku="(?:"+lo+"(?:"+[ho,Si,In].join("|")+")"+vo+yo+")*",fn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",bo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",wo=vo+yo+ku,Di="(?:"+[Wu,Si,In].join("|")+")"+wo,Yu="(?:"+[ho+Zn+"?",Zn,Si,In,Xn].join("|")+")",ls=RegExp(fs,"g"),Ju=RegExp(Zn,"g"),xi=RegExp(Ei+"(?="+Ei+")|"+Yu+wo,"g"),mo=RegExp([Sr+"?"+co+"+"+go+"(?="+[hs,Sr,"$"].join("|")+")",Qr+"+"+_o+"(?="+[hs,Sr+po,"$"].join("|")+")",Sr+"?"+po+"+"+go,Sr+"+"+_o,bo,fn,uo,Di].join("|"),"g"),Eo=RegExp("["+lo+wi+io+ao+"]"),Qn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,So=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xu=-1,at={};at[ze]=at[Ie]=at[We]=at[ke]=at[et]=at[tt]=at[Xe]=at[ur]=at[_r]=!0,at[he]=at[ve]=at[De]=at[q]=at[Pe]=at[F]=at[A]=at[ae]=at[xe]=at[je]=at[Ue]=at[Be]=at[Oe]=at[Le]=at[Ae]=!1;var ot={};ot[he]=ot[ve]=ot[De]=ot[Pe]=ot[q]=ot[F]=ot[ze]=ot[Ie]=ot[We]=ot[ke]=ot[et]=ot[xe]=ot[je]=ot[Ue]=ot[Be]=ot[Oe]=ot[Le]=ot[Fe]=ot[tt]=ot[Xe]=ot[ur]=ot[_r]=!0,ot[A]=ot[ae]=ot[Ae]=!1;var S={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ut=parseFloat,Ce=parseInt,dt=typeof wt=="object"&&wt&&wt.Object===Object&&wt,zt=typeof self=="object"&&self&&self.Object===Object&&self,Ze=dt||zt||Function("return this")(),ct=e&&!e.nodeType&&e,Nt=ct&&!0&&n&&!n.nodeType&&n,yr=Nt&&Nt.exports===ct,Kt=yr&&dt.process,pt=function(){try{var $=Nt&&Nt.require&&Nt.require("util").types;return $||Kt&&Kt.binding&&Kt.binding("util")}catch{}}(),fr=pt&&pt.isArrayBuffer,Kr=pt&&pt.isDate,Nr=pt&&pt.isMap,en=pt&&pt.isRegExp,ds=pt&&pt.isSet,ei=pt&&pt.isTypedArray;function kt($,k,z){switch(z.length){case 0:return $.call(k);case 1:return $.call(k,z[0]);case 2:return $.call(k,z[0],z[1]);case 3:return $.call(k,z[0],z[1],z[2])}return $.apply(k,z)}function J3($,k,z,ge){for(var Te=-1,rt=$==null?0:$.length;++Te<rt;){var Gt=$[Te];k(ge,Gt,z(Gt),$)}return ge}function Lr($,k){for(var z=-1,ge=$==null?0:$.length;++z<ge&&k($[z],z,$)!==!1;);return $}function X3($,k){for(var z=$==null?0:$.length;z--&&k($[z],z,$)!==!1;);return $}function Sd($,k){for(var z=-1,ge=$==null?0:$.length;++z<ge;)if(!k($[z],z,$))return!1;return!0}function An($,k){for(var z=-1,ge=$==null?0:$.length,Te=0,rt=[];++z<ge;){var Gt=$[z];k(Gt,z,$)&&(rt[Te++]=Gt)}return rt}function Do($,k){var z=$==null?0:$.length;return!!z&&Oi($,k,0)>-1}function Zu($,k,z){for(var ge=-1,Te=$==null?0:$.length;++ge<Te;)if(z(k,$[ge]))return!0;return!1}function bt($,k){for(var z=-1,ge=$==null?0:$.length,Te=Array(ge);++z<ge;)Te[z]=k($[z],z,$);return Te}function Pn($,k){for(var z=-1,ge=k.length,Te=$.length;++z<ge;)$[Te+z]=k[z];return $}function Qu($,k,z,ge){var Te=-1,rt=$==null?0:$.length;for(ge&&rt&&(z=$[++Te]);++Te<rt;)z=k(z,$[Te],Te,$);return z}function Z3($,k,z,ge){var Te=$==null?0:$.length;for(ge&&Te&&(z=$[--Te]);Te--;)z=k(z,$[Te],Te,$);return z}function ec($,k){for(var z=-1,ge=$==null?0:$.length;++z<ge;)if(k($[z],z,$))return!0;return!1}var Q3=tc("length");function e2($){return $.split("")}function t2($){return $.match(jt)||[]}function Dd($,k,z){var ge;return z($,function(Te,rt,Gt){if(k(Te,rt,Gt))return ge=rt,!1}),ge}function xo($,k,z,ge){for(var Te=$.length,rt=z+(ge?1:-1);ge?rt--:++rt<Te;)if(k($[rt],rt,$))return rt;return-1}function Oi($,k,z){return k===k?d2($,k,z):xo($,xd,z)}function r2($,k,z,ge){for(var Te=z-1,rt=$.length;++Te<rt;)if(ge($[Te],k))return Te;return-1}function xd($){return $!==$}function Od($,k){var z=$==null?0:$.length;return z?nc($,k)/z:J}function tc($){return function(k){return k==null?t:k[$]}}function rc($){return function(k){return $==null?t:$[k]}}function Id($,k,z,ge,Te){return Te($,function(rt,Gt,ft){z=ge?(ge=!1,rt):k(z,rt,Gt,ft)}),z}function n2($,k){var z=$.length;for($.sort(k);z--;)$[z]=$[z].value;return $}function nc($,k){for(var z,ge=-1,Te=$.length;++ge<Te;){var rt=k($[ge]);rt!==t&&(z=z===t?rt:z+rt)}return z}function ic($,k){for(var z=-1,ge=Array($);++z<$;)ge[z]=k(z);return ge}function i2($,k){return bt(k,function(z){return[z,$[z]]})}function Ad($){return $&&$.slice(0,Rd($)+1).replace(At,"")}function Dr($){return function(k){return $(k)}}function sc($,k){return bt(k,function(z){return $[z]})}function ps($,k){return $.has(k)}function Pd($,k){for(var z=-1,ge=$.length;++z<ge&&Oi(k,$[z],0)>-1;);return z}function Td($,k){for(var z=$.length;z--&&Oi(k,$[z],0)>-1;);return z}function s2($,k){for(var z=$.length,ge=0;z--;)$[z]===k&&++ge;return ge}var o2=rc(S),a2=rc(U);function u2($){return"\\"+pe[$]}function c2($,k){return $==null?t:$[k]}function Ii($){return Eo.test($)}function f2($){return Qn.test($)}function h2($){for(var k,z=[];!(k=$.next()).done;)z.push(k.value);return z}function oc($){var k=-1,z=Array($.size);return $.forEach(function(ge,Te){z[++k]=[Te,ge]}),z}function Cd($,k){return function(z){return $(k(z))}}function Tn($,k){for(var z=-1,ge=$.length,Te=0,rt=[];++z<ge;){var Gt=$[z];(Gt===k||Gt===E)&&($[z]=E,rt[Te++]=z)}return rt}function Oo($){var k=-1,z=Array($.size);return $.forEach(function(ge){z[++k]=ge}),z}function l2($){var k=-1,z=Array($.size);return $.forEach(function(ge){z[++k]=[ge,ge]}),z}function d2($,k,z){for(var ge=z-1,Te=$.length;++ge<Te;)if($[ge]===k)return ge;return-1}function p2($,k,z){for(var ge=z+1;ge--;)if($[ge]===k)return ge;return ge}function Ai($){return Ii($)?_2($):Q3($)}function Gr($){return Ii($)?y2($):e2($)}function Rd($){for(var k=$.length;k--&&Rt.test($.charAt(k)););return k}var g2=rc(te);function _2($){for(var k=xi.lastIndex=0;xi.test($);)++k;return k}function y2($){return $.match(xi)||[]}function v2($){return $.match(mo)||[]}var b2=function $(k){k=k==null?Ze:Pi.defaults(Ze.Object(),k,Pi.pick(Ze,So));var z=k.Array,ge=k.Date,Te=k.Error,rt=k.Function,Gt=k.Math,ft=k.Object,ac=k.RegExp,w2=k.String,Fr=k.TypeError,Io=z.prototype,m2=rt.prototype,Ti=ft.prototype,Ao=k["__core-js_shared__"],Po=m2.toString,it=Ti.hasOwnProperty,E2=0,Nd=function(){var r=/[^.]+$/.exec(Ao&&Ao.keys&&Ao.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),To=Ti.toString,S2=Po.call(ft),D2=Ze._,x2=ac("^"+Po.call(it).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Co=yr?k.Buffer:t,Cn=k.Symbol,Ro=k.Uint8Array,Ld=Co?Co.allocUnsafe:t,No=Cd(ft.getPrototypeOf,ft),Fd=ft.create,$d=Ti.propertyIsEnumerable,Lo=Io.splice,Ud=Cn?Cn.isConcatSpreadable:t,gs=Cn?Cn.iterator:t,ti=Cn?Cn.toStringTag:t,Fo=function(){try{var r=oi(ft,"defineProperty");return r({},"",{}),r}catch{}}(),O2=k.clearTimeout!==Ze.clearTimeout&&k.clearTimeout,I2=ge&&ge.now!==Ze.Date.now&&ge.now,A2=k.setTimeout!==Ze.setTimeout&&k.setTimeout,$o=Gt.ceil,Uo=Gt.floor,uc=ft.getOwnPropertySymbols,P2=Co?Co.isBuffer:t,Md=k.isFinite,T2=Io.join,C2=Cd(ft.keys,ft),Wt=Gt.max,tr=Gt.min,R2=ge.now,N2=k.parseInt,Bd=Gt.random,L2=Io.reverse,cc=oi(k,"DataView"),_s=oi(k,"Map"),fc=oi(k,"Promise"),Ci=oi(k,"Set"),ys=oi(k,"WeakMap"),vs=oi(ft,"create"),Mo=ys&&new ys,Ri={},F2=ai(cc),$2=ai(_s),U2=ai(fc),M2=ai(Ci),B2=ai(ys),Bo=Cn?Cn.prototype:t,bs=Bo?Bo.valueOf:t,qd=Bo?Bo.toString:t;function y(r){if(Tt(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof $r)return r;if(it.call(r,"__wrapped__"))return Hp(r)}return new $r(r)}var Ni=function(){function r(){}return function(i){if(!Et(i))return{};if(Fd)return Fd(i);r.prototype=i;var a=new r;return r.prototype=t,a}}();function qo(){}function $r(r,i){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}y.templateSettings={escape:xt,evaluate:Ot,interpolate:mt,variable:"",imports:{_:y}},y.prototype=qo.prototype,y.prototype.constructor=y,$r.prototype=Ni(qo.prototype),$r.prototype.constructor=$r;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function q2(){var r=new Ye(this.__wrapped__);return r.__actions__=vr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=vr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=vr(this.__views__),r}function H2(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function j2(){var r=this.__wrapped__.value(),i=this.__dir__,a=Re(r),h=i<0,g=a?r.length:0,v=eS(0,g,this.__views__),O=v.start,N=v.end,B=N-O,Z=h?N:O-1,Q=this.__iteratees__,ne=Q.length,ce=0,ye=tr(B,this.__takeCount__);if(!a||!h&&g==B&&ye==B)return fp(r,this.__actions__);var Ee=[];e:for(;B--&&ce<ye;){Z+=i;for(var He=-1,Se=r[Z];++He<ne;){var Ve=Q[He],Qe=Ve.iteratee,Ir=Ve.type,dr=Qe(Se);if(Ir==I)Se=dr;else if(!dr){if(Ir==w)continue e;break e}}Ee[ce++]=Se}return Ee}Ye.prototype=Ni(qo.prototype),Ye.prototype.constructor=Ye;function ri(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var h=r[i];this.set(h[0],h[1])}}function z2(){this.__data__=vs?vs(null):{},this.size=0}function K2(r){var i=this.has(r)&&delete this.__data__[r];return this.size-=i?1:0,i}function G2(r){var i=this.__data__;if(vs){var a=i[r];return a===_?t:a}return it.call(i,r)?i[r]:t}function W2(r){var i=this.__data__;return vs?i[r]!==t:it.call(i,r)}function V2(r,i){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=vs&&i===t?_:i,this}ri.prototype.clear=z2,ri.prototype.delete=K2,ri.prototype.get=G2,ri.prototype.has=W2,ri.prototype.set=V2;function hn(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var h=r[i];this.set(h[0],h[1])}}function k2(){this.__data__=[],this.size=0}function Y2(r){var i=this.__data__,a=Ho(i,r);if(a<0)return!1;var h=i.length-1;return a==h?i.pop():Lo.call(i,a,1),--this.size,!0}function J2(r){var i=this.__data__,a=Ho(i,r);return a<0?t:i[a][1]}function X2(r){return Ho(this.__data__,r)>-1}function Z2(r,i){var a=this.__data__,h=Ho(a,r);return h<0?(++this.size,a.push([r,i])):a[h][1]=i,this}hn.prototype.clear=k2,hn.prototype.delete=Y2,hn.prototype.get=J2,hn.prototype.has=X2,hn.prototype.set=Z2;function ln(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var h=r[i];this.set(h[0],h[1])}}function Q2(){this.size=0,this.__data__={hash:new ri,map:new(_s||hn),string:new ri}}function e6(r){var i=Qo(this,r).delete(r);return this.size-=i?1:0,i}function t6(r){return Qo(this,r).get(r)}function r6(r){return Qo(this,r).has(r)}function n6(r,i){var a=Qo(this,r),h=a.size;return a.set(r,i),this.size+=a.size==h?0:1,this}ln.prototype.clear=Q2,ln.prototype.delete=e6,ln.prototype.get=t6,ln.prototype.has=r6,ln.prototype.set=n6;function ni(r){var i=-1,a=r==null?0:r.length;for(this.__data__=new ln;++i<a;)this.add(r[i])}function i6(r){return this.__data__.set(r,_),this}function s6(r){return this.__data__.has(r)}ni.prototype.add=ni.prototype.push=i6,ni.prototype.has=s6;function Wr(r){var i=this.__data__=new hn(r);this.size=i.size}function o6(){this.__data__=new hn,this.size=0}function a6(r){var i=this.__data__,a=i.delete(r);return this.size=i.size,a}function u6(r){return this.__data__.get(r)}function c6(r){return this.__data__.has(r)}function f6(r,i){var a=this.__data__;if(a instanceof hn){var h=a.__data__;if(!_s||h.length<o-1)return h.push([r,i]),this.size=++a.size,this;a=this.__data__=new ln(h)}return a.set(r,i),this.size=a.size,this}Wr.prototype.clear=o6,Wr.prototype.delete=a6,Wr.prototype.get=u6,Wr.prototype.has=c6,Wr.prototype.set=f6;function Hd(r,i){var a=Re(r),h=!a&&ui(r),g=!a&&!h&&$n(r),v=!a&&!h&&!g&&Ui(r),O=a||h||g||v,N=O?ic(r.length,w2):[],B=N.length;for(var Z in r)(i||it.call(r,Z))&&!(O&&(Z=="length"||g&&(Z=="offset"||Z=="parent")||v&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||_n(Z,B)))&&N.push(Z);return N}function jd(r){var i=r.length;return i?r[mc(0,i-1)]:t}function h6(r,i){return ea(vr(r),ii(i,0,r.length))}function l6(r){return ea(vr(r))}function hc(r,i,a){(a!==t&&!Vr(r[i],a)||a===t&&!(i in r))&&dn(r,i,a)}function ws(r,i,a){var h=r[i];(!(it.call(r,i)&&Vr(h,a))||a===t&&!(i in r))&&dn(r,i,a)}function Ho(r,i){for(var a=r.length;a--;)if(Vr(r[a][0],i))return a;return-1}function d6(r,i,a,h){return Rn(r,function(g,v,O){i(h,g,a(g),O)}),h}function zd(r,i){return r&&rn(i,Yt(i),r)}function p6(r,i){return r&&rn(i,wr(i),r)}function dn(r,i,a){i=="__proto__"&&Fo?Fo(r,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[i]=a}function lc(r,i){for(var a=-1,h=i.length,g=z(h),v=r==null;++a<h;)g[a]=v?t:Wc(r,i[a]);return g}function ii(r,i,a){return r===r&&(a!==t&&(r=r<=a?r:a),i!==t&&(r=r>=i?r:i)),r}function Ur(r,i,a,h,g,v){var O,N=i&T,B=i&D,Z=i&C;if(a&&(O=g?a(r,h,g,v):a(r)),O!==t)return O;if(!Et(r))return r;var Q=Re(r);if(Q){if(O=rS(r),!N)return vr(r,O)}else{var ne=rr(r),ce=ne==ae||ne==le;if($n(r))return dp(r,N);if(ne==Ue||ne==he||ce&&!g){if(O=B||ce?{}:Rp(r),!N)return B?G6(r,p6(O,r)):K6(r,zd(O,r))}else{if(!ot[ne])return g?r:{};O=nS(r,ne,N)}}v||(v=new Wr);var ye=v.get(r);if(ye)return ye;v.set(r,O),ag(r)?r.forEach(function(Se){O.add(Ur(Se,i,a,Se,r,v))}):sg(r)&&r.forEach(function(Se,Ve){O.set(Ve,Ur(Se,i,a,Ve,r,v))});var Ee=Z?B?Rc:Cc:B?wr:Yt,He=Q?t:Ee(r);return Lr(He||r,function(Se,Ve){He&&(Ve=Se,Se=r[Ve]),ws(O,Ve,Ur(Se,i,a,Ve,r,v))}),O}function g6(r){var i=Yt(r);return function(a){return Kd(a,r,i)}}function Kd(r,i,a){var h=a.length;if(r==null)return!h;for(r=ft(r);h--;){var g=a[h],v=i[g],O=r[g];if(O===t&&!(g in r)||!v(O))return!1}return!0}function Gd(r,i,a){if(typeof r!="function")throw new Fr(f);return Is(function(){r.apply(t,a)},i)}function ms(r,i,a,h){var g=-1,v=Do,O=!0,N=r.length,B=[],Z=i.length;if(!N)return B;a&&(i=bt(i,Dr(a))),h?(v=Zu,O=!1):i.length>=o&&(v=ps,O=!1,i=new ni(i));e:for(;++g<N;){var Q=r[g],ne=a==null?Q:a(Q);if(Q=h||Q!==0?Q:0,O&&ne===ne){for(var ce=Z;ce--;)if(i[ce]===ne)continue e;B.push(Q)}else v(i,ne,h)||B.push(Q)}return B}var Rn=vp(tn),Wd=vp(pc,!0);function _6(r,i){var a=!0;return Rn(r,function(h,g,v){return a=!!i(h,g,v),a}),a}function jo(r,i,a){for(var h=-1,g=r.length;++h<g;){var v=r[h],O=i(v);if(O!=null&&(N===t?O===O&&!Or(O):a(O,N)))var N=O,B=v}return B}function y6(r,i,a,h){var g=r.length;for(a=Me(a),a<0&&(a=-a>g?0:g+a),h=h===t||h>g?g:Me(h),h<0&&(h+=g),h=a>h?0:cg(h);a<h;)r[a++]=i;return r}function Vd(r,i){var a=[];return Rn(r,function(h,g,v){i(h,g,v)&&a.push(h)}),a}function Zt(r,i,a,h,g){var v=-1,O=r.length;for(a||(a=sS),g||(g=[]);++v<O;){var N=r[v];i>0&&a(N)?i>1?Zt(N,i-1,a,h,g):Pn(g,N):h||(g[g.length]=N)}return g}var dc=bp(),kd=bp(!0);function tn(r,i){return r&&dc(r,i,Yt)}function pc(r,i){return r&&kd(r,i,Yt)}function zo(r,i){return An(i,function(a){return yn(r[a])})}function si(r,i){i=Ln(i,r);for(var a=0,h=i.length;r!=null&&a<h;)r=r[nn(i[a++])];return a&&a==h?r:t}function Yd(r,i,a){var h=i(r);return Re(r)?h:Pn(h,a(r))}function hr(r){return r==null?r===t?qe:Ge:ti&&ti in ft(r)?Q6(r):lS(r)}function gc(r,i){return r>i}function v6(r,i){return r!=null&&it.call(r,i)}function b6(r,i){return r!=null&&i in ft(r)}function w6(r,i,a){return r>=tr(i,a)&&r<Wt(i,a)}function _c(r,i,a){for(var h=a?Zu:Do,g=r[0].length,v=r.length,O=v,N=z(v),B=1/0,Z=[];O--;){var Q=r[O];O&&i&&(Q=bt(Q,Dr(i))),B=tr(Q.length,B),N[O]=!a&&(i||g>=120&&Q.length>=120)?new ni(O&&Q):t}Q=r[0];var ne=-1,ce=N[0];e:for(;++ne<g&&Z.length<B;){var ye=Q[ne],Ee=i?i(ye):ye;if(ye=a||ye!==0?ye:0,!(ce?ps(ce,Ee):h(Z,Ee,a))){for(O=v;--O;){var He=N[O];if(!(He?ps(He,Ee):h(r[O],Ee,a)))continue e}ce&&ce.push(Ee),Z.push(ye)}}return Z}function m6(r,i,a,h){return tn(r,function(g,v,O){i(h,a(g),v,O)}),h}function Es(r,i,a){i=Ln(i,r),r=$p(r,i);var h=r==null?r:r[nn(Br(i))];return h==null?t:kt(h,r,a)}function Jd(r){return Tt(r)&&hr(r)==he}function E6(r){return Tt(r)&&hr(r)==De}function S6(r){return Tt(r)&&hr(r)==F}function Ss(r,i,a,h,g){return r===i?!0:r==null||i==null||!Tt(r)&&!Tt(i)?r!==r&&i!==i:D6(r,i,a,h,Ss,g)}function D6(r,i,a,h,g,v){var O=Re(r),N=Re(i),B=O?ve:rr(r),Z=N?ve:rr(i);B=B==he?Ue:B,Z=Z==he?Ue:Z;var Q=B==Ue,ne=Z==Ue,ce=B==Z;if(ce&&$n(r)){if(!$n(i))return!1;O=!0,Q=!1}if(ce&&!Q)return v||(v=new Wr),O||Ui(r)?Pp(r,i,a,h,g,v):X6(r,i,B,a,h,g,v);if(!(a&R)){var ye=Q&&it.call(r,"__wrapped__"),Ee=ne&&it.call(i,"__wrapped__");if(ye||Ee){var He=ye?r.value():r,Se=Ee?i.value():i;return v||(v=new Wr),g(He,Se,a,h,v)}}return ce?(v||(v=new Wr),Z6(r,i,a,h,g,v)):!1}function x6(r){return Tt(r)&&rr(r)==xe}function yc(r,i,a,h){var g=a.length,v=g,O=!h;if(r==null)return!v;for(r=ft(r);g--;){var N=a[g];if(O&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++g<v;){N=a[g];var B=N[0],Z=r[B],Q=N[1];if(O&&N[2]){if(Z===t&&!(B in r))return!1}else{var ne=new Wr;if(h)var ce=h(Z,Q,B,r,i,ne);if(!(ce===t?Ss(Q,Z,R|j,h,ne):ce))return!1}}return!0}function Xd(r){if(!Et(r)||aS(r))return!1;var i=yn(r)?x2:$u;return i.test(ai(r))}function O6(r){return Tt(r)&&hr(r)==Be}function I6(r){return Tt(r)&&rr(r)==Oe}function A6(r){return Tt(r)&&oa(r.length)&&!!at[hr(r)]}function Zd(r){return typeof r=="function"?r:r==null?mr:typeof r=="object"?Re(r)?tp(r[0],r[1]):ep(r):wg(r)}function vc(r){if(!Os(r))return C2(r);var i=[];for(var a in ft(r))it.call(r,a)&&a!="constructor"&&i.push(a);return i}function P6(r){if(!Et(r))return hS(r);var i=Os(r),a=[];for(var h in r)h=="constructor"&&(i||!it.call(r,h))||a.push(h);return a}function bc(r,i){return r<i}function Qd(r,i){var a=-1,h=br(r)?z(r.length):[];return Rn(r,function(g,v,O){h[++a]=i(g,v,O)}),h}function ep(r){var i=Lc(r);return i.length==1&&i[0][2]?Lp(i[0][0],i[0][1]):function(a){return a===r||yc(a,r,i)}}function tp(r,i){return $c(r)&&Np(i)?Lp(nn(r),i):function(a){var h=Wc(a,r);return h===t&&h===i?Vc(a,r):Ss(i,h,R|j)}}function Ko(r,i,a,h,g){r!==i&&dc(i,function(v,O){if(g||(g=new Wr),Et(v))T6(r,i,O,a,Ko,h,g);else{var N=h?h(Mc(r,O),v,O+"",r,i,g):t;N===t&&(N=v),hc(r,O,N)}},wr)}function T6(r,i,a,h,g,v,O){var N=Mc(r,a),B=Mc(i,a),Z=O.get(B);if(Z){hc(r,a,Z);return}var Q=v?v(N,B,a+"",r,i,O):t,ne=Q===t;if(ne){var ce=Re(B),ye=!ce&&$n(B),Ee=!ce&&!ye&&Ui(B);Q=B,ce||ye||Ee?Re(N)?Q=N:Lt(N)?Q=vr(N):ye?(ne=!1,Q=dp(B,!0)):Ee?(ne=!1,Q=pp(B,!0)):Q=[]:As(B)||ui(B)?(Q=N,ui(N)?Q=fg(N):(!Et(N)||yn(N))&&(Q=Rp(B))):ne=!1}ne&&(O.set(B,Q),g(Q,B,h,v,O),O.delete(B)),hc(r,a,Q)}function rp(r,i){var a=r.length;if(a)return i+=i<0?a:0,_n(i,a)?r[i]:t}function np(r,i,a){i.length?i=bt(i,function(v){return Re(v)?function(O){return si(O,v.length===1?v[0]:v)}:v}):i=[mr];var h=-1;i=bt(i,Dr(be()));var g=Qd(r,function(v,O,N){var B=bt(i,function(Z){return Z(v)});return{criteria:B,index:++h,value:v}});return n2(g,function(v,O){return z6(v,O,a)})}function C6(r,i){return ip(r,i,function(a,h){return Vc(r,h)})}function ip(r,i,a){for(var h=-1,g=i.length,v={};++h<g;){var O=i[h],N=si(r,O);a(N,O)&&Ds(v,Ln(O,r),N)}return v}function R6(r){return function(i){return si(i,r)}}function wc(r,i,a,h){var g=h?r2:Oi,v=-1,O=i.length,N=r;for(r===i&&(i=vr(i)),a&&(N=bt(r,Dr(a)));++v<O;)for(var B=0,Z=i[v],Q=a?a(Z):Z;(B=g(N,Q,B,h))>-1;)N!==r&&Lo.call(N,B,1),Lo.call(r,B,1);return r}function sp(r,i){for(var a=r?i.length:0,h=a-1;a--;){var g=i[a];if(a==h||g!==v){var v=g;_n(g)?Lo.call(r,g,1):Dc(r,g)}}return r}function mc(r,i){return r+Uo(Bd()*(i-r+1))}function N6(r,i,a,h){for(var g=-1,v=Wt($o((i-r)/(a||1)),0),O=z(v);v--;)O[h?v:++g]=r,r+=a;return O}function Ec(r,i){var a="";if(!r||i<1||i>G)return a;do i%2&&(a+=r),i=Uo(i/2),i&&(r+=r);while(i);return a}function Ke(r,i){return Bc(Fp(r,i,mr),r+"")}function L6(r){return jd(Mi(r))}function F6(r,i){var a=Mi(r);return ea(a,ii(i,0,a.length))}function Ds(r,i,a,h){if(!Et(r))return r;i=Ln(i,r);for(var g=-1,v=i.length,O=v-1,N=r;N!=null&&++g<v;){var B=nn(i[g]),Z=a;if(B==="__proto__"||B==="constructor"||B==="prototype")return r;if(g!=O){var Q=N[B];Z=h?h(Q,B,N):t,Z===t&&(Z=Et(Q)?Q:_n(i[g+1])?[]:{})}ws(N,B,Z),N=N[B]}return r}var op=Mo?function(r,i){return Mo.set(r,i),r}:mr,$6=Fo?function(r,i){return Fo(r,"toString",{configurable:!0,enumerable:!1,value:Yc(i),writable:!0})}:mr;function U6(r){return ea(Mi(r))}function Mr(r,i,a){var h=-1,g=r.length;i<0&&(i=-i>g?0:g+i),a=a>g?g:a,a<0&&(a+=g),g=i>a?0:a-i>>>0,i>>>=0;for(var v=z(g);++h<g;)v[h]=r[h+i];return v}function M6(r,i){var a;return Rn(r,function(h,g,v){return a=i(h,g,v),!a}),!!a}function Go(r,i,a){var h=0,g=r==null?h:r.length;if(typeof i=="number"&&i===i&&g<=oe){for(;h<g;){var v=h+g>>>1,O=r[v];O!==null&&!Or(O)&&(a?O<=i:O<i)?h=v+1:g=v}return g}return Sc(r,i,mr,a)}function Sc(r,i,a,h){var g=0,v=r==null?0:r.length;if(v===0)return 0;i=a(i);for(var O=i!==i,N=i===null,B=Or(i),Z=i===t;g<v;){var Q=Uo((g+v)/2),ne=a(r[Q]),ce=ne!==t,ye=ne===null,Ee=ne===ne,He=Or(ne);if(O)var Se=h||Ee;else Z?Se=Ee&&(h||ce):N?Se=Ee&&ce&&(h||!ye):B?Se=Ee&&ce&&!ye&&(h||!He):ye||He?Se=!1:Se=h?ne<=i:ne<i;Se?g=Q+1:v=Q}return tr(v,we)}function ap(r,i){for(var a=-1,h=r.length,g=0,v=[];++a<h;){var O=r[a],N=i?i(O):O;if(!a||!Vr(N,B)){var B=N;v[g++]=O===0?0:O}}return v}function up(r){return typeof r=="number"?r:Or(r)?J:+r}function xr(r){if(typeof r=="string")return r;if(Re(r))return bt(r,xr)+"";if(Or(r))return qd?qd.call(r):"";var i=r+"";return i=="0"&&1/r==-X?"-0":i}function Nn(r,i,a){var h=-1,g=Do,v=r.length,O=!0,N=[],B=N;if(a)O=!1,g=Zu;else if(v>=o){var Z=i?null:Y6(r);if(Z)return Oo(Z);O=!1,g=ps,B=new ni}else B=i?[]:N;e:for(;++h<v;){var Q=r[h],ne=i?i(Q):Q;if(Q=a||Q!==0?Q:0,O&&ne===ne){for(var ce=B.length;ce--;)if(B[ce]===ne)continue e;i&&B.push(ne),N.push(Q)}else g(B,ne,a)||(B!==N&&B.push(ne),N.push(Q))}return N}function Dc(r,i){return i=Ln(i,r),r=$p(r,i),r==null||delete r[nn(Br(i))]}function cp(r,i,a,h){return Ds(r,i,a(si(r,i)),h)}function Wo(r,i,a,h){for(var g=r.length,v=h?g:-1;(h?v--:++v<g)&&i(r[v],v,r););return a?Mr(r,h?0:v,h?v+1:g):Mr(r,h?v+1:0,h?g:v)}function fp(r,i){var a=r;return a instanceof Ye&&(a=a.value()),Qu(i,function(h,g){return g.func.apply(g.thisArg,Pn([h],g.args))},a)}function xc(r,i,a){var h=r.length;if(h<2)return h?Nn(r[0]):[];for(var g=-1,v=z(h);++g<h;)for(var O=r[g],N=-1;++N<h;)N!=g&&(v[g]=ms(v[g]||O,r[N],i,a));return Nn(Zt(v,1),i,a)}function hp(r,i,a){for(var h=-1,g=r.length,v=i.length,O={};++h<g;){var N=h<v?i[h]:t;a(O,r[h],N)}return O}function Oc(r){return Lt(r)?r:[]}function Ic(r){return typeof r=="function"?r:mr}function Ln(r,i){return Re(r)?r:$c(r,i)?[r]:qp(nt(r))}var B6=Ke;function Fn(r,i,a){var h=r.length;return a=a===t?h:a,!i&&a>=h?r:Mr(r,i,a)}var lp=O2||function(r){return Ze.clearTimeout(r)};function dp(r,i){if(i)return r.slice();var a=r.length,h=Ld?Ld(a):new r.constructor(a);return r.copy(h),h}function Ac(r){var i=new r.constructor(r.byteLength);return new Ro(i).set(new Ro(r)),i}function q6(r,i){var a=i?Ac(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function H6(r){var i=new r.constructor(r.source,Rr.exec(r));return i.lastIndex=r.lastIndex,i}function j6(r){return bs?ft(bs.call(r)):{}}function pp(r,i){var a=i?Ac(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function gp(r,i){if(r!==i){var a=r!==t,h=r===null,g=r===r,v=Or(r),O=i!==t,N=i===null,B=i===i,Z=Or(i);if(!N&&!Z&&!v&&r>i||v&&O&&B&&!N&&!Z||h&&O&&B||!a&&B||!g)return 1;if(!h&&!v&&!Z&&r<i||Z&&a&&g&&!h&&!v||N&&a&&g||!O&&g||!B)return-1}return 0}function z6(r,i,a){for(var h=-1,g=r.criteria,v=i.criteria,O=g.length,N=a.length;++h<O;){var B=gp(g[h],v[h]);if(B){if(h>=N)return B;var Z=a[h];return B*(Z=="desc"?-1:1)}}return r.index-i.index}function _p(r,i,a,h){for(var g=-1,v=r.length,O=a.length,N=-1,B=i.length,Z=Wt(v-O,0),Q=z(B+Z),ne=!h;++N<B;)Q[N]=i[N];for(;++g<O;)(ne||g<v)&&(Q[a[g]]=r[g]);for(;Z--;)Q[N++]=r[g++];return Q}function yp(r,i,a,h){for(var g=-1,v=r.length,O=-1,N=a.length,B=-1,Z=i.length,Q=Wt(v-N,0),ne=z(Q+Z),ce=!h;++g<Q;)ne[g]=r[g];for(var ye=g;++B<Z;)ne[ye+B]=i[B];for(;++O<N;)(ce||g<v)&&(ne[ye+a[O]]=r[g++]);return ne}function vr(r,i){var a=-1,h=r.length;for(i||(i=z(h));++a<h;)i[a]=r[a];return i}function rn(r,i,a,h){var g=!a;a||(a={});for(var v=-1,O=i.length;++v<O;){var N=i[v],B=h?h(a[N],r[N],N,a,r):t;B===t&&(B=r[N]),g?dn(a,N,B):ws(a,N,B)}return a}function K6(r,i){return rn(r,Fc(r),i)}function G6(r,i){return rn(r,Tp(r),i)}function Vo(r,i){return function(a,h){var g=Re(a)?J3:d6,v=i?i():{};return g(a,r,be(h,2),v)}}function Li(r){return Ke(function(i,a){var h=-1,g=a.length,v=g>1?a[g-1]:t,O=g>2?a[2]:t;for(v=r.length>3&&typeof v=="function"?(g--,v):t,O&&lr(a[0],a[1],O)&&(v=g<3?t:v,g=1),i=ft(i);++h<g;){var N=a[h];N&&r(i,N,h,v)}return i})}function vp(r,i){return function(a,h){if(a==null)return a;if(!br(a))return r(a,h);for(var g=a.length,v=i?g:-1,O=ft(a);(i?v--:++v<g)&&h(O[v],v,O)!==!1;);return a}}function bp(r){return function(i,a,h){for(var g=-1,v=ft(i),O=h(i),N=O.length;N--;){var B=O[r?N:++g];if(a(v[B],B,v)===!1)break}return i}}function W6(r,i,a){var h=i&K,g=xs(r);function v(){var O=this&&this!==Ze&&this instanceof v?g:r;return O.apply(h?a:this,arguments)}return v}function wp(r){return function(i){i=nt(i);var a=Ii(i)?Gr(i):t,h=a?a[0]:i.charAt(0),g=a?Fn(a,1).join(""):i.slice(1);return h[r]()+g}}function Fi(r){return function(i){return Qu(vg(yg(i).replace(ls,"")),r,"")}}function xs(r){return function(){var i=arguments;switch(i.length){case 0:return new r;case 1:return new r(i[0]);case 2:return new r(i[0],i[1]);case 3:return new r(i[0],i[1],i[2]);case 4:return new r(i[0],i[1],i[2],i[3]);case 5:return new r(i[0],i[1],i[2],i[3],i[4]);case 6:return new r(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=Ni(r.prototype),h=r.apply(a,i);return Et(h)?h:a}}function V6(r,i,a){var h=xs(r);function g(){for(var v=arguments.length,O=z(v),N=v,B=$i(g);N--;)O[N]=arguments[N];var Z=v<3&&O[0]!==B&&O[v-1]!==B?[]:Tn(O,B);if(v-=Z.length,v<a)return xp(r,i,ko,g.placeholder,t,O,Z,t,t,a-v);var Q=this&&this!==Ze&&this instanceof g?h:r;return kt(Q,this,O)}return g}function mp(r){return function(i,a,h){var g=ft(i);if(!br(i)){var v=be(a,3);i=Yt(i),a=function(N){return v(g[N],N,g)}}var O=r(i,a,h);return O>-1?g[v?i[O]:O]:t}}function Ep(r){return gn(function(i){var a=i.length,h=a,g=$r.prototype.thru;for(r&&i.reverse();h--;){var v=i[h];if(typeof v!="function")throw new Fr(f);if(g&&!O&&Zo(v)=="wrapper")var O=new $r([],!0)}for(h=O?h:a;++h<a;){v=i[h];var N=Zo(v),B=N=="wrapper"?Nc(v):t;B&&Uc(B[0])&&B[1]==(c|M|P|b)&&!B[4].length&&B[9]==1?O=O[Zo(B[0])].apply(O,B[3]):O=v.length==1&&Uc(v)?O[N]():O.thru(v)}return function(){var Z=arguments,Q=Z[0];if(O&&Z.length==1&&Re(Q))return O.plant(Q).value();for(var ne=0,ce=a?i[ne].apply(this,Z):Q;++ne<a;)ce=i[ne].call(this,ce);return ce}})}function ko(r,i,a,h,g,v,O,N,B,Z){var Q=i&c,ne=i&K,ce=i&se,ye=i&(M|x),Ee=i&V,He=ce?t:xs(r);function Se(){for(var Ve=arguments.length,Qe=z(Ve),Ir=Ve;Ir--;)Qe[Ir]=arguments[Ir];if(ye)var dr=$i(Se),Ar=s2(Qe,dr);if(h&&(Qe=_p(Qe,h,g,ye)),v&&(Qe=yp(Qe,v,O,ye)),Ve-=Ar,ye&&Ve<Z){var Ft=Tn(Qe,dr);return xp(r,i,ko,Se.placeholder,a,Qe,Ft,N,B,Z-Ve)}var kr=ne?a:this,bn=ce?kr[r]:r;return Ve=Qe.length,N?Qe=dS(Qe,N):Ee&&Ve>1&&Qe.reverse(),Q&&B<Ve&&(Qe.length=B),this&&this!==Ze&&this instanceof Se&&(bn=He||xs(bn)),bn.apply(kr,Qe)}return Se}function Sp(r,i){return function(a,h){return m6(a,r,i(h),{})}}function Yo(r,i){return function(a,h){var g;if(a===t&&h===t)return i;if(a!==t&&(g=a),h!==t){if(g===t)return h;typeof a=="string"||typeof h=="string"?(a=xr(a),h=xr(h)):(a=up(a),h=up(h)),g=r(a,h)}return g}}function Pc(r){return gn(function(i){return i=bt(i,Dr(be())),Ke(function(a){var h=this;return r(i,function(g){return kt(g,h,a)})})})}function Jo(r,i){i=i===t?" ":xr(i);var a=i.length;if(a<2)return a?Ec(i,r):i;var h=Ec(i,$o(r/Ai(i)));return Ii(i)?Fn(Gr(h),0,r).join(""):h.slice(0,r)}function k6(r,i,a,h){var g=i&K,v=xs(r);function O(){for(var N=-1,B=arguments.length,Z=-1,Q=h.length,ne=z(Q+B),ce=this&&this!==Ze&&this instanceof O?v:r;++Z<Q;)ne[Z]=h[Z];for(;B--;)ne[Z++]=arguments[++N];return kt(ce,g?a:this,ne)}return O}function Dp(r){return function(i,a,h){return h&&typeof h!="number"&&lr(i,a,h)&&(a=h=t),i=vn(i),a===t?(a=i,i=0):a=vn(a),h=h===t?i<a?1:-1:vn(h),N6(i,a,h,r)}}function Xo(r){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=qr(i),a=qr(a)),r(i,a)}}function xp(r,i,a,h,g,v,O,N,B,Z){var Q=i&M,ne=Q?O:t,ce=Q?t:O,ye=Q?v:t,Ee=Q?t:v;i|=Q?P:m,i&=~(Q?m:P),i&L||(i&=~(K|se));var He=[r,i,g,ye,ne,Ee,ce,N,B,Z],Se=a.apply(t,He);return Uc(r)&&Up(Se,He),Se.placeholder=h,Mp(Se,r,i)}function Tc(r){var i=Gt[r];return function(a,h){if(a=qr(a),h=h==null?0:tr(Me(h),292),h&&Md(a)){var g=(nt(a)+"e").split("e"),v=i(g[0]+"e"+(+g[1]+h));return g=(nt(v)+"e").split("e"),+(g[0]+"e"+(+g[1]-h))}return i(a)}}var Y6=Ci&&1/Oo(new Ci([,-0]))[1]==X?function(r){return new Ci(r)}:Zc;function Op(r){return function(i){var a=rr(i);return a==xe?oc(i):a==Oe?l2(i):i2(i,r(i))}}function pn(r,i,a,h,g,v,O,N){var B=i&se;if(!B&&typeof r!="function")throw new Fr(f);var Z=h?h.length:0;if(Z||(i&=~(P|m),h=g=t),O=O===t?O:Wt(Me(O),0),N=N===t?N:Me(N),Z-=g?g.length:0,i&m){var Q=h,ne=g;h=g=t}var ce=B?t:Nc(r),ye=[r,i,a,h,g,Q,ne,v,O,N];if(ce&&fS(ye,ce),r=ye[0],i=ye[1],a=ye[2],h=ye[3],g=ye[4],N=ye[9]=ye[9]===t?B?0:r.length:Wt(ye[9]-Z,0),!N&&i&(M|x)&&(i&=~(M|x)),!i||i==K)var Ee=W6(r,i,a);else i==M||i==x?Ee=V6(r,i,N):(i==P||i==(K|P))&&!g.length?Ee=k6(r,i,a,h):Ee=ko.apply(t,ye);var He=ce?op:Up;return Mp(He(Ee,ye),r,i)}function Ip(r,i,a,h){return r===t||Vr(r,Ti[a])&&!it.call(h,a)?i:r}function Ap(r,i,a,h,g,v){return Et(r)&&Et(i)&&(v.set(i,r),Ko(r,i,t,Ap,v),v.delete(i)),r}function J6(r){return As(r)?t:r}function Pp(r,i,a,h,g,v){var O=a&R,N=r.length,B=i.length;if(N!=B&&!(O&&B>N))return!1;var Z=v.get(r),Q=v.get(i);if(Z&&Q)return Z==i&&Q==r;var ne=-1,ce=!0,ye=a&j?new ni:t;for(v.set(r,i),v.set(i,r);++ne<N;){var Ee=r[ne],He=i[ne];if(h)var Se=O?h(He,Ee,ne,i,r,v):h(Ee,He,ne,r,i,v);if(Se!==t){if(Se)continue;ce=!1;break}if(ye){if(!ec(i,function(Ve,Qe){if(!ps(ye,Qe)&&(Ee===Ve||g(Ee,Ve,a,h,v)))return ye.push(Qe)})){ce=!1;break}}else if(!(Ee===He||g(Ee,He,a,h,v))){ce=!1;break}}return v.delete(r),v.delete(i),ce}function X6(r,i,a,h,g,v,O){switch(a){case Pe:if(r.byteLength!=i.byteLength||r.byteOffset!=i.byteOffset)return!1;r=r.buffer,i=i.buffer;case De:return!(r.byteLength!=i.byteLength||!v(new Ro(r),new Ro(i)));case q:case F:case je:return Vr(+r,+i);case A:return r.name==i.name&&r.message==i.message;case Be:case Le:return r==i+"";case xe:var N=oc;case Oe:var B=h&R;if(N||(N=Oo),r.size!=i.size&&!B)return!1;var Z=O.get(r);if(Z)return Z==i;h|=j,O.set(r,i);var Q=Pp(N(r),N(i),h,g,v,O);return O.delete(r),Q;case Fe:if(bs)return bs.call(r)==bs.call(i)}return!1}function Z6(r,i,a,h,g,v){var O=a&R,N=Cc(r),B=N.length,Z=Cc(i),Q=Z.length;if(B!=Q&&!O)return!1;for(var ne=B;ne--;){var ce=N[ne];if(!(O?ce in i:it.call(i,ce)))return!1}var ye=v.get(r),Ee=v.get(i);if(ye&&Ee)return ye==i&&Ee==r;var He=!0;v.set(r,i),v.set(i,r);for(var Se=O;++ne<B;){ce=N[ne];var Ve=r[ce],Qe=i[ce];if(h)var Ir=O?h(Qe,Ve,ce,i,r,v):h(Ve,Qe,ce,r,i,v);if(!(Ir===t?Ve===Qe||g(Ve,Qe,a,h,v):Ir)){He=!1;break}Se||(Se=ce=="constructor")}if(He&&!Se){var dr=r.constructor,Ar=i.constructor;dr!=Ar&&"constructor"in r&&"constructor"in i&&!(typeof dr=="function"&&dr instanceof dr&&typeof Ar=="function"&&Ar instanceof Ar)&&(He=!1)}return v.delete(r),v.delete(i),He}function gn(r){return Bc(Fp(r,t,Kp),r+"")}function Cc(r){return Yd(r,Yt,Fc)}function Rc(r){return Yd(r,wr,Tp)}var Nc=Mo?function(r){return Mo.get(r)}:Zc;function Zo(r){for(var i=r.name+"",a=Ri[i],h=it.call(Ri,i)?a.length:0;h--;){var g=a[h],v=g.func;if(v==null||v==r)return g.name}return i}function $i(r){var i=it.call(y,"placeholder")?y:r;return i.placeholder}function be(){var r=y.iteratee||Jc;return r=r===Jc?Zd:r,arguments.length?r(arguments[0],arguments[1]):r}function Qo(r,i){var a=r.__data__;return oS(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Lc(r){for(var i=Yt(r),a=i.length;a--;){var h=i[a],g=r[h];i[a]=[h,g,Np(g)]}return i}function oi(r,i){var a=c2(r,i);return Xd(a)?a:t}function Q6(r){var i=it.call(r,ti),a=r[ti];try{r[ti]=t;var h=!0}catch{}var g=To.call(r);return h&&(i?r[ti]=a:delete r[ti]),g}var Fc=uc?function(r){return r==null?[]:(r=ft(r),An(uc(r),function(i){return $d.call(r,i)}))}:Qc,Tp=uc?function(r){for(var i=[];r;)Pn(i,Fc(r)),r=No(r);return i}:Qc,rr=hr;(cc&&rr(new cc(new ArrayBuffer(1)))!=Pe||_s&&rr(new _s)!=xe||fc&&rr(fc.resolve())!=gt||Ci&&rr(new Ci)!=Oe||ys&&rr(new ys)!=Ae)&&(rr=function(r){var i=hr(r),a=i==Ue?r.constructor:t,h=a?ai(a):"";if(h)switch(h){case F2:return Pe;case $2:return xe;case U2:return gt;case M2:return Oe;case B2:return Ae}return i});function eS(r,i,a){for(var h=-1,g=a.length;++h<g;){var v=a[h],O=v.size;switch(v.type){case"drop":r+=O;break;case"dropRight":i-=O;break;case"take":i=tr(i,r+O);break;case"takeRight":r=Wt(r,i-O);break}}return{start:r,end:i}}function tS(r){var i=r.match(lt);return i?i[1].split(Ht):[]}function Cp(r,i,a){i=Ln(i,r);for(var h=-1,g=i.length,v=!1;++h<g;){var O=nn(i[h]);if(!(v=r!=null&&a(r,O)))break;r=r[O]}return v||++h!=g?v:(g=r==null?0:r.length,!!g&&oa(g)&&_n(O,g)&&(Re(r)||ui(r)))}function rS(r){var i=r.length,a=new r.constructor(i);return i&&typeof r[0]=="string"&&it.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function Rp(r){return typeof r.constructor=="function"&&!Os(r)?Ni(No(r)):{}}function nS(r,i,a){var h=r.constructor;switch(i){case De:return Ac(r);case q:case F:return new h(+r);case Pe:return q6(r,a);case ze:case Ie:case We:case ke:case et:case tt:case Xe:case ur:case _r:return pp(r,a);case xe:return new h;case je:case Le:return new h(r);case Be:return H6(r);case Oe:return new h;case Fe:return j6(r)}}function iS(r,i){var a=i.length;if(!a)return r;var h=a-1;return i[h]=(a>1?"& ":"")+i[h],i=i.join(a>2?", ":" "),r.replace(Pt,`{
/* [wrapped with `+i+`] */
`)}function sS(r){return Re(r)||ui(r)||!!(Ud&&r&&r[Ud])}function _n(r,i){var a=typeof r;return i=i??G,!!i&&(a=="number"||a!="symbol"&&Mu.test(r))&&r>-1&&r%1==0&&r<i}function lr(r,i,a){if(!Et(a))return!1;var h=typeof i;return(h=="number"?br(a)&&_n(i,a.length):h=="string"&&i in a)?Vr(a[i],r):!1}function $c(r,i){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Or(r)?!0:Mt.test(r)||!vt.test(r)||i!=null&&r in ft(i)}function oS(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}function Uc(r){var i=Zo(r),a=y[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(r===a)return!0;var h=Nc(a);return!!h&&r===h[0]}function aS(r){return!!Nd&&Nd in r}var uS=Ao?yn:ef;function Os(r){var i=r&&r.constructor,a=typeof i=="function"&&i.prototype||Ti;return r===a}function Np(r){return r===r&&!Et(r)}function Lp(r,i){return function(a){return a==null?!1:a[r]===i&&(i!==t||r in ft(a))}}function cS(r){var i=ia(r,function(h){return a.size===p&&a.clear(),h}),a=i.cache;return i}function fS(r,i){var a=r[1],h=i[1],g=a|h,v=g<(K|se|c),O=h==c&&a==M||h==c&&a==b&&r[7].length<=i[8]||h==(c|b)&&i[7].length<=i[8]&&a==M;if(!(v||O))return r;h&K&&(r[2]=i[2],g|=a&K?0:L);var N=i[3];if(N){var B=r[3];r[3]=B?_p(B,N,i[4]):N,r[4]=B?Tn(r[3],E):i[4]}return N=i[5],N&&(B=r[5],r[5]=B?yp(B,N,i[6]):N,r[6]=B?Tn(r[5],E):i[6]),N=i[7],N&&(r[7]=N),h&c&&(r[8]=r[8]==null?i[8]:tr(r[8],i[8])),r[9]==null&&(r[9]=i[9]),r[0]=i[0],r[1]=g,r}function hS(r){var i=[];if(r!=null)for(var a in ft(r))i.push(a);return i}function lS(r){return To.call(r)}function Fp(r,i,a){return i=Wt(i===t?r.length-1:i,0),function(){for(var h=arguments,g=-1,v=Wt(h.length-i,0),O=z(v);++g<v;)O[g]=h[i+g];g=-1;for(var N=z(i+1);++g<i;)N[g]=h[g];return N[i]=a(O),kt(r,this,N)}}function $p(r,i){return i.length<2?r:si(r,Mr(i,0,-1))}function dS(r,i){for(var a=r.length,h=tr(i.length,a),g=vr(r);h--;){var v=i[h];r[h]=_n(v,a)?g[v]:t}return r}function Mc(r,i){if(!(i==="constructor"&&typeof r[i]=="function")&&i!="__proto__")return r[i]}var Up=Bp(op),Is=A2||function(r,i){return Ze.setTimeout(r,i)},Bc=Bp($6);function Mp(r,i,a){var h=i+"";return Bc(r,iS(h,pS(tS(h),a)))}function Bp(r){var i=0,a=0;return function(){var h=R2(),g=de-(h-a);if(a=h,g>0){if(++i>=ue)return arguments[0]}else i=0;return r.apply(t,arguments)}}function ea(r,i){var a=-1,h=r.length,g=h-1;for(i=i===t?h:i;++a<i;){var v=mc(a,g),O=r[v];r[v]=r[a],r[a]=O}return r.length=i,r}var qp=cS(function(r){var i=[];return r.charCodeAt(0)===46&&i.push(""),r.replace(Bt,function(a,h,g,v){i.push(g?v.replace(Ru,"$1"):h||a)}),i});function nn(r){if(typeof r=="string"||Or(r))return r;var i=r+"";return i=="0"&&1/r==-X?"-0":i}function ai(r){if(r!=null){try{return Po.call(r)}catch{}try{return r+""}catch{}}return""}function pS(r,i){return Lr(me,function(a){var h="_."+a[0];i&a[1]&&!Do(r,h)&&r.push(h)}),r.sort()}function Hp(r){if(r instanceof Ye)return r.clone();var i=new $r(r.__wrapped__,r.__chain__);return i.__actions__=vr(r.__actions__),i.__index__=r.__index__,i.__values__=r.__values__,i}function gS(r,i,a){(a?lr(r,i,a):i===t)?i=1:i=Wt(Me(i),0);var h=r==null?0:r.length;if(!h||i<1)return[];for(var g=0,v=0,O=z($o(h/i));g<h;)O[v++]=Mr(r,g,g+=i);return O}function _S(r){for(var i=-1,a=r==null?0:r.length,h=0,g=[];++i<a;){var v=r[i];v&&(g[h++]=v)}return g}function yS(){var r=arguments.length;if(!r)return[];for(var i=z(r-1),a=arguments[0],h=r;h--;)i[h-1]=arguments[h];return Pn(Re(a)?vr(a):[a],Zt(i,1))}var vS=Ke(function(r,i){return Lt(r)?ms(r,Zt(i,1,Lt,!0)):[]}),bS=Ke(function(r,i){var a=Br(i);return Lt(a)&&(a=t),Lt(r)?ms(r,Zt(i,1,Lt,!0),be(a,2)):[]}),wS=Ke(function(r,i){var a=Br(i);return Lt(a)&&(a=t),Lt(r)?ms(r,Zt(i,1,Lt,!0),t,a):[]});function mS(r,i,a){var h=r==null?0:r.length;return h?(i=a||i===t?1:Me(i),Mr(r,i<0?0:i,h)):[]}function ES(r,i,a){var h=r==null?0:r.length;return h?(i=a||i===t?1:Me(i),i=h-i,Mr(r,0,i<0?0:i)):[]}function SS(r,i){return r&&r.length?Wo(r,be(i,3),!0,!0):[]}function DS(r,i){return r&&r.length?Wo(r,be(i,3),!0):[]}function xS(r,i,a,h){var g=r==null?0:r.length;return g?(a&&typeof a!="number"&&lr(r,i,a)&&(a=0,h=g),y6(r,i,a,h)):[]}function jp(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var g=a==null?0:Me(a);return g<0&&(g=Wt(h+g,0)),xo(r,be(i,3),g)}function zp(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var g=h-1;return a!==t&&(g=Me(a),g=a<0?Wt(h+g,0):tr(g,h-1)),xo(r,be(i,3),g,!0)}function Kp(r){var i=r==null?0:r.length;return i?Zt(r,1):[]}function OS(r){var i=r==null?0:r.length;return i?Zt(r,X):[]}function IS(r,i){var a=r==null?0:r.length;return a?(i=i===t?1:Me(i),Zt(r,i)):[]}function AS(r){for(var i=-1,a=r==null?0:r.length,h={};++i<a;){var g=r[i];h[g[0]]=g[1]}return h}function Gp(r){return r&&r.length?r[0]:t}function PS(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var g=a==null?0:Me(a);return g<0&&(g=Wt(h+g,0)),Oi(r,i,g)}function TS(r){var i=r==null?0:r.length;return i?Mr(r,0,-1):[]}var CS=Ke(function(r){var i=bt(r,Oc);return i.length&&i[0]===r[0]?_c(i):[]}),RS=Ke(function(r){var i=Br(r),a=bt(r,Oc);return i===Br(a)?i=t:a.pop(),a.length&&a[0]===r[0]?_c(a,be(i,2)):[]}),NS=Ke(function(r){var i=Br(r),a=bt(r,Oc);return i=typeof i=="function"?i:t,i&&a.pop(),a.length&&a[0]===r[0]?_c(a,t,i):[]});function LS(r,i){return r==null?"":T2.call(r,i)}function Br(r){var i=r==null?0:r.length;return i?r[i-1]:t}function FS(r,i,a){var h=r==null?0:r.length;if(!h)return-1;var g=h;return a!==t&&(g=Me(a),g=g<0?Wt(h+g,0):tr(g,h-1)),i===i?p2(r,i,g):xo(r,xd,g,!0)}function $S(r,i){return r&&r.length?rp(r,Me(i)):t}var US=Ke(Wp);function Wp(r,i){return r&&r.length&&i&&i.length?wc(r,i):r}function MS(r,i,a){return r&&r.length&&i&&i.length?wc(r,i,be(a,2)):r}function BS(r,i,a){return r&&r.length&&i&&i.length?wc(r,i,t,a):r}var qS=gn(function(r,i){var a=r==null?0:r.length,h=lc(r,i);return sp(r,bt(i,function(g){return _n(g,a)?+g:g}).sort(gp)),h});function HS(r,i){var a=[];if(!(r&&r.length))return a;var h=-1,g=[],v=r.length;for(i=be(i,3);++h<v;){var O=r[h];i(O,h,r)&&(a.push(O),g.push(h))}return sp(r,g),a}function qc(r){return r==null?r:L2.call(r)}function jS(r,i,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&lr(r,i,a)?(i=0,a=h):(i=i==null?0:Me(i),a=a===t?h:Me(a)),Mr(r,i,a)):[]}function zS(r,i){return Go(r,i)}function KS(r,i,a){return Sc(r,i,be(a,2))}function GS(r,i){var a=r==null?0:r.length;if(a){var h=Go(r,i);if(h<a&&Vr(r[h],i))return h}return-1}function WS(r,i){return Go(r,i,!0)}function VS(r,i,a){return Sc(r,i,be(a,2),!0)}function kS(r,i){var a=r==null?0:r.length;if(a){var h=Go(r,i,!0)-1;if(Vr(r[h],i))return h}return-1}function YS(r){return r&&r.length?ap(r):[]}function JS(r,i){return r&&r.length?ap(r,be(i,2)):[]}function XS(r){var i=r==null?0:r.length;return i?Mr(r,1,i):[]}function ZS(r,i,a){return r&&r.length?(i=a||i===t?1:Me(i),Mr(r,0,i<0?0:i)):[]}function QS(r,i,a){var h=r==null?0:r.length;return h?(i=a||i===t?1:Me(i),i=h-i,Mr(r,i<0?0:i,h)):[]}function eD(r,i){return r&&r.length?Wo(r,be(i,3),!1,!0):[]}function tD(r,i){return r&&r.length?Wo(r,be(i,3)):[]}var rD=Ke(function(r){return Nn(Zt(r,1,Lt,!0))}),nD=Ke(function(r){var i=Br(r);return Lt(i)&&(i=t),Nn(Zt(r,1,Lt,!0),be(i,2))}),iD=Ke(function(r){var i=Br(r);return i=typeof i=="function"?i:t,Nn(Zt(r,1,Lt,!0),t,i)});function sD(r){return r&&r.length?Nn(r):[]}function oD(r,i){return r&&r.length?Nn(r,be(i,2)):[]}function aD(r,i){return i=typeof i=="function"?i:t,r&&r.length?Nn(r,t,i):[]}function Hc(r){if(!(r&&r.length))return[];var i=0;return r=An(r,function(a){if(Lt(a))return i=Wt(a.length,i),!0}),ic(i,function(a){return bt(r,tc(a))})}function Vp(r,i){if(!(r&&r.length))return[];var a=Hc(r);return i==null?a:bt(a,function(h){return kt(i,t,h)})}var uD=Ke(function(r,i){return Lt(r)?ms(r,i):[]}),cD=Ke(function(r){return xc(An(r,Lt))}),fD=Ke(function(r){var i=Br(r);return Lt(i)&&(i=t),xc(An(r,Lt),be(i,2))}),hD=Ke(function(r){var i=Br(r);return i=typeof i=="function"?i:t,xc(An(r,Lt),t,i)}),lD=Ke(Hc);function dD(r,i){return hp(r||[],i||[],ws)}function pD(r,i){return hp(r||[],i||[],Ds)}var gD=Ke(function(r){var i=r.length,a=i>1?r[i-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Vp(r,a)});function kp(r){var i=y(r);return i.__chain__=!0,i}function _D(r,i){return i(r),r}function ta(r,i){return i(r)}var yD=gn(function(r){var i=r.length,a=i?r[0]:0,h=this.__wrapped__,g=function(v){return lc(v,r)};return i>1||this.__actions__.length||!(h instanceof Ye)||!_n(a)?this.thru(g):(h=h.slice(a,+a+(i?1:0)),h.__actions__.push({func:ta,args:[g],thisArg:t}),new $r(h,this.__chain__).thru(function(v){return i&&!v.length&&v.push(t),v}))});function vD(){return kp(this)}function bD(){return new $r(this.value(),this.__chain__)}function wD(){this.__values__===t&&(this.__values__=ug(this.value()));var r=this.__index__>=this.__values__.length,i=r?t:this.__values__[this.__index__++];return{done:r,value:i}}function mD(){return this}function ED(r){for(var i,a=this;a instanceof qo;){var h=Hp(a);h.__index__=0,h.__values__=t,i?g.__wrapped__=h:i=h;var g=h;a=a.__wrapped__}return g.__wrapped__=r,i}function SD(){var r=this.__wrapped__;if(r instanceof Ye){var i=r;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:ta,args:[qc],thisArg:t}),new $r(i,this.__chain__)}return this.thru(qc)}function DD(){return fp(this.__wrapped__,this.__actions__)}var xD=Vo(function(r,i,a){it.call(r,a)?++r[a]:dn(r,a,1)});function OD(r,i,a){var h=Re(r)?Sd:_6;return a&&lr(r,i,a)&&(i=t),h(r,be(i,3))}function ID(r,i){var a=Re(r)?An:Vd;return a(r,be(i,3))}var AD=mp(jp),PD=mp(zp);function TD(r,i){return Zt(ra(r,i),1)}function CD(r,i){return Zt(ra(r,i),X)}function RD(r,i,a){return a=a===t?1:Me(a),Zt(ra(r,i),a)}function Yp(r,i){var a=Re(r)?Lr:Rn;return a(r,be(i,3))}function Jp(r,i){var a=Re(r)?X3:Wd;return a(r,be(i,3))}var ND=Vo(function(r,i,a){it.call(r,a)?r[a].push(i):dn(r,a,[i])});function LD(r,i,a,h){r=br(r)?r:Mi(r),a=a&&!h?Me(a):0;var g=r.length;return a<0&&(a=Wt(g+a,0)),aa(r)?a<=g&&r.indexOf(i,a)>-1:!!g&&Oi(r,i,a)>-1}var FD=Ke(function(r,i,a){var h=-1,g=typeof i=="function",v=br(r)?z(r.length):[];return Rn(r,function(O){v[++h]=g?kt(i,O,a):Es(O,i,a)}),v}),$D=Vo(function(r,i,a){dn(r,a,i)});function ra(r,i){var a=Re(r)?bt:Qd;return a(r,be(i,3))}function UD(r,i,a,h){return r==null?[]:(Re(i)||(i=i==null?[]:[i]),a=h?t:a,Re(a)||(a=a==null?[]:[a]),np(r,i,a))}var MD=Vo(function(r,i,a){r[a?0:1].push(i)},function(){return[[],[]]});function BD(r,i,a){var h=Re(r)?Qu:Id,g=arguments.length<3;return h(r,be(i,4),a,g,Rn)}function qD(r,i,a){var h=Re(r)?Z3:Id,g=arguments.length<3;return h(r,be(i,4),a,g,Wd)}function HD(r,i){var a=Re(r)?An:Vd;return a(r,sa(be(i,3)))}function jD(r){var i=Re(r)?jd:L6;return i(r)}function zD(r,i,a){(a?lr(r,i,a):i===t)?i=1:i=Me(i);var h=Re(r)?h6:F6;return h(r,i)}function KD(r){var i=Re(r)?l6:U6;return i(r)}function GD(r){if(r==null)return 0;if(br(r))return aa(r)?Ai(r):r.length;var i=rr(r);return i==xe||i==Oe?r.size:vc(r).length}function WD(r,i,a){var h=Re(r)?ec:M6;return a&&lr(r,i,a)&&(i=t),h(r,be(i,3))}var VD=Ke(function(r,i){if(r==null)return[];var a=i.length;return a>1&&lr(r,i[0],i[1])?i=[]:a>2&&lr(i[0],i[1],i[2])&&(i=[i[0]]),np(r,Zt(i,1),[])}),na=I2||function(){return Ze.Date.now()};function kD(r,i){if(typeof i!="function")throw new Fr(f);return r=Me(r),function(){if(--r<1)return i.apply(this,arguments)}}function Xp(r,i,a){return i=a?t:i,i=r&&i==null?r.length:i,pn(r,c,t,t,t,t,i)}function Zp(r,i){var a;if(typeof i!="function")throw new Fr(f);return r=Me(r),function(){return--r>0&&(a=i.apply(this,arguments)),r<=1&&(i=t),a}}var jc=Ke(function(r,i,a){var h=K;if(a.length){var g=Tn(a,$i(jc));h|=P}return pn(r,h,i,a,g)}),Qp=Ke(function(r,i,a){var h=K|se;if(a.length){var g=Tn(a,$i(Qp));h|=P}return pn(i,h,r,a,g)});function eg(r,i,a){i=a?t:i;var h=pn(r,M,t,t,t,t,t,i);return h.placeholder=eg.placeholder,h}function tg(r,i,a){i=a?t:i;var h=pn(r,x,t,t,t,t,t,i);return h.placeholder=tg.placeholder,h}function rg(r,i,a){var h,g,v,O,N,B,Z=0,Q=!1,ne=!1,ce=!0;if(typeof r!="function")throw new Fr(f);i=qr(i)||0,Et(a)&&(Q=!!a.leading,ne="maxWait"in a,v=ne?Wt(qr(a.maxWait)||0,i):v,ce="trailing"in a?!!a.trailing:ce);function ye(Ft){var kr=h,bn=g;return h=g=t,Z=Ft,O=r.apply(bn,kr),O}function Ee(Ft){return Z=Ft,N=Is(Ve,i),Q?ye(Ft):O}function He(Ft){var kr=Ft-B,bn=Ft-Z,mg=i-kr;return ne?tr(mg,v-bn):mg}function Se(Ft){var kr=Ft-B,bn=Ft-Z;return B===t||kr>=i||kr<0||ne&&bn>=v}function Ve(){var Ft=na();if(Se(Ft))return Qe(Ft);N=Is(Ve,He(Ft))}function Qe(Ft){return N=t,ce&&h?ye(Ft):(h=g=t,O)}function Ir(){N!==t&&lp(N),Z=0,h=B=g=N=t}function dr(){return N===t?O:Qe(na())}function Ar(){var Ft=na(),kr=Se(Ft);if(h=arguments,g=this,B=Ft,kr){if(N===t)return Ee(B);if(ne)return lp(N),N=Is(Ve,i),ye(B)}return N===t&&(N=Is(Ve,i)),O}return Ar.cancel=Ir,Ar.flush=dr,Ar}var YD=Ke(function(r,i){return Gd(r,1,i)}),JD=Ke(function(r,i,a){return Gd(r,qr(i)||0,a)});function XD(r){return pn(r,V)}function ia(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new Fr(f);var a=function(){var h=arguments,g=i?i.apply(this,h):h[0],v=a.cache;if(v.has(g))return v.get(g);var O=r.apply(this,h);return a.cache=v.set(g,O)||v,O};return a.cache=new(ia.Cache||ln),a}ia.Cache=ln;function sa(r){if(typeof r!="function")throw new Fr(f);return function(){var i=arguments;switch(i.length){case 0:return!r.call(this);case 1:return!r.call(this,i[0]);case 2:return!r.call(this,i[0],i[1]);case 3:return!r.call(this,i[0],i[1],i[2])}return!r.apply(this,i)}}function ZD(r){return Zp(2,r)}var QD=B6(function(r,i){i=i.length==1&&Re(i[0])?bt(i[0],Dr(be())):bt(Zt(i,1),Dr(be()));var a=i.length;return Ke(function(h){for(var g=-1,v=tr(h.length,a);++g<v;)h[g]=i[g].call(this,h[g]);return kt(r,this,h)})}),zc=Ke(function(r,i){var a=Tn(i,$i(zc));return pn(r,P,t,i,a)}),ng=Ke(function(r,i){var a=Tn(i,$i(ng));return pn(r,m,t,i,a)}),ex=gn(function(r,i){return pn(r,b,t,t,t,i)});function tx(r,i){if(typeof r!="function")throw new Fr(f);return i=i===t?i:Me(i),Ke(r,i)}function rx(r,i){if(typeof r!="function")throw new Fr(f);return i=i==null?0:Wt(Me(i),0),Ke(function(a){var h=a[i],g=Fn(a,0,i);return h&&Pn(g,h),kt(r,this,g)})}function nx(r,i,a){var h=!0,g=!0;if(typeof r!="function")throw new Fr(f);return Et(a)&&(h="leading"in a?!!a.leading:h,g="trailing"in a?!!a.trailing:g),rg(r,i,{leading:h,maxWait:i,trailing:g})}function ix(r){return Xp(r,1)}function sx(r,i){return zc(Ic(i),r)}function ox(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function ax(r){return Ur(r,C)}function ux(r,i){return i=typeof i=="function"?i:t,Ur(r,C,i)}function cx(r){return Ur(r,T|C)}function fx(r,i){return i=typeof i=="function"?i:t,Ur(r,T|C,i)}function hx(r,i){return i==null||Kd(r,i,Yt(i))}function Vr(r,i){return r===i||r!==r&&i!==i}var lx=Xo(gc),dx=Xo(function(r,i){return r>=i}),ui=Jd(function(){return arguments}())?Jd:function(r){return Tt(r)&&it.call(r,"callee")&&!$d.call(r,"callee")},Re=z.isArray,px=fr?Dr(fr):E6;function br(r){return r!=null&&oa(r.length)&&!yn(r)}function Lt(r){return Tt(r)&&br(r)}function gx(r){return r===!0||r===!1||Tt(r)&&hr(r)==q}var $n=P2||ef,_x=Kr?Dr(Kr):S6;function yx(r){return Tt(r)&&r.nodeType===1&&!As(r)}function vx(r){if(r==null)return!0;if(br(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||$n(r)||Ui(r)||ui(r)))return!r.length;var i=rr(r);if(i==xe||i==Oe)return!r.size;if(Os(r))return!vc(r).length;for(var a in r)if(it.call(r,a))return!1;return!0}function bx(r,i){return Ss(r,i)}function wx(r,i,a){a=typeof a=="function"?a:t;var h=a?a(r,i):t;return h===t?Ss(r,i,t,a):!!h}function Kc(r){if(!Tt(r))return!1;var i=hr(r);return i==A||i==d||typeof r.message=="string"&&typeof r.name=="string"&&!As(r)}function mx(r){return typeof r=="number"&&Md(r)}function yn(r){if(!Et(r))return!1;var i=hr(r);return i==ae||i==le||i==H||i==_t}function ig(r){return typeof r=="number"&&r==Me(r)}function oa(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=G}function Et(r){var i=typeof r;return r!=null&&(i=="object"||i=="function")}function Tt(r){return r!=null&&typeof r=="object"}var sg=Nr?Dr(Nr):x6;function Ex(r,i){return r===i||yc(r,i,Lc(i))}function Sx(r,i,a){return a=typeof a=="function"?a:t,yc(r,i,Lc(i),a)}function Dx(r){return og(r)&&r!=+r}function xx(r){if(uS(r))throw new Te(u);return Xd(r)}function Ox(r){return r===null}function Ix(r){return r==null}function og(r){return typeof r=="number"||Tt(r)&&hr(r)==je}function As(r){if(!Tt(r)||hr(r)!=Ue)return!1;var i=No(r);if(i===null)return!0;var a=it.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Po.call(a)==S2}var Gc=en?Dr(en):O6;function Ax(r){return ig(r)&&r>=-G&&r<=G}var ag=ds?Dr(ds):I6;function aa(r){return typeof r=="string"||!Re(r)&&Tt(r)&&hr(r)==Le}function Or(r){return typeof r=="symbol"||Tt(r)&&hr(r)==Fe}var Ui=ei?Dr(ei):A6;function Px(r){return r===t}function Tx(r){return Tt(r)&&rr(r)==Ae}function Cx(r){return Tt(r)&&hr(r)==$e}var Rx=Xo(bc),Nx=Xo(function(r,i){return r<=i});function ug(r){if(!r)return[];if(br(r))return aa(r)?Gr(r):vr(r);if(gs&&r[gs])return h2(r[gs]());var i=rr(r),a=i==xe?oc:i==Oe?Oo:Mi;return a(r)}function vn(r){if(!r)return r===0?r:0;if(r=qr(r),r===X||r===-X){var i=r<0?-1:1;return i*W}return r===r?r:0}function Me(r){var i=vn(r),a=i%1;return i===i?a?i-a:i:0}function cg(r){return r?ii(Me(r),0,re):0}function qr(r){if(typeof r=="number")return r;if(Or(r))return J;if(Et(r)){var i=typeof r.valueOf=="function"?r.valueOf():r;r=Et(i)?i+"":i}if(typeof r!="string")return r===0?r:+r;r=Ad(r);var a=Fu.test(r);return a||Uu.test(r)?Ce(r.slice(2),a?2:8):Lu.test(r)?J:+r}function fg(r){return rn(r,wr(r))}function Lx(r){return r?ii(Me(r),-G,G):r===0?r:0}function nt(r){return r==null?"":xr(r)}var Fx=Li(function(r,i){if(Os(i)||br(i)){rn(i,Yt(i),r);return}for(var a in i)it.call(i,a)&&ws(r,a,i[a])}),hg=Li(function(r,i){rn(i,wr(i),r)}),ua=Li(function(r,i,a,h){rn(i,wr(i),r,h)}),$x=Li(function(r,i,a,h){rn(i,Yt(i),r,h)}),Ux=gn(lc);function Mx(r,i){var a=Ni(r);return i==null?a:zd(a,i)}var Bx=Ke(function(r,i){r=ft(r);var a=-1,h=i.length,g=h>2?i[2]:t;for(g&&lr(i[0],i[1],g)&&(h=1);++a<h;)for(var v=i[a],O=wr(v),N=-1,B=O.length;++N<B;){var Z=O[N],Q=r[Z];(Q===t||Vr(Q,Ti[Z])&&!it.call(r,Z))&&(r[Z]=v[Z])}return r}),qx=Ke(function(r){return r.push(t,Ap),kt(lg,t,r)});function Hx(r,i){return Dd(r,be(i,3),tn)}function jx(r,i){return Dd(r,be(i,3),pc)}function zx(r,i){return r==null?r:dc(r,be(i,3),wr)}function Kx(r,i){return r==null?r:kd(r,be(i,3),wr)}function Gx(r,i){return r&&tn(r,be(i,3))}function Wx(r,i){return r&&pc(r,be(i,3))}function Vx(r){return r==null?[]:zo(r,Yt(r))}function kx(r){return r==null?[]:zo(r,wr(r))}function Wc(r,i,a){var h=r==null?t:si(r,i);return h===t?a:h}function Yx(r,i){return r!=null&&Cp(r,i,v6)}function Vc(r,i){return r!=null&&Cp(r,i,b6)}var Jx=Sp(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=To.call(i)),r[i]=a},Yc(mr)),Xx=Sp(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=To.call(i)),it.call(r,i)?r[i].push(a):r[i]=[a]},be),Zx=Ke(Es);function Yt(r){return br(r)?Hd(r):vc(r)}function wr(r){return br(r)?Hd(r,!0):P6(r)}function Qx(r,i){var a={};return i=be(i,3),tn(r,function(h,g,v){dn(a,i(h,g,v),h)}),a}function e5(r,i){var a={};return i=be(i,3),tn(r,function(h,g,v){dn(a,g,i(h,g,v))}),a}var t5=Li(function(r,i,a){Ko(r,i,a)}),lg=Li(function(r,i,a,h){Ko(r,i,a,h)}),r5=gn(function(r,i){var a={};if(r==null)return a;var h=!1;i=bt(i,function(v){return v=Ln(v,r),h||(h=v.length>1),v}),rn(r,Rc(r),a),h&&(a=Ur(a,T|D|C,J6));for(var g=i.length;g--;)Dc(a,i[g]);return a});function n5(r,i){return dg(r,sa(be(i)))}var i5=gn(function(r,i){return r==null?{}:C6(r,i)});function dg(r,i){if(r==null)return{};var a=bt(Rc(r),function(h){return[h]});return i=be(i),ip(r,a,function(h,g){return i(h,g[0])})}function s5(r,i,a){i=Ln(i,r);var h=-1,g=i.length;for(g||(g=1,r=t);++h<g;){var v=r==null?t:r[nn(i[h])];v===t&&(h=g,v=a),r=yn(v)?v.call(r):v}return r}function o5(r,i,a){return r==null?r:Ds(r,i,a)}function a5(r,i,a,h){return h=typeof h=="function"?h:t,r==null?r:Ds(r,i,a,h)}var pg=Op(Yt),gg=Op(wr);function u5(r,i,a){var h=Re(r),g=h||$n(r)||Ui(r);if(i=be(i,4),a==null){var v=r&&r.constructor;g?a=h?new v:[]:Et(r)?a=yn(v)?Ni(No(r)):{}:a={}}return(g?Lr:tn)(r,function(O,N,B){return i(a,O,N,B)}),a}function c5(r,i){return r==null?!0:Dc(r,i)}function f5(r,i,a){return r==null?r:cp(r,i,Ic(a))}function h5(r,i,a,h){return h=typeof h=="function"?h:t,r==null?r:cp(r,i,Ic(a),h)}function Mi(r){return r==null?[]:sc(r,Yt(r))}function l5(r){return r==null?[]:sc(r,wr(r))}function d5(r,i,a){return a===t&&(a=i,i=t),a!==t&&(a=qr(a),a=a===a?a:0),i!==t&&(i=qr(i),i=i===i?i:0),ii(qr(r),i,a)}function p5(r,i,a){return i=vn(i),a===t?(a=i,i=0):a=vn(a),r=qr(r),w6(r,i,a)}function g5(r,i,a){if(a&&typeof a!="boolean"&&lr(r,i,a)&&(i=a=t),a===t&&(typeof i=="boolean"?(a=i,i=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&i===t?(r=0,i=1):(r=vn(r),i===t?(i=r,r=0):i=vn(i)),r>i){var h=r;r=i,i=h}if(a||r%1||i%1){var g=Bd();return tr(r+g*(i-r+ut("1e-"+((g+"").length-1))),i)}return mc(r,i)}var _5=Fi(function(r,i,a){return i=i.toLowerCase(),r+(a?_g(i):i)});function _g(r){return kc(nt(r).toLowerCase())}function yg(r){return r=nt(r),r&&r.replace(cn,o2).replace(Ju,"")}function y5(r,i,a){r=nt(r),i=xr(i);var h=r.length;a=a===t?h:ii(Me(a),0,h);var g=a;return a-=i.length,a>=0&&r.slice(a,g)==i}function v5(r){return r=nt(r),r&&yt.test(r)?r.replace(Yn,a2):r}function b5(r){return r=nt(r),r&&qt.test(r)?r.replace(It,"\\$&"):r}var w5=Fi(function(r,i,a){return r+(a?"-":"")+i.toLowerCase()}),m5=Fi(function(r,i,a){return r+(a?" ":"")+i.toLowerCase()}),E5=wp("toLowerCase");function S5(r,i,a){r=nt(r),i=Me(i);var h=i?Ai(r):0;if(!i||h>=i)return r;var g=(i-h)/2;return Jo(Uo(g),a)+r+Jo($o(g),a)}function D5(r,i,a){r=nt(r),i=Me(i);var h=i?Ai(r):0;return i&&h<i?r+Jo(i-h,a):r}function x5(r,i,a){r=nt(r),i=Me(i);var h=i?Ai(r):0;return i&&h<i?Jo(i-h,a)+r:r}function O5(r,i,a){return a||i==null?i=0:i&&(i=+i),N2(nt(r).replace(At,""),i||0)}function I5(r,i,a){return(a?lr(r,i,a):i===t)?i=1:i=Me(i),Ec(nt(r),i)}function A5(){var r=arguments,i=nt(r[0]);return r.length<3?i:i.replace(r[1],r[2])}var P5=Fi(function(r,i,a){return r+(a?"_":"")+i.toLowerCase()});function T5(r,i,a){return a&&typeof a!="number"&&lr(r,i,a)&&(i=a=t),a=a===t?re:a>>>0,a?(r=nt(r),r&&(typeof i=="string"||i!=null&&!Gc(i))&&(i=xr(i),!i&&Ii(r))?Fn(Gr(r),0,a):r.split(i,a)):[]}var C5=Fi(function(r,i,a){return r+(a?" ":"")+kc(i)});function R5(r,i,a){return r=nt(r),a=a==null?0:ii(Me(a),0,r.length),i=xr(i),r.slice(a,a+i.length)==i}function N5(r,i,a){var h=y.templateSettings;a&&lr(r,i,a)&&(i=t),r=nt(r),i=ua({},i,h,Ip);var g=ua({},i.imports,h.imports,Ip),v=Yt(g),O=sc(g,v),N,B,Z=0,Q=i.interpolate||bi,ne="__p += '",ce=ac((i.escape||bi).source+"|"+Q.source+"|"+(Q===mt?Nu:bi).source+"|"+(i.evaluate||bi).source+"|$","g"),ye="//# sourceURL="+(it.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xu+"]")+`
`;r.replace(ce,function(Se,Ve,Qe,Ir,dr,Ar){return Qe||(Qe=Ir),ne+=r.slice(Z,Ar).replace(Bu,u2),Ve&&(N=!0,ne+=`' +
__e(`+Ve+`) +
'`),dr&&(B=!0,ne+=`';
`+dr+`;
__p += '`),Qe&&(ne+=`' +
((__t = (`+Qe+`)) == null ? '' : __t) +
'`),Z=Ar+Se.length,Se}),ne+=`';
`;var Ee=it.call(i,"variable")&&i.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(Cu.test(Ee))throw new Te(l);ne=(B?ne.replace(Zr,""):ne).replace(cr,"$1").replace(un,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(B?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var He=bg(function(){return rt(v,ye+"return "+ne).apply(t,O)});if(He.source=ne,Kc(He))throw He;return He}function L5(r){return nt(r).toLowerCase()}function F5(r){return nt(r).toUpperCase()}function $5(r,i,a){if(r=nt(r),r&&(a||i===t))return Ad(r);if(!r||!(i=xr(i)))return r;var h=Gr(r),g=Gr(i),v=Pd(h,g),O=Td(h,g)+1;return Fn(h,v,O).join("")}function U5(r,i,a){if(r=nt(r),r&&(a||i===t))return r.slice(0,Rd(r)+1);if(!r||!(i=xr(i)))return r;var h=Gr(r),g=Td(h,Gr(i))+1;return Fn(h,0,g).join("")}function M5(r,i,a){if(r=nt(r),r&&(a||i===t))return r.replace(At,"");if(!r||!(i=xr(i)))return r;var h=Gr(r),g=Pd(h,Gr(i));return Fn(h,g).join("")}function B5(r,i){var a=Y,h=ie;if(Et(i)){var g="separator"in i?i.separator:g;a="length"in i?Me(i.length):a,h="omission"in i?xr(i.omission):h}r=nt(r);var v=r.length;if(Ii(r)){var O=Gr(r);v=O.length}if(a>=v)return r;var N=a-Ai(h);if(N<1)return h;var B=O?Fn(O,0,N).join(""):r.slice(0,N);if(g===t)return B+h;if(O&&(N+=B.length-N),Gc(g)){if(r.slice(N).search(g)){var Z,Q=B;for(g.global||(g=ac(g.source,nt(Rr.exec(g))+"g")),g.lastIndex=0;Z=g.exec(Q);)var ne=Z.index;B=B.slice(0,ne===t?N:ne)}}else if(r.indexOf(xr(g),N)!=N){var ce=B.lastIndexOf(g);ce>-1&&(B=B.slice(0,ce))}return B+h}function q5(r){return r=nt(r),r&&Dt.test(r)?r.replace(On,g2):r}var H5=Fi(function(r,i,a){return r+(a?" ":"")+i.toUpperCase()}),kc=wp("toUpperCase");function vg(r,i,a){return r=nt(r),i=a?t:i,i===t?f2(r)?v2(r):t2(r):r.match(i)||[]}var bg=Ke(function(r,i){try{return kt(r,t,i)}catch(a){return Kc(a)?a:new Te(a)}}),j5=gn(function(r,i){return Lr(i,function(a){a=nn(a),dn(r,a,jc(r[a],r))}),r});function z5(r){var i=r==null?0:r.length,a=be();return r=i?bt(r,function(h){if(typeof h[1]!="function")throw new Fr(f);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var g=-1;++g<i;){var v=r[g];if(kt(v[0],this,h))return kt(v[1],this,h)}})}function K5(r){return g6(Ur(r,T))}function Yc(r){return function(){return r}}function G5(r,i){return r==null||r!==r?i:r}var W5=Ep(),V5=Ep(!0);function mr(r){return r}function Jc(r){return Zd(typeof r=="function"?r:Ur(r,T))}function k5(r){return ep(Ur(r,T))}function Y5(r,i){return tp(r,Ur(i,T))}var J5=Ke(function(r,i){return function(a){return Es(a,r,i)}}),X5=Ke(function(r,i){return function(a){return Es(r,a,i)}});function Xc(r,i,a){var h=Yt(i),g=zo(i,h);a==null&&!(Et(i)&&(g.length||!h.length))&&(a=i,i=r,r=this,g=zo(i,Yt(i)));var v=!(Et(a)&&"chain"in a)||!!a.chain,O=yn(r);return Lr(g,function(N){var B=i[N];r[N]=B,O&&(r.prototype[N]=function(){var Z=this.__chain__;if(v||Z){var Q=r(this.__wrapped__),ne=Q.__actions__=vr(this.__actions__);return ne.push({func:B,args:arguments,thisArg:r}),Q.__chain__=Z,Q}return B.apply(r,Pn([this.value()],arguments))})}),r}function Z5(){return Ze._===this&&(Ze._=D2),this}function Zc(){}function Q5(r){return r=Me(r),Ke(function(i){return rp(i,r)})}var eO=Pc(bt),tO=Pc(Sd),rO=Pc(ec);function wg(r){return $c(r)?tc(nn(r)):R6(r)}function nO(r){return function(i){return r==null?t:si(r,i)}}var iO=Dp(),sO=Dp(!0);function Qc(){return[]}function ef(){return!1}function oO(){return{}}function aO(){return""}function uO(){return!0}function cO(r,i){if(r=Me(r),r<1||r>G)return[];var a=re,h=tr(r,re);i=be(i),r-=re;for(var g=ic(h,i);++a<r;)i(a);return g}function fO(r){return Re(r)?bt(r,nn):Or(r)?[r]:vr(qp(nt(r)))}function hO(r){var i=++E2;return nt(r)+i}var lO=Yo(function(r,i){return r+i},0),dO=Tc("ceil"),pO=Yo(function(r,i){return r/i},1),gO=Tc("floor");function _O(r){return r&&r.length?jo(r,mr,gc):t}function yO(r,i){return r&&r.length?jo(r,be(i,2),gc):t}function vO(r){return Od(r,mr)}function bO(r,i){return Od(r,be(i,2))}function wO(r){return r&&r.length?jo(r,mr,bc):t}function mO(r,i){return r&&r.length?jo(r,be(i,2),bc):t}var EO=Yo(function(r,i){return r*i},1),SO=Tc("round"),DO=Yo(function(r,i){return r-i},0);function xO(r){return r&&r.length?nc(r,mr):0}function OO(r,i){return r&&r.length?nc(r,be(i,2)):0}return y.after=kD,y.ary=Xp,y.assign=Fx,y.assignIn=hg,y.assignInWith=ua,y.assignWith=$x,y.at=Ux,y.before=Zp,y.bind=jc,y.bindAll=j5,y.bindKey=Qp,y.castArray=ox,y.chain=kp,y.chunk=gS,y.compact=_S,y.concat=yS,y.cond=z5,y.conforms=K5,y.constant=Yc,y.countBy=xD,y.create=Mx,y.curry=eg,y.curryRight=tg,y.debounce=rg,y.defaults=Bx,y.defaultsDeep=qx,y.defer=YD,y.delay=JD,y.difference=vS,y.differenceBy=bS,y.differenceWith=wS,y.drop=mS,y.dropRight=ES,y.dropRightWhile=SS,y.dropWhile=DS,y.fill=xS,y.filter=ID,y.flatMap=TD,y.flatMapDeep=CD,y.flatMapDepth=RD,y.flatten=Kp,y.flattenDeep=OS,y.flattenDepth=IS,y.flip=XD,y.flow=W5,y.flowRight=V5,y.fromPairs=AS,y.functions=Vx,y.functionsIn=kx,y.groupBy=ND,y.initial=TS,y.intersection=CS,y.intersectionBy=RS,y.intersectionWith=NS,y.invert=Jx,y.invertBy=Xx,y.invokeMap=FD,y.iteratee=Jc,y.keyBy=$D,y.keys=Yt,y.keysIn=wr,y.map=ra,y.mapKeys=Qx,y.mapValues=e5,y.matches=k5,y.matchesProperty=Y5,y.memoize=ia,y.merge=t5,y.mergeWith=lg,y.method=J5,y.methodOf=X5,y.mixin=Xc,y.negate=sa,y.nthArg=Q5,y.omit=r5,y.omitBy=n5,y.once=ZD,y.orderBy=UD,y.over=eO,y.overArgs=QD,y.overEvery=tO,y.overSome=rO,y.partial=zc,y.partialRight=ng,y.partition=MD,y.pick=i5,y.pickBy=dg,y.property=wg,y.propertyOf=nO,y.pull=US,y.pullAll=Wp,y.pullAllBy=MS,y.pullAllWith=BS,y.pullAt=qS,y.range=iO,y.rangeRight=sO,y.rearg=ex,y.reject=HD,y.remove=HS,y.rest=tx,y.reverse=qc,y.sampleSize=zD,y.set=o5,y.setWith=a5,y.shuffle=KD,y.slice=jS,y.sortBy=VD,y.sortedUniq=YS,y.sortedUniqBy=JS,y.split=T5,y.spread=rx,y.tail=XS,y.take=ZS,y.takeRight=QS,y.takeRightWhile=eD,y.takeWhile=tD,y.tap=_D,y.throttle=nx,y.thru=ta,y.toArray=ug,y.toPairs=pg,y.toPairsIn=gg,y.toPath=fO,y.toPlainObject=fg,y.transform=u5,y.unary=ix,y.union=rD,y.unionBy=nD,y.unionWith=iD,y.uniq=sD,y.uniqBy=oD,y.uniqWith=aD,y.unset=c5,y.unzip=Hc,y.unzipWith=Vp,y.update=f5,y.updateWith=h5,y.values=Mi,y.valuesIn=l5,y.without=uD,y.words=vg,y.wrap=sx,y.xor=cD,y.xorBy=fD,y.xorWith=hD,y.zip=lD,y.zipObject=dD,y.zipObjectDeep=pD,y.zipWith=gD,y.entries=pg,y.entriesIn=gg,y.extend=hg,y.extendWith=ua,Xc(y,y),y.add=lO,y.attempt=bg,y.camelCase=_5,y.capitalize=_g,y.ceil=dO,y.clamp=d5,y.clone=ax,y.cloneDeep=cx,y.cloneDeepWith=fx,y.cloneWith=ux,y.conformsTo=hx,y.deburr=yg,y.defaultTo=G5,y.divide=pO,y.endsWith=y5,y.eq=Vr,y.escape=v5,y.escapeRegExp=b5,y.every=OD,y.find=AD,y.findIndex=jp,y.findKey=Hx,y.findLast=PD,y.findLastIndex=zp,y.findLastKey=jx,y.floor=gO,y.forEach=Yp,y.forEachRight=Jp,y.forIn=zx,y.forInRight=Kx,y.forOwn=Gx,y.forOwnRight=Wx,y.get=Wc,y.gt=lx,y.gte=dx,y.has=Yx,y.hasIn=Vc,y.head=Gp,y.identity=mr,y.includes=LD,y.indexOf=PS,y.inRange=p5,y.invoke=Zx,y.isArguments=ui,y.isArray=Re,y.isArrayBuffer=px,y.isArrayLike=br,y.isArrayLikeObject=Lt,y.isBoolean=gx,y.isBuffer=$n,y.isDate=_x,y.isElement=yx,y.isEmpty=vx,y.isEqual=bx,y.isEqualWith=wx,y.isError=Kc,y.isFinite=mx,y.isFunction=yn,y.isInteger=ig,y.isLength=oa,y.isMap=sg,y.isMatch=Ex,y.isMatchWith=Sx,y.isNaN=Dx,y.isNative=xx,y.isNil=Ix,y.isNull=Ox,y.isNumber=og,y.isObject=Et,y.isObjectLike=Tt,y.isPlainObject=As,y.isRegExp=Gc,y.isSafeInteger=Ax,y.isSet=ag,y.isString=aa,y.isSymbol=Or,y.isTypedArray=Ui,y.isUndefined=Px,y.isWeakMap=Tx,y.isWeakSet=Cx,y.join=LS,y.kebabCase=w5,y.last=Br,y.lastIndexOf=FS,y.lowerCase=m5,y.lowerFirst=E5,y.lt=Rx,y.lte=Nx,y.max=_O,y.maxBy=yO,y.mean=vO,y.meanBy=bO,y.min=wO,y.minBy=mO,y.stubArray=Qc,y.stubFalse=ef,y.stubObject=oO,y.stubString=aO,y.stubTrue=uO,y.multiply=EO,y.nth=$S,y.noConflict=Z5,y.noop=Zc,y.now=na,y.pad=S5,y.padEnd=D5,y.padStart=x5,y.parseInt=O5,y.random=g5,y.reduce=BD,y.reduceRight=qD,y.repeat=I5,y.replace=A5,y.result=s5,y.round=SO,y.runInContext=$,y.sample=jD,y.size=GD,y.snakeCase=P5,y.some=WD,y.sortedIndex=zS,y.sortedIndexBy=KS,y.sortedIndexOf=GS,y.sortedLastIndex=WS,y.sortedLastIndexBy=VS,y.sortedLastIndexOf=kS,y.startCase=C5,y.startsWith=R5,y.subtract=DO,y.sum=xO,y.sumBy=OO,y.template=N5,y.times=cO,y.toFinite=vn,y.toInteger=Me,y.toLength=cg,y.toLower=L5,y.toNumber=qr,y.toSafeInteger=Lx,y.toString=nt,y.toUpper=F5,y.trim=$5,y.trimEnd=U5,y.trimStart=M5,y.truncate=B5,y.unescape=q5,y.uniqueId=hO,y.upperCase=H5,y.upperFirst=kc,y.each=Yp,y.eachRight=Jp,y.first=Gp,Xc(y,function(){var r={};return tn(y,function(i,a){it.call(y.prototype,a)||(r[a]=i)}),r}(),{chain:!1}),y.VERSION=s,Lr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){y[r].placeholder=y}),Lr(["drop","take"],function(r,i){Ye.prototype[r]=function(a){a=a===t?1:Wt(Me(a),0);var h=this.__filtered__&&!i?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=tr(a,h.__takeCount__):h.__views__.push({size:tr(a,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Lr(["filter","map","takeWhile"],function(r,i){var a=i+1,h=a==w||a==ee;Ye.prototype[r]=function(g){var v=this.clone();return v.__iteratees__.push({iteratee:be(g,3),type:a}),v.__filtered__=v.__filtered__||h,v}}),Lr(["head","last"],function(r,i){var a="take"+(i?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Lr(["initial","tail"],function(r,i){var a="drop"+(i?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(mr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,i){return typeof r=="function"?new Ye(this):this.map(function(a){return Es(a,r,i)})}),Ye.prototype.reject=function(r){return this.filter(sa(be(r)))},Ye.prototype.slice=function(r,i){r=Me(r);var a=this;return a.__filtered__&&(r>0||i<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),i!==t&&(i=Me(i),a=i<0?a.dropRight(-i):a.take(i-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},tn(Ye.prototype,function(r,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),h=/^(?:head|last)$/.test(i),g=y[h?"take"+(i=="last"?"Right":""):i],v=h||/^find/.test(i);g&&(y.prototype[i]=function(){var O=this.__wrapped__,N=h?[1]:arguments,B=O instanceof Ye,Z=N[0],Q=B||Re(O),ne=function(Ve){var Qe=g.apply(y,Pn([Ve],N));return h&&ce?Qe[0]:Qe};Q&&a&&typeof Z=="function"&&Z.length!=1&&(B=Q=!1);var ce=this.__chain__,ye=!!this.__actions__.length,Ee=v&&!ce,He=B&&!ye;if(!v&&Q){O=He?O:new Ye(this);var Se=r.apply(O,N);return Se.__actions__.push({func:ta,args:[ne],thisArg:t}),new $r(Se,ce)}return Ee&&He?r.apply(this,N):(Se=this.thru(ne),Ee?h?Se.value()[0]:Se.value():Se)})}),Lr(["pop","push","shift","sort","splice","unshift"],function(r){var i=Io[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);y.prototype[r]=function(){var g=arguments;if(h&&!this.__chain__){var v=this.value();return i.apply(Re(v)?v:[],g)}return this[a](function(O){return i.apply(Re(O)?O:[],g)})}}),tn(Ye.prototype,function(r,i){var a=y[i];if(a){var h=a.name+"";it.call(Ri,h)||(Ri[h]=[]),Ri[h].push({name:i,func:a})}}),Ri[ko(t,se).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=q2,Ye.prototype.reverse=H2,Ye.prototype.value=j2,y.prototype.at=yD,y.prototype.chain=vD,y.prototype.commit=bD,y.prototype.next=wD,y.prototype.plant=ED,y.prototype.reverse=SD,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=DD,y.prototype.first=y.prototype.head,gs&&(y.prototype[gs]=mD),y},Pi=b2();Nt?((Nt.exports=Pi)._=Pi,ct._=Pi):Ze._=Pi}).call(wt)})(Ou,Ou.exports);var I3=Object.defineProperty,A3=Object.defineProperties,P3=Object.getOwnPropertyDescriptors,dd=Object.getOwnPropertySymbols,T3=Object.prototype.hasOwnProperty,C3=Object.prototype.propertyIsEnumerable,pd=(n,e,t)=>e in n?I3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,to=(n,e)=>{for(var t in e||(e={}))T3.call(e,t)&&pd(n,t,e[t]);if(dd)for(var t of dd(e))C3.call(e,t)&&pd(n,t,e[t]);return n},R3=(n,e)=>A3(n,P3(e));function Cr(n,e,t){let s;const o=Iu(n);return e.rpcMap&&(s=e.rpcMap[o]),s||(s=`${O3}?chainId=eip155:${o}&projectId=${t}`),s}function Iu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function gd(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function N3(n,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(n));if(!t.length)return[];const s=[];return t.forEach(o=>{const u=e.namespaces[o].accounts;s.push(...u)}),s}function L3(n={},e={}){const t=_d(n),s=_d(e);return Ou.exports.merge(t,s)}function _d(n){var e,t,s,o;const u={};if(!vi(n))return u;for(const[f,l]of Object.entries(n)){const _=iu(f)?[f]:l.chains,p=l.methods||[],E=l.events||[],T=l.rpcMap||{},D=Ws(f);u[D]=R3(to(to({},u[D]),l),{chains:ru(_,(e=u[D])==null?void 0:e.chains),methods:ru(p,(t=u[D])==null?void 0:t.methods),events:ru(E,(s=u[D])==null?void 0:s.events),rpcMap:to(to({},T),(o=u[D])==null?void 0:o.rpcMap)})}return u}function F3(n){return n.includes(":")?n.split(":")[2]:n}function $3(n){const e={};for(const[t,s]of Object.entries(n)){const o=s.methods||[],u=s.events||[],f=s.accounts||[],l=iu(t)?[t]:s.chains?s.chains:gd(s.accounts);e[t]={chains:l,methods:o,events:u,accounts:f}}return e}const yd={},Ct=n=>yd[n],Au=(n,e)=>{yd[n]=e};var Pu={exports:{}};(function(n,e){var t=typeof self<"u"?self:wt,s=function(){function u(){this.fetch=!1,this.DOMException=t.DOMException}return u.prototype=t,new u}();(function(u){(function(f){var l={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function _(w){return w&&DataView.prototype.isPrototypeOf(w)}if(l.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(w){return w&&p.indexOf(Object.prototype.toString.call(w))>-1};function T(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(w))throw new TypeError("Invalid character in header field name");return w.toLowerCase()}function D(w){return typeof w!="string"&&(w=String(w)),w}function C(w){var I={next:function(){var ee=w.shift();return{done:ee===void 0,value:ee}}};return l.iterable&&(I[Symbol.iterator]=function(){return I}),I}function R(w){this.map={},w instanceof R?w.forEach(function(I,ee){this.append(ee,I)},this):Array.isArray(w)?w.forEach(function(I){this.append(I[0],I[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(I){this.append(I,w[I])},this)}R.prototype.append=function(w,I){w=T(w),I=D(I);var ee=this.map[w];this.map[w]=ee?ee+", "+I:I},R.prototype.delete=function(w){delete this.map[T(w)]},R.prototype.get=function(w){return w=T(w),this.has(w)?this.map[w]:null},R.prototype.has=function(w){return this.map.hasOwnProperty(T(w))},R.prototype.set=function(w,I){this.map[T(w)]=D(I)},R.prototype.forEach=function(w,I){for(var ee in this.map)this.map.hasOwnProperty(ee)&&w.call(I,this.map[ee],ee,this)},R.prototype.keys=function(){var w=[];return this.forEach(function(I,ee){w.push(ee)}),C(w)},R.prototype.values=function(){var w=[];return this.forEach(function(I){w.push(I)}),C(w)},R.prototype.entries=function(){var w=[];return this.forEach(function(I,ee){w.push([ee,I])}),C(w)},l.iterable&&(R.prototype[Symbol.iterator]=R.prototype.entries);function j(w){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}function K(w){return new Promise(function(I,ee){w.onload=function(){I(w.result)},w.onerror=function(){ee(w.error)}})}function se(w){var I=new FileReader,ee=K(I);return I.readAsArrayBuffer(w),ee}function L(w){var I=new FileReader,ee=K(I);return I.readAsText(w),ee}function M(w){for(var I=new Uint8Array(w),ee=new Array(I.length),X=0;X<I.length;X++)ee[X]=String.fromCharCode(I[X]);return ee.join("")}function x(w){if(w.slice)return w.slice(0);var I=new Uint8Array(w.byteLength);return I.set(new Uint8Array(w)),I.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(w){this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:l.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:l.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():l.arrayBuffer&&l.blob&&_(w)?(this._bodyArrayBuffer=x(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||E(w))?this._bodyArrayBuffer=x(w):this._bodyText=w=Object.prototype.toString.call(w):this._bodyText="",this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var w=j(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?j(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(se)}),this.text=function(){var w=j(this);if(w)return w;if(this._bodyBlob)return L(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(M(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(w){var I=w.toUpperCase();return m.indexOf(I)>-1?I:w}function b(w,I){I=I||{};var ee=I.body;if(w instanceof b){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,I.headers||(this.headers=new R(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!ee&&w._bodyInit!=null&&(ee=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new R(I.headers)),this.method=c(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function V(w){var I=new FormData;return w.trim().split("&").forEach(function(ee){if(ee){var X=ee.split("="),G=X.shift().replace(/\+/g," "),W=X.join("=").replace(/\+/g," ");I.append(decodeURIComponent(G),decodeURIComponent(W))}}),I}function Y(w){var I=new R,ee=w.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(X){var G=X.split(":"),W=G.shift().trim();if(W){var J=G.join(":").trim();I.append(W,J)}}),I}P.call(b.prototype);function ie(w,I){I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in I?I.statusText:"OK",this.headers=new R(I.headers),this.url=I.url||"",this._initBody(w)}P.call(ie.prototype),ie.prototype.clone=function(){return new ie(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new R(this.headers),url:this.url})},ie.error=function(){var w=new ie(null,{status:0,statusText:""});return w.type="error",w};var ue=[301,302,303,307,308];ie.redirect=function(w,I){if(ue.indexOf(I)===-1)throw new RangeError("Invalid status code");return new ie(null,{status:I,headers:{location:w}})},f.DOMException=u.DOMException;try{new f.DOMException}catch{f.DOMException=function(I,ee){this.message=I,this.name=ee;var X=Error(I);this.stack=X.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function de(w,I){return new Promise(function(ee,X){var G=new b(w,I);if(G.signal&&G.signal.aborted)return X(new f.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function J(){W.abort()}W.onload=function(){var re={status:W.status,statusText:W.statusText,headers:Y(W.getAllResponseHeaders()||"")};re.url="responseURL"in W?W.responseURL:re.headers.get("X-Request-URL");var we="response"in W?W.response:W.responseText;ee(new ie(we,re))},W.onerror=function(){X(new TypeError("Network request failed"))},W.ontimeout=function(){X(new TypeError("Network request failed"))},W.onabort=function(){X(new f.DOMException("Aborted","AbortError"))},W.open(G.method,G.url,!0),G.credentials==="include"?W.withCredentials=!0:G.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&l.blob&&(W.responseType="blob"),G.headers.forEach(function(re,we){W.setRequestHeader(we,re)}),G.signal&&(G.signal.addEventListener("abort",J),W.onreadystatechange=function(){W.readyState===4&&G.signal.removeEventListener("abort",J)}),W.send(typeof G._bodyInit>"u"?null:G._bodyInit)})}return de.polyfill=!0,u.fetch||(u.fetch=de,u.Headers=R,u.Request=b,u.Response=ie),f.Headers=R,f.Request=b,f.Response=ie,f.fetch=de,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,n.exports=e})(Pu,Pu.exports);var vd=Eg(Pu.exports);const bd={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},wd=10;class kn{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Qt.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!vl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=Xi(e),u=await(await vd(this.url,Object.assign(Object.assign({},bd),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!vl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Xi({id:1,jsonrpc:"2.0",method:"test",params:[]});await vd(e,Object.assign(Object.assign({},bd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ta(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),u=Js(e,o);this.events.emit("payload",u)}parseError(e,t=this.url){return hl(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>wd&&this.events.setMaxListeners(wd)}}class U3{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Cr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(xn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cr(e,this.namespace);return typeof s>"u"?void 0:new Sn(new kn(s,Ct("disableProviderPing")))}}class M3{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=Iu(e);if(!this.httpProviders[s]){const o=t||Cr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(xn.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Cr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Sn(new kn(s,Ct("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Iu(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const u=parseInt(o,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class B3{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Cr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(xn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Sn(new kn(s,Ct("disableProviderPing")))}}class q3{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Cr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(xn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Sn(new kn(s,Ct("disableProviderPing")))}}class H3{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(xn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new Sn(new kn(s,Ct("disableProviderPing")))}}class j3{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Cr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(xn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Sn(new kn(s,Ct("disableProviderPing")))}}class z3{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Cr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(xn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Cr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Sn(new kn(s,Ct("disableProviderPing")))}}var K3=Object.defineProperty,G3=Object.defineProperties,W3=Object.getOwnPropertyDescriptors,md=Object.getOwnPropertySymbols,V3=Object.prototype.hasOwnProperty,k3=Object.prototype.propertyIsEnumerable,Ed=(n,e,t)=>e in n?K3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ro=(n,e)=>{for(var t in e||(e={}))V3.call(e,t)&&Ed(n,t,e[t]);if(md)for(var t of md(e))k3.call(e,t)&&Ed(n,t,e[t]);return n},Tu=(n,e)=>G3(n,W3(e));class no{constructor(e){this.events=new Qt.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:e?.logger||hd})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const t=new no(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ro({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ut("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(u=>{this.session=u,this.namespaces||(this.namespaces=$3(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==ud)throw u;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Vn(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await xu.init({logger:this.providerOpts.logger||hd,relayUrl:this.providerOpts.relayUrl||S3,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Ws(t)))];Au("client",this.client),Au("events",this.events),Au("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=N3(t,this.session),o=gd(s),u=L3(this.namespaces,this.optionalNamespaces),f=Tu(ro({},u[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new M3({namespace:f});break;case"solana":this.rpcProviders[t]=new B3({namespace:f});break;case"cosmos":this.rpcProviders[t]=new q3({namespace:f});break;case"polkadot":this.rpcProviders[t]=new U3({namespace:f});break;case"cip34":this.rpcProviders[t]=new H3({namespace:f});break;case"elrond":this.rpcProviders[t]=new j3({namespace:f});break;case"multiversx":this.rpcProviders[t]=new z3({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&Vn(o)&&this.events.emit("accountsChanged",o.map(F3))}else s.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,u=(s=this.client)==null?void 0:s.session.get(e);this.session=Tu(ro({},u),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Tu(ro({},Ut("USER_DISCONNECTED")),{data:e.topic}))}),this.on(xn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(f=>Ws(f)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=Ws(Object.keys(this.namespaces)[0]),u=this.rpcProviders[o].getDefaultChain();return[o,u]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,u]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(u),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${ld}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${ld}/${e}`)}}const Y3=no;Un.UniversalProvider=Y3,Un.default=no,Object.defineProperty(Un,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
