(function(X,Je){typeof exports=="object"&&typeof module<"u"?Je(exports):typeof define=="function"&&define.amd?define(["exports"],Je):(X=typeof globalThis<"u"?globalThis:X||self,Je(X["@walletconnect/core"]={}))})(this,function(X){"use strict";var Je=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var ut={exports:{}},Bt=typeof Reflect=="object"?Reflect:null,oi=Bt&&typeof Bt.apply=="function"?Bt.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Er;Bt&&typeof Bt.ownKeys=="function"?Er=Bt.ownKeys:Object.getOwnPropertySymbols?Er=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Er=function(e){return Object.getOwnPropertyNames(e)};function Aa(t){console&&console.warn&&console.warn(t)}var ai=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}ut.exports=Oe,ut.exports.once=Ua,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var ci=10;function wr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return ci},set:function(t){if(typeof t!="number"||t<0||ai(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ci=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ai(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ui(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return ui(this)},Oe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var c;if(r.length>0&&(c=r[0]),c instanceof Error)throw c;var u=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw u.context=c,u}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")oi(l,this,r);else for(var f=l.length,_=gi(l,f),n=0;n<f;++n)oi(_[n],this,r);return!0};function fi(t,e,r,n){var i,s,c;if(wr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),c=s[e]),c===void 0)c=s[e]=r,++t._eventsCount;else if(typeof c=="function"?c=s[e]=n?[r,c]:[c,r]:n?c.unshift(r):c.push(r),i=ui(t),i>0&&c.length>i&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=c.length,Aa(u)}return t}Oe.prototype.addListener=function(e,r){return fi(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return fi(this,e,r,!0)};function Pa(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function li(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Pa.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(e,r){return wr(r),this.on(e,li(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return wr(r),this.prependListener(e,li(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var n,i,s,c,u;if(wr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,c=n.length-1;c>=0;c--)if(n[c]===r||n[c].listener===r){u=n[c].listener,s=c;break}if(s<0)return this;s===0?n.shift():La(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,u||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),c;for(i=0;i<s.length;++i)c=s[i],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function hi(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Na(i):gi(i,i.length)}Oe.prototype.listeners=function(e){return hi(this,e,!0)},Oe.prototype.rawListeners=function(e){return hi(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):di.call(t,e)},Oe.prototype.listenerCount=di;function di(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Er(this._events):[]};function gi(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function La(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Na(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Ua(t,e){return new Promise(function(r,n){function i(c){t.removeListener(e,s),n(c)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}_i(t,e,s,{once:!0}),e!=="error"&&Ma(t,i,{once:!0})})}function Ma(t,e,r){typeof t.on=="function"&&_i(t,"error",e,r)}function _i(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var mr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Xr=function(t,e){return Xr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Xr(t,e)};function ja(t,e){Xr(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Jr=function(){return Jr=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Jr.apply(this,arguments)};function $a(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Fa(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Ba(t,e){return function(r,n){e(r,n,t)}}function za(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ha(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function l(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,l)}f((n=n.apply(t,e||[])).next())})}function Ka(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return l([f,_])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Ga(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Va(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Zr(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function yi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function qa(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(yi(arguments[e]));return t}function Wa(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function Jt(t){return this instanceof Jt?(this.v=t,this):new Jt(t)}function Ya(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{l(n[p](E))}catch(C){O(s[0][3],C)}}function l(p){p.value instanceof Jt?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function ka(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:Jt(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Xa(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Zr=="function"?Zr(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,l){c=t[s](c),i(u,l,c.done,c.value)})}}function i(s,c,u,l){Promise.resolve(l).then(function(f){s({value:f,done:u})},c)}}function Ja(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Za(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Qa(t){return t&&t.__esModule?t:{default:t}}function ec(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function tc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var rc=Object.freeze({__proto__:null,__extends:ja,get __assign(){return Jr},__rest:$a,__decorate:Fa,__param:Ba,__metadata:za,__awaiter:Ha,__generator:Ka,__createBinding:Ga,__exportStar:Va,__values:Zr,__read:yi,__spread:qa,__spreadArrays:Wa,__await:Jt,__asyncGenerator:Ya,__asyncDelegator:ka,__asyncValues:Xa,__makeTemplateObject:Ja,__importStar:Za,__importDefault:Qa,__classPrivateFieldGet:ec,__classPrivateFieldSet:tc}),pi=Rt(rc),Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});function nc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Zt.safeJsonParse=nc;function ic(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Zt.safeJsonStringify=ic;var Qt={exports:{}},bi;function sc(){return bi||(bi=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Je<"u"&&Je.localStorage?Qt.exports=Je.localStorage:typeof window<"u"&&window.localStorage?Qt.exports=window.localStorage:Qt.exports=new e}()),Qt.exports}var Qr={},er={},vi;function oc(){if(vi)return er;vi=1,Object.defineProperty(er,"__esModule",{value:!0}),er.IKeyValueStorage=void 0;class t{}return er.IKeyValueStorage=t,er}var tr={},Ei;function ac(){if(Ei)return tr;Ei=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.parseEntry=void 0;const t=Zt;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return tr.parseEntry=e,tr}var wi;function cc(){return wi||(wi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=pi;e.__exportStar(oc(),t),e.__exportStar(ac(),t)}(Qr)),Qr}Object.defineProperty(mr,"__esModule",{value:!0}),mr.KeyValueStorage=void 0;const zt=pi,mi=Zt,uc=zt.__importDefault(sc()),fc=cc();class Di{constructor(){this.localStorage=uc.default}getKeys(){return zt.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return zt.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(fc.parseEntry)})}getItem(e){return zt.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return mi.safeJsonParse(r)})}setItem(e,r){return zt.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,mi.safeJsonStringify(r))})}removeItem(e){return zt.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}mr.KeyValueStorage=Di;var lc=mr.default=Di,Ht={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var en=function(t,e){return en=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},en(t,e)};function hc(t,e){en(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var tn=function(){return tn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},tn.apply(this,arguments)};function dc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function gc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function _c(t,e){return function(r,n){e(r,n,t)}}function yc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function pc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function l(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,l)}f((n=n.apply(t,e||[])).next())})}function bc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return l([f,_])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function vc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ec(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function rn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Si(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function wc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Si(arguments[e]));return t}function mc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function rr(t){return this instanceof rr?(this.v=t,this):new rr(t)}function Dc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{l(n[p](E))}catch(C){O(s[0][3],C)}}function l(p){p.value instanceof rr?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Sc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:rr(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Oc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof rn=="function"?rn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,l){c=t[s](c),i(u,l,c.done,c.value)})}}function i(s,c,u,l){Promise.resolve(l).then(function(f){s({value:f,done:u})},c)}}function Tc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function xc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Ic(t){return t&&t.__esModule?t:{default:t}}function Rc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Cc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ac=Object.freeze({__proto__:null,__extends:hc,get __assign(){return tn},__rest:dc,__decorate:gc,__param:_c,__metadata:yc,__awaiter:pc,__generator:bc,__createBinding:vc,__exportStar:Ec,__values:rn,__read:Si,__spread:wc,__spreadArrays:mc,__await:rr,__asyncGenerator:Dc,__asyncDelegator:Sc,__asyncValues:Oc,__makeTemplateObject:Tc,__importStar:xc,__importDefault:Ic,__classPrivateFieldGet:Rc,__classPrivateFieldSet:Cc}),Dr=Rt(Ac),nr={},oe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var nn=function(t,e){return nn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},nn(t,e)};function Pc(t,e){nn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var sn=function(){return sn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},sn.apply(this,arguments)};function Lc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Nc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Uc(t,e){return function(r,n){e(r,n,t)}}function Mc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function jc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function l(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,l)}f((n=n.apply(t,e||[])).next())})}function $c(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return l([f,_])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Fc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Bc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function on(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Oi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function zc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Oi(arguments[e]));return t}function Hc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function ir(t){return this instanceof ir?(this.v=t,this):new ir(t)}function Kc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{l(n[p](E))}catch(C){O(s[0][3],C)}}function l(p){p.value instanceof ir?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Gc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:ir(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Vc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof on=="function"?on(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,l){c=t[s](c),i(u,l,c.done,c.value)})}}function i(s,c,u,l){Promise.resolve(l).then(function(f){s({value:f,done:u})},c)}}function qc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Wc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Yc(t){return t&&t.__esModule?t:{default:t}}function kc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Xc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Jc=Object.freeze({__proto__:null,__extends:Pc,get __assign(){return sn},__rest:Lc,__decorate:Nc,__param:Uc,__metadata:Mc,__awaiter:jc,__generator:$c,__createBinding:Fc,__exportStar:Bc,__values:on,__read:Oi,__spread:zc,__spreadArrays:Hc,__await:ir,__asyncGenerator:Kc,__asyncDelegator:Gc,__asyncValues:Vc,__makeTemplateObject:qc,__importStar:Wc,__importDefault:Yc,__classPrivateFieldGet:kc,__classPrivateFieldSet:Xc}),Sr=Rt(Jc),an={},sr={},Ti;function Zc(){if(Ti)return sr;Ti=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return sr.delay=t,sr}var Ct={},cn={},At={},xi;function Qc(){return xi||(xi=1,Object.defineProperty(At,"__esModule",{value:!0}),At.ONE_THOUSAND=At.ONE_HUNDRED=void 0,At.ONE_HUNDRED=100,At.ONE_THOUSAND=1e3),At}var un={},Ii;function eu(){return Ii||(Ii=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(un)),un}var Ri;function Ci(){return Ri||(Ri=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Sr;e.__exportStar(Qc(),t),e.__exportStar(eu(),t)}(cn)),cn}var Ai;function tu(){if(Ai)return Ct;Ai=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.fromMiliseconds=Ct.toMiliseconds=void 0;const t=Ci();function e(n){return n*t.ONE_THOUSAND}Ct.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Ct.fromMiliseconds=r,Ct}var Pi;function ru(){return Pi||(Pi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Sr;e.__exportStar(Zc(),t),e.__exportStar(tu(),t)}(an)),an}var Kt={},Li;function nu(){if(Li)return Kt;Li=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Kt.Watch=t,Kt.default=t,Kt}var fn={},or={},Ni;function iu(){if(Ni)return or;Ni=1,Object.defineProperty(or,"__esModule",{value:!0}),or.IWatch=void 0;class t{}return or.IWatch=t,or}var Ui;function su(){return Ui||(Ui=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Sr.__exportStar(iu(),t)}(fn)),fn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Sr;e.__exportStar(ru(),t),e.__exportStar(nu(),t),e.__exportStar(su(),t),e.__exportStar(Ci(),t)})(oe);var ln={},ar={};class Pt{}var ou=Object.freeze({__proto__:null,IEvents:Pt}),au=Rt(ou),Mi;function cu(){if(Mi)return ar;Mi=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.IHeartBeat=void 0;const t=au;class e extends t.IEvents{constructor(n){super()}}return ar.IHeartBeat=e,ar}var ji;function $i(){return ji||(ji=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Dr.__exportStar(cu(),t)}(ln)),ln}var hn={},Lt={},Fi;function uu(){if(Fi)return Lt;Fi=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.HEARTBEAT_EVENTS=Lt.HEARTBEAT_INTERVAL=void 0;const t=oe;return Lt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Lt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Lt}var Bi;function zi(){return Bi||(Bi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Dr.__exportStar(uu(),t)}(hn)),hn}var Hi;function fu(){if(Hi)return nr;Hi=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.HeartBeat=void 0;const t=Dr,e=ut.exports,r=oe,n=$i(),i=zi();class s extends n.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=u?.interval||i.HEARTBEAT_INTERVAL}static init(u){return t.__awaiter(this,void 0,void 0,function*(){const l=new s(u);return yield l.init(),l})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,l){this.events.on(u,l)}once(u,l){this.events.once(u,l)}off(u,l){this.events.off(u,l)}removeListener(u,l){this.events.removeListener(u,l)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return nr.HeartBeat=s,nr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Dr;e.__exportStar(fu(),t),e.__exportStar($i(),t),e.__exportStar(zi(),t)})(Ht);var Se={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var dn=function(t,e){return dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},dn(t,e)};function lu(t,e){dn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var gn=function(){return gn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},gn.apply(this,arguments)};function hu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function du(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function gu(t,e){return function(r,n){e(r,n,t)}}function _u(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function yu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function l(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,l)}f((n=n.apply(t,e||[])).next())})}function pu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return l([f,_])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function bu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function vu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function _n(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ki(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Eu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ki(arguments[e]));return t}function wu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function cr(t){return this instanceof cr?(this.v=t,this):new cr(t)}function mu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{l(n[p](E))}catch(C){O(s[0][3],C)}}function l(p){p.value instanceof cr?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Du(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:cr(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Su(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof _n=="function"?_n(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,l){c=t[s](c),i(u,l,c.done,c.value)})}}function i(s,c,u,l){Promise.resolve(l).then(function(f){s({value:f,done:u})},c)}}function Ou(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Tu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function xu(t){return t&&t.__esModule?t:{default:t}}function Iu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ru(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Cu=Object.freeze({__proto__:null,__extends:lu,get __assign(){return gn},__rest:hu,__decorate:du,__param:gu,__metadata:_u,__awaiter:yu,__generator:pu,__createBinding:bu,__exportStar:vu,__values:_n,__read:Ki,__spread:Eu,__spreadArrays:wu,__await:cr,__asyncGenerator:mu,__asyncDelegator:Du,__asyncValues:Su,__makeTemplateObject:Ou,__importStar:Tu,__importDefault:xu,__classPrivateFieldGet:Iu,__classPrivateFieldSet:Ru}),Au=Rt(Cu),yn,Gi;function Pu(){if(Gi)return yn;Gi=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}yn=e;function e(r,n,i){var s=i&&i.stringify||t,c=1;if(typeof r=="object"&&r!==null){var u=n.length+c;if(u===1)return r;var l=new Array(u);l[0]=s(r);for(var f=1;f<u;f++)l[f]=s(n[f]);return l.join(" ")}if(typeof r!="string")return r;var _=n.length;if(_===0)return r;for(var O="",p=1-c,E=-1,C=r&&r.length||0,A=0;A<C;){if(r.charCodeAt(A)===37&&A+1<C){switch(E=E>-1?E:0,r.charCodeAt(A+1)){case 100:case 102:if(p>=_||n[p]==null)break;E<A&&(O+=r.slice(E,A)),O+=Number(n[p]),E=A+2,A++;break;case 105:if(p>=_||n[p]==null)break;E<A&&(O+=r.slice(E,A)),O+=Math.floor(Number(n[p])),E=A+2,A++;break;case 79:case 111:case 106:if(p>=_||n[p]===void 0)break;E<A&&(O+=r.slice(E,A));var U=typeof n[p];if(U==="string"){O+="'"+n[p]+"'",E=A+2,A++;break}if(U==="function"){O+=n[p].name||"<anonymous>",E=A+2,A++;break}O+=s(n[p]),E=A+2,A++;break;case 115:if(p>=_)break;E<A&&(O+=r.slice(E,A)),O+=String(n[p]),E=A+2,A++;break;case 37:E<A&&(O+=r.slice(E,A)),O+="%",E=A+2,A++,p--;break}++p}++A}return E===-1?r:(E<C&&(O+=r.slice(E)),O)}return yn}var pn,Vi;function Lu(){if(Vi)return pn;Vi=1;const t=Pu();pn=i;const e=v().console||{},r={mapHttpRequest:C,mapHttpResponse:C,wrapRequestSerializer:A,wrapResponseSerializer:A,wrapErrorSerializer:A,req:C,res:C,err:p};function n(d,o){return Array.isArray(d)?d.filter(function(L){return L!=="!stdSerializers.err"}):d===!0?Object.keys(o):!1}function i(d){d=d||{},d.browser=d.browser||{};const o=d.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const h=d.browser.write||e;d.browser.write&&(d.browser.asObject=!0);const L=d.serializers||{},P=n(d.browser.serialize,L);let H=d.browser.serialize;Array.isArray(d.browser.serialize)&&d.browser.serialize.indexOf("!stdSerializers.err")>-1&&(H=!1);const G=["error","fatal","warn","info","debug","trace"];typeof h=="function"&&(h.error=h.fatal=h.warn=h.info=h.debug=h.trace=h),d.enabled===!1&&(d.level="silent");const J=d.level||"info",D=Object.create(h);D.log||(D.log=U),Object.defineProperty(D,"levelVal",{get:V}),Object.defineProperty(D,"level",{get:F,set:M});const I={transmit:o,serialize:P,asObject:d.browser.asObject,levels:G,timestamp:E(d)};D.levels=i.levels,D.level=J,D.setMaxListeners=D.getMaxListeners=D.emit=D.addListener=D.on=D.prependListener=D.once=D.prependOnceListener=D.removeListener=D.removeAllListeners=D.listeners=D.listenerCount=D.eventNames=D.write=D.flush=U,D.serializers=L,D._serialize=P,D._stdErrSerialize=H,D.child=$,o&&(D._logEvent=O());function V(){return this.level==="silent"?1/0:this.levels.values[this.level]}function F(){return this._level}function M(N){if(N!=="silent"&&!this.levels.values[N])throw Error("unknown level "+N);this._level=N,s(I,D,"error","log"),s(I,D,"fatal","error"),s(I,D,"warn","error"),s(I,D,"info","log"),s(I,D,"debug","log"),s(I,D,"trace","log")}function $(N,B){if(!N)throw new Error("missing bindings for child Pino");B=B||{},P&&N.serializers&&(B.serializers=N.serializers);const ee=B.serializers;if(P&&ee){var z=Object.assign({},L,ee),Z=d.browser.serialize===!0?Object.keys(z):P;delete N.serializers,l([N],Z,z,this._stdErrSerialize)}function Y(Q){this._childLevel=(Q._childLevel|0)+1,this.error=f(Q,N,"error"),this.fatal=f(Q,N,"fatal"),this.warn=f(Q,N,"warn"),this.info=f(Q,N,"info"),this.debug=f(Q,N,"debug"),this.trace=f(Q,N,"trace"),z&&(this.serializers=z,this._serialize=Z),o&&(this._logEvent=O([].concat(Q._logEvent.bindings,N)))}return Y.prototype=this,new Y(this)}return D}i.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},i.stdSerializers=r,i.stdTimeFunctions=Object.assign({},{nullTime:W,epochTime:S,unixTime:R,isoTime:b});function s(d,o,h,L){const P=Object.getPrototypeOf(o);o[h]=o.levelVal>o.levels.values[h]?U:P[h]?P[h]:e[h]||e[L]||U,c(d,o,h)}function c(d,o,h){!d.transmit&&o[h]===U||(o[h]=function(L){return function(){const H=d.timestamp(),G=new Array(arguments.length),J=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var D=0;D<G.length;D++)G[D]=arguments[D];if(d.serialize&&!d.asObject&&l(G,this._serialize,this.serializers,this._stdErrSerialize),d.asObject?L.call(J,u(this,h,G,H)):L.apply(J,G),d.transmit){const I=d.transmit.level||o.level,V=i.levels.values[I],F=i.levels.values[h];if(F<V)return;_(this,{ts:H,methodLevel:h,methodValue:F,transmitLevel:I,transmitValue:i.levels.values[d.transmit.level||o.level],send:d.transmit.send,val:o.levelVal},G)}}}(o[h]))}function u(d,o,h,L){d._serialize&&l(h,d._serialize,d.serializers,d._stdErrSerialize);const P=h.slice();let H=P[0];const G={};L&&(G.time=L),G.level=i.levels.values[o];let J=(d._childLevel|0)+1;if(J<1&&(J=1),H!==null&&typeof H=="object"){for(;J--&&typeof P[0]=="object";)Object.assign(G,P.shift());H=P.length?t(P.shift(),P):void 0}else typeof H=="string"&&(H=t(P.shift(),P));return H!==void 0&&(G.msg=H),G}function l(d,o,h,L){for(const P in d)if(L&&d[P]instanceof Error)d[P]=i.stdSerializers.err(d[P]);else if(typeof d[P]=="object"&&!Array.isArray(d[P]))for(const H in d[P])o&&o.indexOf(H)>-1&&H in h&&(d[P][H]=h[H](d[P][H]))}function f(d,o,h){return function(){const L=new Array(1+arguments.length);L[0]=o;for(var P=1;P<L.length;P++)L[P]=arguments[P-1];return d[h].apply(this,L)}}function _(d,o,h){const L=o.send,P=o.ts,H=o.methodLevel,G=o.methodValue,J=o.val,D=d._logEvent.bindings;l(h,d._serialize||Object.keys(d.serializers),d.serializers,d._stdErrSerialize===void 0?!0:d._stdErrSerialize),d._logEvent.ts=P,d._logEvent.messages=h.filter(function(I){return D.indexOf(I)===-1}),d._logEvent.level.label=H,d._logEvent.level.value=G,L(H,d._logEvent,J),d._logEvent=O(D)}function O(d){return{ts:0,messages:[],bindings:d||[],level:{label:"",value:0}}}function p(d){const o={type:d.constructor.name,msg:d.message,stack:d.stack};for(const h in d)o[h]===void 0&&(o[h]=d[h]);return o}function E(d){return typeof d.timestamp=="function"?d.timestamp:d.timestamp===!1?W:S}function C(){return{}}function A(d){return d}function U(){}function W(){return!1}function S(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function b(){return new Date(Date.now()).toISOString()}function v(){function d(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return d(self)||d(window)||d(this)||{}}}return pn}var Nt={},qi;function Wi(){return qi||(qi=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.PINO_CUSTOM_CONTEXT_KEY=Nt.PINO_LOGGER_DEFAULTS=void 0,Nt.PINO_LOGGER_DEFAULTS={level:"info"},Nt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Nt}var rt={},Yi;function Nu(){if(Yi)return rt;Yi=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.generateChildLogger=rt.formatChildLoggerContext=rt.getLoggerContext=rt.setBrowserLoggerContext=rt.getBrowserLoggerContext=rt.getDefaultLoggerOptions=void 0;const t=Wi();function e(u){return Object.assign(Object.assign({},u),{level:u?.level||t.PINO_LOGGER_DEFAULTS.level})}rt.getDefaultLoggerOptions=e;function r(u,l=t.PINO_CUSTOM_CONTEXT_KEY){return u[l]||""}rt.getBrowserLoggerContext=r;function n(u,l,f=t.PINO_CUSTOM_CONTEXT_KEY){return u[f]=l,u}rt.setBrowserLoggerContext=n;function i(u,l=t.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof u.bindings>"u"?f=r(u,l):f=u.bindings().context||"",f}rt.getLoggerContext=i;function s(u,l,f=t.PINO_CUSTOM_CONTEXT_KEY){const _=i(u,f);return _.trim()?`${_}/${l}`:l}rt.formatChildLoggerContext=s;function c(u,l,f=t.PINO_CUSTOM_CONTEXT_KEY){const _=s(u,l,f),O=u.child({context:_});return n(O,_,f)}return rt.generateChildLogger=c,rt}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Au,r=e.__importDefault(Lu());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Wi(),t),e.__exportStar(Nu(),t)})(Se);class Uu extends Pt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Mu extends Pt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class ju{constructor(e,r){this.logger=e,this.core=r}}class $u extends Pt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Fu extends Pt{constructor(e){super()}}class Bu{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class zu extends Pt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Hu extends Pt{constructor(e,r){super(),this.core=e,this.logger=r}}class Ku{constructor(e,r){this.projectId=e,this.logger=r}}const Gu=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),Vu=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function ki(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Vu(t)}catch{return t}}function bn(t){return typeof t=="string"?t:Gu(t)||""}var vn={},Gt={},Or={},Tr={};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.BrowserRandomSource=void 0;const Xi=65536;class qu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=Xi)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Xi)));return r}}Tr.BrowserRandomSource=qu;function Wu(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xr={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});function Yu(t){for(var e=0;e<t.length;e++)t[e]=0;return t}ot.wipe=Yu;var ku={},Xu=Object.freeze({__proto__:null,default:ku}),Ju=Rt(Xu);Object.defineProperty(xr,"__esModule",{value:!0}),xr.NodeRandomSource=void 0;const Zu=ot;class Qu{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Wu<"u"){const e=Ju;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Zu.wipe)(r),n}}xr.NodeRandomSource=Qu,Object.defineProperty(Or,"__esModule",{value:!0}),Or.SystemRandomSource=void 0;const ef=Tr,tf=xr;class rf{constructor(){if(this.isAvailable=!1,this.name="",this._source=new ef.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new tf.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Or.SystemRandomSource=rf;var re={},Ji={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,l){var f=u>>>16&65535,_=u&65535,O=l>>>16&65535,p=l&65535;return _*p+(f*p+_*O<<16>>>0)|0}t.mul=Math.imul||e;function r(u,l){return u+l|0}t.add=r;function n(u,l){return u-l|0}t.sub=n;function i(u,l){return u<<l|u>>>32-l}t.rotl=i;function s(u,l){return u<<32-l|u>>>l}t.rotr=s;function c(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||c,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(Ji),Object.defineProperty(re,"__esModule",{value:!0});var Zi=Ji;function nf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}re.readInt16BE=nf;function sf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}re.readUint16BE=sf;function of(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}re.readInt16LE=of;function af(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}re.readUint16LE=af;function Qi(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}re.writeUint16BE=Qi,re.writeInt16BE=Qi;function es(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}re.writeUint16LE=es,re.writeInt16LE=es;function En(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}re.readInt32BE=En;function wn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}re.readUint32BE=wn;function mn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}re.readInt32LE=mn;function Dn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}re.readUint32LE=Dn;function Ir(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}re.writeUint32BE=Ir,re.writeInt32BE=Ir;function Rr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}re.writeUint32LE=Rr,re.writeInt32LE=Rr;function cf(t,e){e===void 0&&(e=0);var r=En(t,e),n=En(t,e+4);return r*4294967296+n-(n>>31)*4294967296}re.readInt64BE=cf;function uf(t,e){e===void 0&&(e=0);var r=wn(t,e),n=wn(t,e+4);return r*4294967296+n}re.readUint64BE=uf;function ff(t,e){e===void 0&&(e=0);var r=mn(t,e),n=mn(t,e+4);return n*4294967296+r-(r>>31)*4294967296}re.readInt64LE=ff;function lf(t,e){e===void 0&&(e=0);var r=Dn(t,e),n=Dn(t,e+4);return n*4294967296+r}re.readUint64LE=lf;function ts(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ir(t/4294967296>>>0,e,r),Ir(t>>>0,e,r+4),e}re.writeUint64BE=ts,re.writeInt64BE=ts;function rs(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Rr(t>>>0,e,r),Rr(t/4294967296>>>0,e,r+4),e}re.writeUint64LE=rs,re.writeInt64LE=rs;function hf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}re.readUintBE=hf;function df(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}re.readUintLE=df;function gf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Zi.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}re.writeUintBE=gf;function _f(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Zi.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}re.writeUintLE=_f;function yf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}re.readFloat32BE=yf;function pf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}re.readFloat32LE=pf;function bf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}re.readFloat64BE=bf;function vf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}re.readFloat64LE=vf;function Ef(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}re.writeFloat32BE=Ef;function wf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}re.writeFloat32LE=wf;function mf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}re.writeFloat64BE=mf;function Df(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}re.writeFloat64LE=Df,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Or,r=re,n=ot;t.defaultRandomSource=new e.SystemRandomSource;function i(f,_=t.defaultRandomSource){return _.randomBytes(f)}t.randomBytes=i;function s(f=t.defaultRandomSource){const _=i(4,f),O=(0,r.readUint32LE)(_);return(0,n.wipe)(_),O}t.randomUint32=s;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(f,_=c,O=t.defaultRandomSource){if(_.length<2)throw new Error("randomString charset is too short");if(_.length>256)throw new Error("randomString charset is too long");let p="";const E=_.length,C=256-256%E;for(;f>0;){const A=i(Math.ceil(f*256/C),O);for(let U=0;U<A.length&&f>0;U++){const W=A[U];W<C&&(p+=_.charAt(W%E),f--)}(0,n.wipe)(A)}return p}t.randomString=u;function l(f,_=c,O=t.defaultRandomSource){const p=Math.ceil(f/(Math.log(_.length)/Math.LN2));return u(p,_,O)}t.randomStringForEntropy=l}(Gt);var ns={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ot;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(l,f){if(f===void 0&&(f=l.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=l[_++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(_=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,l,_,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=l[_++],f--;return this},u.prototype.finish=function(l){if(!this._finished){var f=this._bytesHashed,_=this._bufferLength,O=f/536870912|0,p=f<<3,E=f%128<112?128:256;this._buffer[_]=128;for(var C=_+1;C<E-8;C++)this._buffer[C]=0;e.writeUint32BE(O,this._buffer,E-8),e.writeUint32BE(p,this._buffer,E-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,E),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)e.writeUint32BE(this._stateHi[C],l,C*8),e.writeUint32BE(this._stateLo[C],l,C*8+4);return this},u.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(l){return this._stateHi.set(l.stateHi),this._stateLo.set(l.stateLo),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(l){r.wipe(l.stateHi),r.wipe(l.stateLo),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},u}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,l,f,_,O,p,E){for(var C=f[0],A=f[1],U=f[2],W=f[3],S=f[4],R=f[5],b=f[6],v=f[7],d=_[0],o=_[1],h=_[2],L=_[3],P=_[4],H=_[5],G=_[6],J=_[7],D,I,V,F,M,$,N,B;E>=128;){for(var ee=0;ee<16;ee++){var z=8*ee+p;u[ee]=e.readUint32BE(O,z),l[ee]=e.readUint32BE(O,z+4)}for(var ee=0;ee<80;ee++){var Z=C,Y=A,Q=U,x=W,T=S,w=R,a=b,y=v,K=d,q=o,le=h,pe=L,de=P,Ee=H,Ue=G,Ae=J;if(D=v,I=J,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=(S>>>14|P<<32-14)^(S>>>18|P<<32-18)^(P>>>41-32|S<<32-(41-32)),I=(P>>>14|S<<32-14)^(P>>>18|S<<32-18)^(S>>>41-32|P<<32-(41-32)),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=S&R^~S&b,I=P&H^~P&G,M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=i[ee*2],I=i[ee*2+1],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=u[ee%16],I=l[ee%16],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,V=N&65535|B<<16,F=M&65535|$<<16,D=V,I=F,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=(C>>>28|d<<32-28)^(d>>>34-32|C<<32-(34-32))^(d>>>39-32|C<<32-(39-32)),I=(d>>>28|C<<32-28)^(C>>>34-32|d<<32-(34-32))^(C>>>39-32|d<<32-(39-32)),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=C&A^C&U^A&U,I=d&o^d&h^o&h,M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,y=N&65535|B<<16,Ae=M&65535|$<<16,D=x,I=pe,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=V,I=F,M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,x=N&65535|B<<16,pe=M&65535|$<<16,A=Z,U=Y,W=Q,S=x,R=T,b=w,v=a,C=y,o=K,h=q,L=le,P=pe,H=de,G=Ee,J=Ue,d=Ae,ee%16===15)for(var z=0;z<16;z++)D=u[z],I=l[z],M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=u[(z+9)%16],I=l[(z+9)%16],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,V=u[(z+1)%16],F=l[(z+1)%16],D=(V>>>1|F<<32-1)^(V>>>8|F<<32-8)^V>>>7,I=(F>>>1|V<<32-1)^(F>>>8|V<<32-8)^(F>>>7|V<<32-7),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,V=u[(z+14)%16],F=l[(z+14)%16],D=(V>>>19|F<<32-19)^(F>>>61-32|V<<32-(61-32))^V>>>6,I=(F>>>19|V<<32-19)^(V>>>61-32|F<<32-(61-32))^(F>>>6|V<<32-6),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,u[z]=N&65535|B<<16,l[z]=M&65535|$<<16}D=C,I=d,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[0],I=_[0],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[0]=C=N&65535|B<<16,_[0]=d=M&65535|$<<16,D=A,I=o,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[1],I=_[1],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[1]=A=N&65535|B<<16,_[1]=o=M&65535|$<<16,D=U,I=h,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[2],I=_[2],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[2]=U=N&65535|B<<16,_[2]=h=M&65535|$<<16,D=W,I=L,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[3],I=_[3],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[3]=W=N&65535|B<<16,_[3]=L=M&65535|$<<16,D=S,I=P,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[4],I=_[4],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[4]=S=N&65535|B<<16,_[4]=P=M&65535|$<<16,D=R,I=H,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[5],I=_[5],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[5]=R=N&65535|B<<16,_[5]=H=M&65535|$<<16,D=b,I=G,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[6],I=_[6],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[6]=b=N&65535|B<<16,_[6]=G=M&65535|$<<16,D=v,I=J,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[7],I=_[7],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[7]=v=N&65535|B<<16,_[7]=J=M&65535|$<<16,p+=128,E-=128}return p}function c(u){var l=new n;l.update(u);var f=l.digest();return l.clean(),f}t.hash=c})(ns),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=Gt,r=ns,n=ot;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(x){const T=new Float64Array(16);if(x)for(let w=0;w<x.length;w++)T[w]=x[w];return T}const s=new Uint8Array(32);s[0]=9;const c=i(),u=i([1]),l=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function E(x,T){for(let w=0;w<16;w++)x[w]=T[w]|0}function C(x){let T=1;for(let w=0;w<16;w++){let a=x[w]+T+65535;T=Math.floor(a/65536),x[w]=a-T*65536}x[0]+=T-1+37*(T-1)}function A(x,T,w){const a=~(w-1);for(let y=0;y<16;y++){const K=a&(x[y]^T[y]);x[y]^=K,T[y]^=K}}function U(x,T){const w=i(),a=i();for(let y=0;y<16;y++)a[y]=T[y];C(a),C(a),C(a);for(let y=0;y<2;y++){w[0]=a[0]-65517;for(let q=1;q<15;q++)w[q]=a[q]-65535-(w[q-1]>>16&1),w[q-1]&=65535;w[15]=a[15]-32767-(w[14]>>16&1);const K=w[15]>>16&1;w[14]&=65535,A(a,w,1-K)}for(let y=0;y<16;y++)x[2*y]=a[y]&255,x[2*y+1]=a[y]>>8}function W(x,T){let w=0;for(let a=0;a<32;a++)w|=x[a]^T[a];return(1&w-1>>>8)-1}function S(x,T){const w=new Uint8Array(32),a=new Uint8Array(32);return U(w,x),U(a,T),W(w,a)}function R(x){const T=new Uint8Array(32);return U(T,x),T[0]&1}function b(x,T){for(let w=0;w<16;w++)x[w]=T[2*w]+(T[2*w+1]<<8);x[15]&=32767}function v(x,T,w){for(let a=0;a<16;a++)x[a]=T[a]+w[a]}function d(x,T,w){for(let a=0;a<16;a++)x[a]=T[a]-w[a]}function o(x,T,w){let a,y,K=0,q=0,le=0,pe=0,de=0,Ee=0,Ue=0,Ae=0,ye=0,ge=0,he=0,ue=0,ce=0,ae=0,se=0,te=0,fe=0,_e=0,ne=0,be=0,ve=0,me=0,De=0,we=0,_t=0,bt=0,Ot=0,at=0,Mt=0,pr=0,Kr=0,Me=w[0],Pe=w[1],je=w[2],$e=w[3],Fe=w[4],Le=w[5],Ke=w[6],Ge=w[7],Ve=w[8],qe=w[9],We=w[10],He=w[11],Be=w[12],Re=w[13],Ye=w[14],ke=w[15];a=T[0],K+=a*Me,q+=a*Pe,le+=a*je,pe+=a*$e,de+=a*Fe,Ee+=a*Le,Ue+=a*Ke,Ae+=a*Ge,ye+=a*Ve,ge+=a*qe,he+=a*We,ue+=a*He,ce+=a*Be,ae+=a*Re,se+=a*Ye,te+=a*ke,a=T[1],q+=a*Me,le+=a*Pe,pe+=a*je,de+=a*$e,Ee+=a*Fe,Ue+=a*Le,Ae+=a*Ke,ye+=a*Ge,ge+=a*Ve,he+=a*qe,ue+=a*We,ce+=a*He,ae+=a*Be,se+=a*Re,te+=a*Ye,fe+=a*ke,a=T[2],le+=a*Me,pe+=a*Pe,de+=a*je,Ee+=a*$e,Ue+=a*Fe,Ae+=a*Le,ye+=a*Ke,ge+=a*Ge,he+=a*Ve,ue+=a*qe,ce+=a*We,ae+=a*He,se+=a*Be,te+=a*Re,fe+=a*Ye,_e+=a*ke,a=T[3],pe+=a*Me,de+=a*Pe,Ee+=a*je,Ue+=a*$e,Ae+=a*Fe,ye+=a*Le,ge+=a*Ke,he+=a*Ge,ue+=a*Ve,ce+=a*qe,ae+=a*We,se+=a*He,te+=a*Be,fe+=a*Re,_e+=a*Ye,ne+=a*ke,a=T[4],de+=a*Me,Ee+=a*Pe,Ue+=a*je,Ae+=a*$e,ye+=a*Fe,ge+=a*Le,he+=a*Ke,ue+=a*Ge,ce+=a*Ve,ae+=a*qe,se+=a*We,te+=a*He,fe+=a*Be,_e+=a*Re,ne+=a*Ye,be+=a*ke,a=T[5],Ee+=a*Me,Ue+=a*Pe,Ae+=a*je,ye+=a*$e,ge+=a*Fe,he+=a*Le,ue+=a*Ke,ce+=a*Ge,ae+=a*Ve,se+=a*qe,te+=a*We,fe+=a*He,_e+=a*Be,ne+=a*Re,be+=a*Ye,ve+=a*ke,a=T[6],Ue+=a*Me,Ae+=a*Pe,ye+=a*je,ge+=a*$e,he+=a*Fe,ue+=a*Le,ce+=a*Ke,ae+=a*Ge,se+=a*Ve,te+=a*qe,fe+=a*We,_e+=a*He,ne+=a*Be,be+=a*Re,ve+=a*Ye,me+=a*ke,a=T[7],Ae+=a*Me,ye+=a*Pe,ge+=a*je,he+=a*$e,ue+=a*Fe,ce+=a*Le,ae+=a*Ke,se+=a*Ge,te+=a*Ve,fe+=a*qe,_e+=a*We,ne+=a*He,be+=a*Be,ve+=a*Re,me+=a*Ye,De+=a*ke,a=T[8],ye+=a*Me,ge+=a*Pe,he+=a*je,ue+=a*$e,ce+=a*Fe,ae+=a*Le,se+=a*Ke,te+=a*Ge,fe+=a*Ve,_e+=a*qe,ne+=a*We,be+=a*He,ve+=a*Be,me+=a*Re,De+=a*Ye,we+=a*ke,a=T[9],ge+=a*Me,he+=a*Pe,ue+=a*je,ce+=a*$e,ae+=a*Fe,se+=a*Le,te+=a*Ke,fe+=a*Ge,_e+=a*Ve,ne+=a*qe,be+=a*We,ve+=a*He,me+=a*Be,De+=a*Re,we+=a*Ye,_t+=a*ke,a=T[10],he+=a*Me,ue+=a*Pe,ce+=a*je,ae+=a*$e,se+=a*Fe,te+=a*Le,fe+=a*Ke,_e+=a*Ge,ne+=a*Ve,be+=a*qe,ve+=a*We,me+=a*He,De+=a*Be,we+=a*Re,_t+=a*Ye,bt+=a*ke,a=T[11],ue+=a*Me,ce+=a*Pe,ae+=a*je,se+=a*$e,te+=a*Fe,fe+=a*Le,_e+=a*Ke,ne+=a*Ge,be+=a*Ve,ve+=a*qe,me+=a*We,De+=a*He,we+=a*Be,_t+=a*Re,bt+=a*Ye,Ot+=a*ke,a=T[12],ce+=a*Me,ae+=a*Pe,se+=a*je,te+=a*$e,fe+=a*Fe,_e+=a*Le,ne+=a*Ke,be+=a*Ge,ve+=a*Ve,me+=a*qe,De+=a*We,we+=a*He,_t+=a*Be,bt+=a*Re,Ot+=a*Ye,at+=a*ke,a=T[13],ae+=a*Me,se+=a*Pe,te+=a*je,fe+=a*$e,_e+=a*Fe,ne+=a*Le,be+=a*Ke,ve+=a*Ge,me+=a*Ve,De+=a*qe,we+=a*We,_t+=a*He,bt+=a*Be,Ot+=a*Re,at+=a*Ye,Mt+=a*ke,a=T[14],se+=a*Me,te+=a*Pe,fe+=a*je,_e+=a*$e,ne+=a*Fe,be+=a*Le,ve+=a*Ke,me+=a*Ge,De+=a*Ve,we+=a*qe,_t+=a*We,bt+=a*He,Ot+=a*Be,at+=a*Re,Mt+=a*Ye,pr+=a*ke,a=T[15],te+=a*Me,fe+=a*Pe,_e+=a*je,ne+=a*$e,be+=a*Fe,ve+=a*Le,me+=a*Ke,De+=a*Ge,we+=a*Ve,_t+=a*qe,bt+=a*We,Ot+=a*He,at+=a*Be,Mt+=a*Re,pr+=a*Ye,Kr+=a*ke,K+=38*fe,q+=38*_e,le+=38*ne,pe+=38*be,de+=38*ve,Ee+=38*me,Ue+=38*De,Ae+=38*we,ye+=38*_t,ge+=38*bt,he+=38*Ot,ue+=38*at,ce+=38*Mt,ae+=38*pr,se+=38*Kr,y=1,a=K+y+65535,y=Math.floor(a/65536),K=a-y*65536,a=q+y+65535,y=Math.floor(a/65536),q=a-y*65536,a=le+y+65535,y=Math.floor(a/65536),le=a-y*65536,a=pe+y+65535,y=Math.floor(a/65536),pe=a-y*65536,a=de+y+65535,y=Math.floor(a/65536),de=a-y*65536,a=Ee+y+65535,y=Math.floor(a/65536),Ee=a-y*65536,a=Ue+y+65535,y=Math.floor(a/65536),Ue=a-y*65536,a=Ae+y+65535,y=Math.floor(a/65536),Ae=a-y*65536,a=ye+y+65535,y=Math.floor(a/65536),ye=a-y*65536,a=ge+y+65535,y=Math.floor(a/65536),ge=a-y*65536,a=he+y+65535,y=Math.floor(a/65536),he=a-y*65536,a=ue+y+65535,y=Math.floor(a/65536),ue=a-y*65536,a=ce+y+65535,y=Math.floor(a/65536),ce=a-y*65536,a=ae+y+65535,y=Math.floor(a/65536),ae=a-y*65536,a=se+y+65535,y=Math.floor(a/65536),se=a-y*65536,a=te+y+65535,y=Math.floor(a/65536),te=a-y*65536,K+=y-1+37*(y-1),y=1,a=K+y+65535,y=Math.floor(a/65536),K=a-y*65536,a=q+y+65535,y=Math.floor(a/65536),q=a-y*65536,a=le+y+65535,y=Math.floor(a/65536),le=a-y*65536,a=pe+y+65535,y=Math.floor(a/65536),pe=a-y*65536,a=de+y+65535,y=Math.floor(a/65536),de=a-y*65536,a=Ee+y+65535,y=Math.floor(a/65536),Ee=a-y*65536,a=Ue+y+65535,y=Math.floor(a/65536),Ue=a-y*65536,a=Ae+y+65535,y=Math.floor(a/65536),Ae=a-y*65536,a=ye+y+65535,y=Math.floor(a/65536),ye=a-y*65536,a=ge+y+65535,y=Math.floor(a/65536),ge=a-y*65536,a=he+y+65535,y=Math.floor(a/65536),he=a-y*65536,a=ue+y+65535,y=Math.floor(a/65536),ue=a-y*65536,a=ce+y+65535,y=Math.floor(a/65536),ce=a-y*65536,a=ae+y+65535,y=Math.floor(a/65536),ae=a-y*65536,a=se+y+65535,y=Math.floor(a/65536),se=a-y*65536,a=te+y+65535,y=Math.floor(a/65536),te=a-y*65536,K+=y-1+37*(y-1),x[0]=K,x[1]=q,x[2]=le,x[3]=pe,x[4]=de,x[5]=Ee,x[6]=Ue,x[7]=Ae,x[8]=ye,x[9]=ge,x[10]=he,x[11]=ue,x[12]=ce,x[13]=ae,x[14]=se,x[15]=te}function h(x,T){o(x,T,T)}function L(x,T){const w=i();let a;for(a=0;a<16;a++)w[a]=T[a];for(a=253;a>=0;a--)h(w,w),a!==2&&a!==4&&o(w,w,T);for(a=0;a<16;a++)x[a]=w[a]}function P(x,T){const w=i();let a;for(a=0;a<16;a++)w[a]=T[a];for(a=250;a>=0;a--)h(w,w),a!==1&&o(w,w,T);for(a=0;a<16;a++)x[a]=w[a]}function H(x,T){const w=i(),a=i(),y=i(),K=i(),q=i(),le=i(),pe=i(),de=i(),Ee=i();d(w,x[1],x[0]),d(Ee,T[1],T[0]),o(w,w,Ee),v(a,x[0],x[1]),v(Ee,T[0],T[1]),o(a,a,Ee),o(y,x[3],T[3]),o(y,y,f),o(K,x[2],T[2]),v(K,K,K),d(q,a,w),d(le,K,y),v(pe,K,y),v(de,a,w),o(x[0],q,le),o(x[1],de,pe),o(x[2],pe,le),o(x[3],q,de)}function G(x,T,w){for(let a=0;a<4;a++)A(x[a],T[a],w)}function J(x,T){const w=i(),a=i(),y=i();L(y,T[2]),o(w,T[0],y),o(a,T[1],y),U(x,a),x[31]^=R(w)<<7}function D(x,T,w){E(x[0],c),E(x[1],u),E(x[2],u),E(x[3],c);for(let a=255;a>=0;--a){const y=w[a/8|0]>>(a&7)&1;G(x,T,y),H(T,x),H(x,x),G(x,T,y)}}function I(x,T){const w=[i(),i(),i(),i()];E(w[0],_),E(w[1],O),E(w[2],u),o(w[3],_,O),D(x,w,T)}function V(x){if(x.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const T=(0,r.hash)(x);T[0]&=248,T[31]&=127,T[31]|=64;const w=new Uint8Array(32),a=[i(),i(),i(),i()];I(a,T),J(w,a);const y=new Uint8Array(64);return y.set(x),y.set(w,32),{publicKey:w,secretKey:y}}t.generateKeyPairFromSeed=V;function F(x){const T=(0,e.randomBytes)(32,x),w=V(T);return(0,n.wipe)(T),w}t.generateKeyPair=F;function M(x){if(x.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(x.subarray(32))}t.extractPublicKeyFromSecretKey=M;const $=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function N(x,T){let w,a,y,K;for(a=63;a>=32;--a){for(w=0,y=a-32,K=a-12;y<K;++y)T[y]+=w-16*T[a]*$[y-(a-32)],w=Math.floor((T[y]+128)/256),T[y]-=w*256;T[y]+=w,T[a]=0}for(w=0,y=0;y<32;y++)T[y]+=w-(T[31]>>4)*$[y],w=T[y]>>8,T[y]&=255;for(y=0;y<32;y++)T[y]-=w*$[y];for(a=0;a<32;a++)T[a+1]+=T[a]>>8,x[a]=T[a]&255}function B(x){const T=new Float64Array(64);for(let w=0;w<64;w++)T[w]=x[w];for(let w=0;w<64;w++)x[w]=0;N(x,T)}function ee(x,T){const w=new Float64Array(64),a=[i(),i(),i(),i()],y=(0,r.hash)(x.subarray(0,32));y[0]&=248,y[31]&=127,y[31]|=64;const K=new Uint8Array(64);K.set(y.subarray(32),32);const q=new r.SHA512;q.update(K.subarray(32)),q.update(T);const le=q.digest();q.clean(),B(le),I(a,le),J(K,a),q.reset(),q.update(K.subarray(0,32)),q.update(x.subarray(32)),q.update(T);const pe=q.digest();B(pe);for(let de=0;de<32;de++)w[de]=le[de];for(let de=0;de<32;de++)for(let Ee=0;Ee<32;Ee++)w[de+Ee]+=pe[de]*y[Ee];return N(K.subarray(32),w),K}t.sign=ee;function z(x,T){const w=i(),a=i(),y=i(),K=i(),q=i(),le=i(),pe=i();return E(x[2],u),b(x[1],T),h(y,x[1]),o(K,y,l),d(y,y,x[2]),v(K,x[2],K),h(q,K),h(le,q),o(pe,le,q),o(w,pe,y),o(w,w,K),P(w,w),o(w,w,y),o(w,w,K),o(w,w,K),o(x[0],w,K),h(a,x[0]),o(a,a,K),S(a,y)&&o(x[0],x[0],p),h(a,x[0]),o(a,a,K),S(a,y)?-1:(R(x[0])===T[31]>>7&&d(x[0],c,x[0]),o(x[3],x[0],x[1]),0)}function Z(x,T,w){const a=new Uint8Array(32),y=[i(),i(),i(),i()],K=[i(),i(),i(),i()];if(w.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(K,x))return!1;const q=new r.SHA512;q.update(w.subarray(0,32)),q.update(x),q.update(T);const le=q.digest();return B(le),D(y,K,le),I(K,w.subarray(32)),H(y,K),J(a,y),!W(w,a)}t.verify=Z;function Y(x){let T=[i(),i(),i(),i()];if(z(T,x))throw new Error("Ed25519: invalid public key");let w=i(),a=i(),y=T[1];v(w,u,y),d(a,u,y),L(a,a),o(w,w,a);let K=new Uint8Array(32);return U(K,w),K}t.convertPublicKeyToX25519=Y;function Q(x){const T=(0,r.hash)(x.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const w=new Uint8Array(T.subarray(0,32));return(0,n.wipe)(T),w}t.convertSecretKeyToX25519=Q}(vn);const Sf="EdDSA",Of="JWT",is=".",ss="base64url",Tf="utf8",xf="utf8",If=":",Rf="did",Cf="key",os="base58btc",Af="z",Pf="K36",Lf=32;function Sn(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function as(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sn(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function On(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=as(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return Sn(r)}function Nf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),c=s.charCodeAt(0);if(r[c]!==255)throw new TypeError(s+" is ambiguous");r[c]=i}var u=t.length,l=t.charAt(0),f=Math.log(u)/Math.log(256),_=Math.log(256)/Math.log(u);function O(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var A=0,U=0,W=0,S=C.length;W!==S&&C[W]===0;)W++,A++;for(var R=(S-W)*_+1>>>0,b=new Uint8Array(R);W!==S;){for(var v=C[W],d=0,o=R-1;(v!==0||d<U)&&o!==-1;o--,d++)v+=256*b[o]>>>0,b[o]=v%u>>>0,v=v/u>>>0;if(v!==0)throw new Error("Non-zero carry");U=d,W++}for(var h=R-U;h!==R&&b[h]===0;)h++;for(var L=l.repeat(A);h<R;++h)L+=t.charAt(b[h]);return L}function p(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var A=0;if(C[A]!==" "){for(var U=0,W=0;C[A]===l;)U++,A++;for(var S=(C.length-A)*f+1>>>0,R=new Uint8Array(S);C[A];){var b=r[C.charCodeAt(A)];if(b===255)return;for(var v=0,d=S-1;(b!==0||v<W)&&d!==-1;d--,v++)b+=u*R[d]>>>0,R[d]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");W=v,A++}if(C[A]!==" "){for(var o=S-W;o!==S&&R[o]===0;)o++;for(var h=new Uint8Array(U+(S-o)),L=U;o!==S;)h[L++]=R[o++];return h}}}function E(C){var A=p(C);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:O,decodeUnsafe:p,decode:E}}var Uf=Nf,Mf=Uf;const cs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},jf=t=>new TextEncoder().encode(t),$f=t=>new TextDecoder().decode(t);class Ff{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Bf{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return us(this,e)}}class zf{constructor(e){this.decoders=e}or(e){return us(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const us=(t,e)=>new zf({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Hf{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ff(e,r,n),this.decoder=new Bf(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Cr=({name:t,prefix:e,encode:r,decode:n})=>new Hf(t,e,r,n),ur=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Mf(r,e);return Cr({prefix:t,name:e,encode:n,decode:s=>cs(i(s))})},Kf=(t,e,r,n)=>{const i={};for(let _=0;_<e.length;++_)i[e[_]]=_;let s=t.length;for(;t[s-1]==="=";)--s;const c=new Uint8Array(s*r/8|0);let u=0,l=0,f=0;for(let _=0;_<s;++_){const O=i[t[_]];if(O===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|O,u+=r,u>=8&&(u-=8,c[f++]=255&l>>u)}if(u>=r||255&l<<8-u)throw new SyntaxError("Unexpected end of data");return c},Gf=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",c=0,u=0;for(let l=0;l<t.length;++l)for(u=u<<8|t[l],c+=8;c>r;)c-=r,s+=e[i&u>>c];if(c&&(s+=e[i&u<<r-c]),n)for(;s.length*r&7;)s+="=";return s},Ze=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Cr({prefix:e,name:t,encode(i){return Gf(i,n,r)},decode(i){return Kf(i,n,r,t)}}),Vf=Cr({prefix:"\0",name:"identity",encode:t=>$f(t),decode:t=>jf(t)});var qf=Object.freeze({__proto__:null,identity:Vf});const Wf=Ze({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Yf=Object.freeze({__proto__:null,base2:Wf});const kf=Ze({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Xf=Object.freeze({__proto__:null,base8:kf});const Jf=ur({prefix:"9",name:"base10",alphabet:"0123456789"});var Zf=Object.freeze({__proto__:null,base10:Jf});const Qf=Ze({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),el=Ze({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var tl=Object.freeze({__proto__:null,base16:Qf,base16upper:el});const rl=Ze({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),nl=Ze({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),il=Ze({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sl=Ze({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ol=Ze({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),al=Ze({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cl=Ze({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ul=Ze({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fl=Ze({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ll=Object.freeze({__proto__:null,base32:rl,base32upper:nl,base32pad:il,base32padupper:sl,base32hex:ol,base32hexupper:al,base32hexpad:cl,base32hexpadupper:ul,base32z:fl});const hl=ur({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),dl=ur({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var gl=Object.freeze({__proto__:null,base36:hl,base36upper:dl});const _l=ur({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yl=ur({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var pl=Object.freeze({__proto__:null,base58btc:_l,base58flickr:yl});const bl=Ze({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),vl=Ze({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),El=Ze({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),wl=Ze({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ml=Object.freeze({__proto__:null,base64:bl,base64pad:vl,base64url:El,base64urlpad:wl});const fs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Dl=fs.reduce((t,e,r)=>(t[r]=e,t),[]),Sl=fs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Ol(t){return t.reduce((e,r)=>(e+=Dl[r],e),"")}function Tl(t){const e=[];for(const r of t){const n=Sl[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const xl=Cr({prefix:"\u{1F680}",name:"base256emoji",encode:Ol,decode:Tl});var Il=Object.freeze({__proto__:null,base256emoji:xl}),Rl=hs,ls=128,Cl=127,Al=~Cl,Pl=Math.pow(2,31);function hs(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Pl;)e[r++]=t&255|ls,t/=128;for(;t&Al;)e[r++]=t&255|ls,t>>>=7;return e[r]=t|0,hs.bytes=r-n+1,e}var Ll=Tn,Nl=128,ds=127;function Tn(t,n){var r=0,n=n||0,i=0,s=n,c,u=t.length;do{if(s>=u)throw Tn.bytes=0,new RangeError("Could not decode varint");c=t[s++],r+=i<28?(c&ds)<<i:(c&ds)*Math.pow(2,i),i+=7}while(c>=Nl);return Tn.bytes=s-n,r}var Ul=Math.pow(2,7),Ml=Math.pow(2,14),jl=Math.pow(2,21),$l=Math.pow(2,28),Fl=Math.pow(2,35),Bl=Math.pow(2,42),zl=Math.pow(2,49),Hl=Math.pow(2,56),Kl=Math.pow(2,63),Gl=function(t){return t<Ul?1:t<Ml?2:t<jl?3:t<$l?4:t<Fl?5:t<Bl?6:t<zl?7:t<Hl?8:t<Kl?9:10},Vl={encode:Rl,decode:Ll,encodingLength:Gl},gs=Vl;const _s=(t,e,r=0)=>(gs.encode(t,e,r),e),ys=t=>gs.encodingLength(t),xn=(t,e)=>{const r=e.byteLength,n=ys(t),i=n+ys(r),s=new Uint8Array(i+r);return _s(t,s,0),_s(r,s,n),s.set(e,i),new ql(t,r,e,s)};class ql{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const ps=({name:t,code:e,encode:r})=>new Wl(t,e,r);class Wl{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?xn(this.code,r):r.then(n=>xn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const bs=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Yl=ps({name:"sha2-256",code:18,encode:bs("SHA-256")}),kl=ps({name:"sha2-512",code:19,encode:bs("SHA-512")});var Xl=Object.freeze({__proto__:null,sha256:Yl,sha512:kl});const vs=0,Jl="identity",Es=cs;var Zl=Object.freeze({__proto__:null,identity:{code:vs,name:Jl,encode:Es,digest:t=>xn(vs,Es(t))}});new TextEncoder,new TextDecoder;const ws={...qf,...Yf,...Xf,...Zf,...tl,...ll,...gl,...pl,...ml,...Il};({...Xl,...Zl});function ms(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Ds=ms("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),In=ms("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=as(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ss={utf8:Ds,"utf-8":Ds,hex:ws.base16,latin1:In,ascii:In,binary:In,...ws};function nt(t,e="utf8"){const r=Ss[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function it(t,e="utf8"){const r=Ss[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sn(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Ar(t){return nt(it(bn(t),Tf),ss)}function Os(t){const e=it(Pf,os),r=Af+nt(On([e,t]),os);return[Rf,Cf,r].join(If)}function Ql(t){return nt(t,ss)}function eh(t){return it([Ar(t.header),Ar(t.payload)].join(is),xf)}function th(t){return[Ar(t.header),Ar(t.payload),Ql(t.signature)].join(is)}function Ts(t=Gt.randomBytes(Lf)){return vn.generateKeyPairFromSeed(t)}async function rh(t,e,r,n,i=oe.fromMiliseconds(Date.now())){const s={alg:Sf,typ:Of},c=Os(n.publicKey),u=i+r,l={iss:c,sub:t,aud:e,iat:i,exp:u},f=eh({header:s,payload:l}),_=vn.sign(n.secretKey,f);return th({header:s,payload:l,signature:_})}var Rn={},Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});var et=re,Cn=ot,nh=20;function ih(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,c=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],l=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],_=r[15]<<24|r[14]<<16|r[13]<<8|r[12],O=r[19]<<24|r[18]<<16|r[17]<<8|r[16],p=r[23]<<24|r[22]<<16|r[21]<<8|r[20],E=r[27]<<24|r[26]<<16|r[25]<<8|r[24],C=r[31]<<24|r[30]<<16|r[29]<<8|r[28],A=e[3]<<24|e[2]<<16|e[1]<<8|e[0],U=e[7]<<24|e[6]<<16|e[5]<<8|e[4],W=e[11]<<24|e[10]<<16|e[9]<<8|e[8],S=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=n,b=i,v=s,d=c,o=u,h=l,L=f,P=_,H=O,G=p,J=E,D=C,I=A,V=U,F=W,M=S,$=0;$<nh;$+=2)R=R+o|0,I^=R,I=I>>>32-16|I<<16,H=H+I|0,o^=H,o=o>>>32-12|o<<12,b=b+h|0,V^=b,V=V>>>32-16|V<<16,G=G+V|0,h^=G,h=h>>>32-12|h<<12,v=v+L|0,F^=v,F=F>>>32-16|F<<16,J=J+F|0,L^=J,L=L>>>32-12|L<<12,d=d+P|0,M^=d,M=M>>>32-16|M<<16,D=D+M|0,P^=D,P=P>>>32-12|P<<12,v=v+L|0,F^=v,F=F>>>32-8|F<<8,J=J+F|0,L^=J,L=L>>>32-7|L<<7,d=d+P|0,M^=d,M=M>>>32-8|M<<8,D=D+M|0,P^=D,P=P>>>32-7|P<<7,b=b+h|0,V^=b,V=V>>>32-8|V<<8,G=G+V|0,h^=G,h=h>>>32-7|h<<7,R=R+o|0,I^=R,I=I>>>32-8|I<<8,H=H+I|0,o^=H,o=o>>>32-7|o<<7,R=R+h|0,M^=R,M=M>>>32-16|M<<16,J=J+M|0,h^=J,h=h>>>32-12|h<<12,b=b+L|0,I^=b,I=I>>>32-16|I<<16,D=D+I|0,L^=D,L=L>>>32-12|L<<12,v=v+P|0,V^=v,V=V>>>32-16|V<<16,H=H+V|0,P^=H,P=P>>>32-12|P<<12,d=d+o|0,F^=d,F=F>>>32-16|F<<16,G=G+F|0,o^=G,o=o>>>32-12|o<<12,v=v+P|0,V^=v,V=V>>>32-8|V<<8,H=H+V|0,P^=H,P=P>>>32-7|P<<7,d=d+o|0,F^=d,F=F>>>32-8|F<<8,G=G+F|0,o^=G,o=o>>>32-7|o<<7,b=b+L|0,I^=b,I=I>>>32-8|I<<8,D=D+I|0,L^=D,L=L>>>32-7|L<<7,R=R+h|0,M^=R,M=M>>>32-8|M<<8,J=J+M|0,h^=J,h=h>>>32-7|h<<7;et.writeUint32LE(R+n|0,t,0),et.writeUint32LE(b+i|0,t,4),et.writeUint32LE(v+s|0,t,8),et.writeUint32LE(d+c|0,t,12),et.writeUint32LE(o+u|0,t,16),et.writeUint32LE(h+l|0,t,20),et.writeUint32LE(L+f|0,t,24),et.writeUint32LE(P+_|0,t,28),et.writeUint32LE(H+O|0,t,32),et.writeUint32LE(G+p|0,t,36),et.writeUint32LE(J+E|0,t,40),et.writeUint32LE(D+C|0,t,44),et.writeUint32LE(I+A|0,t,48),et.writeUint32LE(V+U|0,t,52),et.writeUint32LE(F+W|0,t,56),et.writeUint32LE(M+S|0,t,60)}function xs(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,c;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),c=s.length-e.length,s.set(e,c)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,c=i}for(var u=new Uint8Array(64),l=0;l<r.length;l+=64){ih(u,s,t);for(var f=l;f<l+64&&f<r.length;f++)n[f]=r[f]^u[f-l];oh(s,0,c)}return Cn.wipe(u),i===0&&Cn.wipe(s),n}Pr.streamXOR=xs;function sh(t,e,r,n){return n===void 0&&(n=0),Cn.wipe(r),xs(t,e,r,r,n)}Pr.stream=sh;function oh(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var Is={},St={};Object.defineProperty(St,"__esModule",{value:!0});function ah(t,e,r){return~(t-1)&e|t-1&r}St.select=ah;function ch(t,e){return(t|0)-(e|0)-1>>>31&1}St.lessOrEqual=ch;function Rs(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}St.compare=Rs;function uh(t,e){return t.length===0||e.length===0?!1:Rs(t,e)!==0}St.equal=uh,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=St,r=ot;t.DIGEST_LENGTH=16;var n=function(){function c(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var l=u[0]|u[1]<<8;this._r[0]=l&8191;var f=u[2]|u[3]<<8;this._r[1]=(l>>>13|f<<3)&8191;var _=u[4]|u[5]<<8;this._r[2]=(f>>>10|_<<6)&7939;var O=u[6]|u[7]<<8;this._r[3]=(_>>>7|O<<9)&8191;var p=u[8]|u[9]<<8;this._r[4]=(O>>>4|p<<12)&255,this._r[5]=p>>>1&8190;var E=u[10]|u[11]<<8;this._r[6]=(p>>>14|E<<2)&8191;var C=u[12]|u[13]<<8;this._r[7]=(E>>>11|C<<5)&8065;var A=u[14]|u[15]<<8;this._r[8]=(C>>>8|A<<8)&8191,this._r[9]=A>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return c.prototype._blocks=function(u,l,f){for(var _=this._fin?0:2048,O=this._h[0],p=this._h[1],E=this._h[2],C=this._h[3],A=this._h[4],U=this._h[5],W=this._h[6],S=this._h[7],R=this._h[8],b=this._h[9],v=this._r[0],d=this._r[1],o=this._r[2],h=this._r[3],L=this._r[4],P=this._r[5],H=this._r[6],G=this._r[7],J=this._r[8],D=this._r[9];f>=16;){var I=u[l+0]|u[l+1]<<8;O+=I&8191;var V=u[l+2]|u[l+3]<<8;p+=(I>>>13|V<<3)&8191;var F=u[l+4]|u[l+5]<<8;E+=(V>>>10|F<<6)&8191;var M=u[l+6]|u[l+7]<<8;C+=(F>>>7|M<<9)&8191;var $=u[l+8]|u[l+9]<<8;A+=(M>>>4|$<<12)&8191,U+=$>>>1&8191;var N=u[l+10]|u[l+11]<<8;W+=($>>>14|N<<2)&8191;var B=u[l+12]|u[l+13]<<8;S+=(N>>>11|B<<5)&8191;var ee=u[l+14]|u[l+15]<<8;R+=(B>>>8|ee<<8)&8191,b+=ee>>>5|_;var z=0,Z=z;Z+=O*v,Z+=p*(5*D),Z+=E*(5*J),Z+=C*(5*G),Z+=A*(5*H),z=Z>>>13,Z&=8191,Z+=U*(5*P),Z+=W*(5*L),Z+=S*(5*h),Z+=R*(5*o),Z+=b*(5*d),z+=Z>>>13,Z&=8191;var Y=z;Y+=O*d,Y+=p*v,Y+=E*(5*D),Y+=C*(5*J),Y+=A*(5*G),z=Y>>>13,Y&=8191,Y+=U*(5*H),Y+=W*(5*P),Y+=S*(5*L),Y+=R*(5*h),Y+=b*(5*o),z+=Y>>>13,Y&=8191;var Q=z;Q+=O*o,Q+=p*d,Q+=E*v,Q+=C*(5*D),Q+=A*(5*J),z=Q>>>13,Q&=8191,Q+=U*(5*G),Q+=W*(5*H),Q+=S*(5*P),Q+=R*(5*L),Q+=b*(5*h),z+=Q>>>13,Q&=8191;var x=z;x+=O*h,x+=p*o,x+=E*d,x+=C*v,x+=A*(5*D),z=x>>>13,x&=8191,x+=U*(5*J),x+=W*(5*G),x+=S*(5*H),x+=R*(5*P),x+=b*(5*L),z+=x>>>13,x&=8191;var T=z;T+=O*L,T+=p*h,T+=E*o,T+=C*d,T+=A*v,z=T>>>13,T&=8191,T+=U*(5*D),T+=W*(5*J),T+=S*(5*G),T+=R*(5*H),T+=b*(5*P),z+=T>>>13,T&=8191;var w=z;w+=O*P,w+=p*L,w+=E*h,w+=C*o,w+=A*d,z=w>>>13,w&=8191,w+=U*v,w+=W*(5*D),w+=S*(5*J),w+=R*(5*G),w+=b*(5*H),z+=w>>>13,w&=8191;var a=z;a+=O*H,a+=p*P,a+=E*L,a+=C*h,a+=A*o,z=a>>>13,a&=8191,a+=U*d,a+=W*v,a+=S*(5*D),a+=R*(5*J),a+=b*(5*G),z+=a>>>13,a&=8191;var y=z;y+=O*G,y+=p*H,y+=E*P,y+=C*L,y+=A*h,z=y>>>13,y&=8191,y+=U*o,y+=W*d,y+=S*v,y+=R*(5*D),y+=b*(5*J),z+=y>>>13,y&=8191;var K=z;K+=O*J,K+=p*G,K+=E*H,K+=C*P,K+=A*L,z=K>>>13,K&=8191,K+=U*h,K+=W*o,K+=S*d,K+=R*v,K+=b*(5*D),z+=K>>>13,K&=8191;var q=z;q+=O*D,q+=p*J,q+=E*G,q+=C*H,q+=A*P,z=q>>>13,q&=8191,q+=U*L,q+=W*h,q+=S*o,q+=R*d,q+=b*v,z+=q>>>13,q&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,Y+=z,O=Z,p=Y,E=Q,C=x,A=T,U=w,W=a,S=y,R=K,b=q,l+=16,f-=16}this._h[0]=O,this._h[1]=p,this._h[2]=E,this._h[3]=C,this._h[4]=A,this._h[5]=U,this._h[6]=W,this._h[7]=S,this._h[8]=R,this._h[9]=b},c.prototype.finish=function(u,l){l===void 0&&(l=0);var f=new Uint16Array(10),_,O,p,E;if(this._leftover){for(E=this._leftover,this._buffer[E++]=1;E<16;E++)this._buffer[E]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(_=this._h[1]>>>13,this._h[1]&=8191,E=2;E<10;E++)this._h[E]+=_,_=this._h[E]>>>13,this._h[E]&=8191;for(this._h[0]+=_*5,_=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=_,_=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=_,f[0]=this._h[0]+5,_=f[0]>>>13,f[0]&=8191,E=1;E<10;E++)f[E]=this._h[E]+_,_=f[E]>>>13,f[E]&=8191;for(f[9]-=8192,O=(_^1)-1,E=0;E<10;E++)f[E]&=O;for(O=~O,E=0;E<10;E++)this._h[E]=this._h[E]&O|f[E];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,p=this._h[0]+this._pad[0],this._h[0]=p&65535,E=1;E<8;E++)p=(this._h[E]+this._pad[E]|0)+(p>>>16)|0,this._h[E]=p&65535;return u[l+0]=this._h[0]>>>0,u[l+1]=this._h[0]>>>8,u[l+2]=this._h[1]>>>0,u[l+3]=this._h[1]>>>8,u[l+4]=this._h[2]>>>0,u[l+5]=this._h[2]>>>8,u[l+6]=this._h[3]>>>0,u[l+7]=this._h[3]>>>8,u[l+8]=this._h[4]>>>0,u[l+9]=this._h[4]>>>8,u[l+10]=this._h[5]>>>0,u[l+11]=this._h[5]>>>8,u[l+12]=this._h[6]>>>0,u[l+13]=this._h[6]>>>8,u[l+14]=this._h[7]>>>0,u[l+15]=this._h[7]>>>8,this._finished=!0,this},c.prototype.update=function(u){var l=0,f=u.length,_;if(this._leftover){_=16-this._leftover,_>f&&(_=f);for(var O=0;O<_;O++)this._buffer[this._leftover+O]=u[l+O];if(f-=_,l+=_,this._leftover+=_,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(_=f-f%16,this._blocks(u,l,_),l+=_,f-=_),f){for(var O=0;O<f;O++)this._buffer[this._leftover+O]=u[l+O];this._leftover+=f}return this},c.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},c.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},c}();t.Poly1305=n;function i(c,u){var l=new n(c);l.update(u);var f=l.digest();return l.clean(),f}t.oneTimeAuth=i;function s(c,u){return c.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(c,u)}t.equal=s}(Is),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Pr,r=Is,n=ot,i=re,s=St;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var c=new Uint8Array(16),u=function(){function l(f){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,f.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return l.prototype.seal=function(f,_,O,p){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var E=new Uint8Array(16);E.set(f,E.length-f.length);var C=new Uint8Array(32);e.stream(this._key,E,C,4);var A=_.length+this.tagLength,U;if(p){if(p.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");U=p}else U=new Uint8Array(A);return e.streamXOR(this._key,E,_,U,4),this._authenticate(U.subarray(U.length-this.tagLength,U.length),C,U.subarray(0,U.length-this.tagLength),O),n.wipe(E),U},l.prototype.open=function(f,_,O,p){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(_.length<this.tagLength)return null;var E=new Uint8Array(16);E.set(f,E.length-f.length);var C=new Uint8Array(32);e.stream(this._key,E,C,4);var A=new Uint8Array(this.tagLength);if(this._authenticate(A,C,_.subarray(0,_.length-this.tagLength),O),!s.equal(A,_.subarray(_.length-this.tagLength,_.length)))return null;var U=_.length-this.tagLength,W;if(p){if(p.length!==U)throw new Error("ChaCha20Poly1305: incorrect destination length");W=p}else W=new Uint8Array(U);return e.streamXOR(this._key,E,_.subarray(0,_.length-this.tagLength),W,4),n.wipe(E),W},l.prototype.clean=function(){return n.wipe(this._key),this},l.prototype._authenticate=function(f,_,O,p){var E=new r.Poly1305(_);p&&(E.update(p),p.length%16>0&&E.update(c.subarray(p.length%16))),E.update(O),O.length%16>0&&E.update(c.subarray(O.length%16));var C=new Uint8Array(8);p&&i.writeUint64LE(p.length,C),E.update(C),i.writeUint64LE(O.length,C),E.update(C);for(var A=E.digest(),U=0;U<A.length;U++)f[U]=A[U];E.clean(),n.wipe(A),n.wipe(C)},l}();t.ChaCha20Poly1305=u}(Rn);var Cs={},fr={},An={};Object.defineProperty(An,"__esModule",{value:!0});function fh(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}An.isSerializableHash=fh,Object.defineProperty(fr,"__esModule",{value:!0});var pt=An,lh=St,hh=ot,As=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),pt.isSerializableHash(this._inner)&&pt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),hh.wipe(n)}return t.prototype.reset=function(){if(!pt.isSerializableHash(this._inner)||!pt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){pt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),pt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!pt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!pt.isSerializableHash(this._inner)||!pt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!pt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();fr.HMAC=As;function dh(t,e,r){var n=new As(t,e);n.update(r);var i=n.digest();return n.clean(),i}fr.hmac=dh,fr.equal=lh.equal,Object.defineProperty(Cs,"__esModule",{value:!0});var Ps=fr,Ls=ot,gh=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=Ps.hmac(this._hash,n,r);this._hmac=new Ps.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Ls.wipe(this._buffer),Ls.wipe(this._counter),this._bufpos=0},t}(),_h=Cs.HKDF=gh,Lr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ot;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(l,f){if(f===void 0&&(f=l.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var _=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=l[_++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(_=s(this._temp,this._state,l,_,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=l[_++],f--;return this},u.prototype.finish=function(l){if(!this._finished){var f=this._bytesHashed,_=this._bufferLength,O=f/536870912|0,p=f<<3,E=f%64<56?64:128;this._buffer[_]=128;for(var C=_+1;C<E-8;C++)this._buffer[C]=0;e.writeUint32BE(O,this._buffer,E-8),e.writeUint32BE(p,this._buffer,E-4),s(this._temp,this._state,this._buffer,0,E),this._finished=!0}for(var C=0;C<this.digestLength/4;C++)e.writeUint32BE(this._state[C],l,C*4);return this},u.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(l){return this._state.set(l.state),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(l){r.wipe(l.state),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},u}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,l,f,_,O){for(;O>=64;){for(var p=l[0],E=l[1],C=l[2],A=l[3],U=l[4],W=l[5],S=l[6],R=l[7],b=0;b<16;b++){var v=_+b*4;u[b]=e.readUint32BE(f,v)}for(var b=16;b<64;b++){var d=u[b-2],o=(d>>>17|d<<32-17)^(d>>>19|d<<32-19)^d>>>10;d=u[b-15];var h=(d>>>7|d<<32-7)^(d>>>18|d<<32-18)^d>>>3;u[b]=(o+u[b-7]|0)+(h+u[b-16]|0)}for(var b=0;b<64;b++){var o=(((U>>>6|U<<26)^(U>>>11|U<<21)^(U>>>25|U<<7))+(U&W^~U&S)|0)+(R+(i[b]+u[b]|0)|0)|0,h=((p>>>2|p<<32-2)^(p>>>13|p<<32-13)^(p>>>22|p<<32-22))+(p&E^p&C^E&C)|0;R=S,S=W,W=U,U=A+o|0,A=C,C=E,E=p,p=o+h|0}l[0]+=p,l[1]+=E,l[2]+=C,l[3]+=A,l[4]+=U,l[5]+=W,l[6]+=S,l[7]+=R,_+=64,O-=64}return _}function c(u){var l=new n;l.update(u);var f=l.digest();return l.clean(),f}t.hash=c})(Lr);var Pn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=Gt,r=ot;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(b){const v=new Float64Array(16);if(b)for(let d=0;d<b.length;d++)v[d]=b[d];return v}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function c(b){let v=1;for(let d=0;d<16;d++){let o=b[d]+v+65535;v=Math.floor(o/65536),b[d]=o-v*65536}b[0]+=v-1+37*(v-1)}function u(b,v,d){const o=~(d-1);for(let h=0;h<16;h++){const L=o&(b[h]^v[h]);b[h]^=L,v[h]^=L}}function l(b,v){const d=n(),o=n();for(let h=0;h<16;h++)o[h]=v[h];c(o),c(o),c(o);for(let h=0;h<2;h++){d[0]=o[0]-65517;for(let P=1;P<15;P++)d[P]=o[P]-65535-(d[P-1]>>16&1),d[P-1]&=65535;d[15]=o[15]-32767-(d[14]>>16&1);const L=d[15]>>16&1;d[14]&=65535,u(o,d,1-L)}for(let h=0;h<16;h++)b[2*h]=o[h]&255,b[2*h+1]=o[h]>>8}function f(b,v){for(let d=0;d<16;d++)b[d]=v[2*d]+(v[2*d+1]<<8);b[15]&=32767}function _(b,v,d){for(let o=0;o<16;o++)b[o]=v[o]+d[o]}function O(b,v,d){for(let o=0;o<16;o++)b[o]=v[o]-d[o]}function p(b,v,d){let o,h,L=0,P=0,H=0,G=0,J=0,D=0,I=0,V=0,F=0,M=0,$=0,N=0,B=0,ee=0,z=0,Z=0,Y=0,Q=0,x=0,T=0,w=0,a=0,y=0,K=0,q=0,le=0,pe=0,de=0,Ee=0,Ue=0,Ae=0,ye=d[0],ge=d[1],he=d[2],ue=d[3],ce=d[4],ae=d[5],se=d[6],te=d[7],fe=d[8],_e=d[9],ne=d[10],be=d[11],ve=d[12],me=d[13],De=d[14],we=d[15];o=v[0],L+=o*ye,P+=o*ge,H+=o*he,G+=o*ue,J+=o*ce,D+=o*ae,I+=o*se,V+=o*te,F+=o*fe,M+=o*_e,$+=o*ne,N+=o*be,B+=o*ve,ee+=o*me,z+=o*De,Z+=o*we,o=v[1],P+=o*ye,H+=o*ge,G+=o*he,J+=o*ue,D+=o*ce,I+=o*ae,V+=o*se,F+=o*te,M+=o*fe,$+=o*_e,N+=o*ne,B+=o*be,ee+=o*ve,z+=o*me,Z+=o*De,Y+=o*we,o=v[2],H+=o*ye,G+=o*ge,J+=o*he,D+=o*ue,I+=o*ce,V+=o*ae,F+=o*se,M+=o*te,$+=o*fe,N+=o*_e,B+=o*ne,ee+=o*be,z+=o*ve,Z+=o*me,Y+=o*De,Q+=o*we,o=v[3],G+=o*ye,J+=o*ge,D+=o*he,I+=o*ue,V+=o*ce,F+=o*ae,M+=o*se,$+=o*te,N+=o*fe,B+=o*_e,ee+=o*ne,z+=o*be,Z+=o*ve,Y+=o*me,Q+=o*De,x+=o*we,o=v[4],J+=o*ye,D+=o*ge,I+=o*he,V+=o*ue,F+=o*ce,M+=o*ae,$+=o*se,N+=o*te,B+=o*fe,ee+=o*_e,z+=o*ne,Z+=o*be,Y+=o*ve,Q+=o*me,x+=o*De,T+=o*we,o=v[5],D+=o*ye,I+=o*ge,V+=o*he,F+=o*ue,M+=o*ce,$+=o*ae,N+=o*se,B+=o*te,ee+=o*fe,z+=o*_e,Z+=o*ne,Y+=o*be,Q+=o*ve,x+=o*me,T+=o*De,w+=o*we,o=v[6],I+=o*ye,V+=o*ge,F+=o*he,M+=o*ue,$+=o*ce,N+=o*ae,B+=o*se,ee+=o*te,z+=o*fe,Z+=o*_e,Y+=o*ne,Q+=o*be,x+=o*ve,T+=o*me,w+=o*De,a+=o*we,o=v[7],V+=o*ye,F+=o*ge,M+=o*he,$+=o*ue,N+=o*ce,B+=o*ae,ee+=o*se,z+=o*te,Z+=o*fe,Y+=o*_e,Q+=o*ne,x+=o*be,T+=o*ve,w+=o*me,a+=o*De,y+=o*we,o=v[8],F+=o*ye,M+=o*ge,$+=o*he,N+=o*ue,B+=o*ce,ee+=o*ae,z+=o*se,Z+=o*te,Y+=o*fe,Q+=o*_e,x+=o*ne,T+=o*be,w+=o*ve,a+=o*me,y+=o*De,K+=o*we,o=v[9],M+=o*ye,$+=o*ge,N+=o*he,B+=o*ue,ee+=o*ce,z+=o*ae,Z+=o*se,Y+=o*te,Q+=o*fe,x+=o*_e,T+=o*ne,w+=o*be,a+=o*ve,y+=o*me,K+=o*De,q+=o*we,o=v[10],$+=o*ye,N+=o*ge,B+=o*he,ee+=o*ue,z+=o*ce,Z+=o*ae,Y+=o*se,Q+=o*te,x+=o*fe,T+=o*_e,w+=o*ne,a+=o*be,y+=o*ve,K+=o*me,q+=o*De,le+=o*we,o=v[11],N+=o*ye,B+=o*ge,ee+=o*he,z+=o*ue,Z+=o*ce,Y+=o*ae,Q+=o*se,x+=o*te,T+=o*fe,w+=o*_e,a+=o*ne,y+=o*be,K+=o*ve,q+=o*me,le+=o*De,pe+=o*we,o=v[12],B+=o*ye,ee+=o*ge,z+=o*he,Z+=o*ue,Y+=o*ce,Q+=o*ae,x+=o*se,T+=o*te,w+=o*fe,a+=o*_e,y+=o*ne,K+=o*be,q+=o*ve,le+=o*me,pe+=o*De,de+=o*we,o=v[13],ee+=o*ye,z+=o*ge,Z+=o*he,Y+=o*ue,Q+=o*ce,x+=o*ae,T+=o*se,w+=o*te,a+=o*fe,y+=o*_e,K+=o*ne,q+=o*be,le+=o*ve,pe+=o*me,de+=o*De,Ee+=o*we,o=v[14],z+=o*ye,Z+=o*ge,Y+=o*he,Q+=o*ue,x+=o*ce,T+=o*ae,w+=o*se,a+=o*te,y+=o*fe,K+=o*_e,q+=o*ne,le+=o*be,pe+=o*ve,de+=o*me,Ee+=o*De,Ue+=o*we,o=v[15],Z+=o*ye,Y+=o*ge,Q+=o*he,x+=o*ue,T+=o*ce,w+=o*ae,a+=o*se,y+=o*te,K+=o*fe,q+=o*_e,le+=o*ne,pe+=o*be,de+=o*ve,Ee+=o*me,Ue+=o*De,Ae+=o*we,L+=38*Y,P+=38*Q,H+=38*x,G+=38*T,J+=38*w,D+=38*a,I+=38*y,V+=38*K,F+=38*q,M+=38*le,$+=38*pe,N+=38*de,B+=38*Ee,ee+=38*Ue,z+=38*Ae,h=1,o=L+h+65535,h=Math.floor(o/65536),L=o-h*65536,o=P+h+65535,h=Math.floor(o/65536),P=o-h*65536,o=H+h+65535,h=Math.floor(o/65536),H=o-h*65536,o=G+h+65535,h=Math.floor(o/65536),G=o-h*65536,o=J+h+65535,h=Math.floor(o/65536),J=o-h*65536,o=D+h+65535,h=Math.floor(o/65536),D=o-h*65536,o=I+h+65535,h=Math.floor(o/65536),I=o-h*65536,o=V+h+65535,h=Math.floor(o/65536),V=o-h*65536,o=F+h+65535,h=Math.floor(o/65536),F=o-h*65536,o=M+h+65535,h=Math.floor(o/65536),M=o-h*65536,o=$+h+65535,h=Math.floor(o/65536),$=o-h*65536,o=N+h+65535,h=Math.floor(o/65536),N=o-h*65536,o=B+h+65535,h=Math.floor(o/65536),B=o-h*65536,o=ee+h+65535,h=Math.floor(o/65536),ee=o-h*65536,o=z+h+65535,h=Math.floor(o/65536),z=o-h*65536,o=Z+h+65535,h=Math.floor(o/65536),Z=o-h*65536,L+=h-1+37*(h-1),h=1,o=L+h+65535,h=Math.floor(o/65536),L=o-h*65536,o=P+h+65535,h=Math.floor(o/65536),P=o-h*65536,o=H+h+65535,h=Math.floor(o/65536),H=o-h*65536,o=G+h+65535,h=Math.floor(o/65536),G=o-h*65536,o=J+h+65535,h=Math.floor(o/65536),J=o-h*65536,o=D+h+65535,h=Math.floor(o/65536),D=o-h*65536,o=I+h+65535,h=Math.floor(o/65536),I=o-h*65536,o=V+h+65535,h=Math.floor(o/65536),V=o-h*65536,o=F+h+65535,h=Math.floor(o/65536),F=o-h*65536,o=M+h+65535,h=Math.floor(o/65536),M=o-h*65536,o=$+h+65535,h=Math.floor(o/65536),$=o-h*65536,o=N+h+65535,h=Math.floor(o/65536),N=o-h*65536,o=B+h+65535,h=Math.floor(o/65536),B=o-h*65536,o=ee+h+65535,h=Math.floor(o/65536),ee=o-h*65536,o=z+h+65535,h=Math.floor(o/65536),z=o-h*65536,o=Z+h+65535,h=Math.floor(o/65536),Z=o-h*65536,L+=h-1+37*(h-1),b[0]=L,b[1]=P,b[2]=H,b[3]=G,b[4]=J,b[5]=D,b[6]=I,b[7]=V,b[8]=F,b[9]=M,b[10]=$,b[11]=N,b[12]=B,b[13]=ee,b[14]=z,b[15]=Z}function E(b,v){p(b,v,v)}function C(b,v){const d=n();for(let o=0;o<16;o++)d[o]=v[o];for(let o=253;o>=0;o--)E(d,d),o!==2&&o!==4&&p(d,d,v);for(let o=0;o<16;o++)b[o]=d[o]}function A(b,v){const d=new Uint8Array(32),o=new Float64Array(80),h=n(),L=n(),P=n(),H=n(),G=n(),J=n();for(let F=0;F<31;F++)d[F]=b[F];d[31]=b[31]&127|64,d[0]&=248,f(o,v);for(let F=0;F<16;F++)L[F]=o[F];h[0]=H[0]=1;for(let F=254;F>=0;--F){const M=d[F>>>3]>>>(F&7)&1;u(h,L,M),u(P,H,M),_(G,h,P),O(h,h,P),_(P,L,H),O(L,L,H),E(H,G),E(J,h),p(h,P,h),p(P,L,G),_(G,h,P),O(h,h,P),E(L,h),O(P,H,J),p(h,P,s),_(h,h,H),p(P,P,h),p(h,H,J),p(H,L,o),E(L,G),u(h,L,M),u(P,H,M)}for(let F=0;F<16;F++)o[F+16]=h[F],o[F+32]=P[F],o[F+48]=L[F],o[F+64]=H[F];const D=o.subarray(32),I=o.subarray(16);C(D,D),p(I,I,D);const V=new Uint8Array(32);return l(V,I),V}t.scalarMult=A;function U(b){return A(b,i)}t.scalarMultBase=U;function W(b){if(b.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(b);return{publicKey:U(v),secretKey:v}}t.generateKeyPairFromSeed=W;function S(b){const v=(0,e.randomBytes)(32,b),d=W(v);return(0,r.wipe)(v),d}t.generateKeyPair=S;function R(b,v,d=!1){if(b.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=A(b,v);if(d){let h=0;for(let L=0;L<o.length;L++)h|=o[L];if(h===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=R})(Pn);var Ns=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},yh=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),ph=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),bh=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),vh=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Eh=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),wh=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,mh=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Us=3,Dh=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",wh]],Ms=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Sh(t){return t?js(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Eh:typeof navigator<"u"?js(navigator.userAgent):xh()}function Oh(t){return t!==""&&Dh.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function js(t){var e=Oh(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new vh;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Us&&(i=Ns(Ns([],i,!0),Ih(Us-i.length),!0)):i=[];var s=i.join("."),c=Th(t),u=mh.exec(t);return u&&u[1]?new bh(r,s,c,u[1]):new yh(r,s,c)}function Th(t){for(var e=0,r=Ms.length;e<r;e++){var n=Ms[e],i=n[0],s=n[1],c=s.exec(t);if(c)return i}return null}function xh(){var t=typeof process<"u"&&process.version;return t?new ph(process.version.slice(1)):null}function Ih(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.getLocalStorage=Te.getLocalStorageOrThrow=Te.getCrypto=Te.getCryptoOrThrow=Fs=Te.getLocation=Te.getLocationOrThrow=Ln=Te.getNavigator=Te.getNavigatorOrThrow=$s=Te.getDocument=Te.getDocumentOrThrow=Te.getFromWindowOrThrow=Te.getFromWindow=void 0;function Ut(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Te.getFromWindow=Ut;function Vt(t){const e=Ut(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Te.getFromWindowOrThrow=Vt;function Rh(){return Vt("document")}Te.getDocumentOrThrow=Rh;function Ch(){return Ut("document")}var $s=Te.getDocument=Ch;function Ah(){return Vt("navigator")}Te.getNavigatorOrThrow=Ah;function Ph(){return Ut("navigator")}var Ln=Te.getNavigator=Ph;function Lh(){return Vt("location")}Te.getLocationOrThrow=Lh;function Nh(){return Ut("location")}var Fs=Te.getLocation=Nh;function Uh(){return Vt("crypto")}Te.getCryptoOrThrow=Uh;function Mh(){return Ut("crypto")}Te.getCrypto=Mh;function jh(){return Vt("localStorage")}Te.getLocalStorageOrThrow=jh;function $h(){return Ut("localStorage")}Te.getLocalStorage=$h;var Nn={};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.getWindowMetadata=void 0;const Bs=Te;function Fh(){let t,e;try{t=Bs.getDocumentOrThrow(),e=Bs.getLocationOrThrow()}catch{return null}function r(){const O=t.getElementsByTagName("link"),p=[];for(let E=0;E<O.length;E++){const C=O[E],A=C.getAttribute("rel");if(A&&A.toLowerCase().indexOf("icon")>-1){const U=C.getAttribute("href");if(U)if(U.toLowerCase().indexOf("https:")===-1&&U.toLowerCase().indexOf("http:")===-1&&U.indexOf("//")!==0){let W=e.protocol+"//"+e.host;if(U.indexOf("/")===0)W+=U;else{const S=e.pathname.split("/");S.pop();const R=S.join("/");W+=R+"/"+U}p.push(W)}else if(U.indexOf("//")===0){const W=e.protocol+U;p.push(W)}else p.push(U)}}return p}function n(...O){const p=t.getElementsByTagName("meta");for(let E=0;E<p.length;E++){const C=p[E],A=["itemprop","property","name"].map(U=>C.getAttribute(U)).filter(U=>U?O.includes(U):!1);if(A.length&&A){const U=C.getAttribute("content");if(U)return U}}return""}function i(){let O=n("name","og:site_name","og:title","twitter:title");return O||(O=t.title),O}function s(){return n("description","og:description","twitter:description","keywords")}const c=i(),u=s(),l=e.origin,f=r();return{description:u,url:l,icons:f,name:c}}Nn.getWindowMetadata=Fh;var lr={},Bh=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),zs="%[a-f0-9]{2}",Hs=new RegExp("("+zs+")|([^%]+?)","gi"),Ks=new RegExp("("+zs+")+","gi");function Un(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],Un(r),Un(n))}function zh(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Hs)||[],r=1;r<e.length;r++)t=Un(e,r).join(""),e=t.match(Hs)||[];return t}}function Hh(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Ks.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=zh(r[0]);n!==r[0]&&(e[r[0]]=n)}r=Ks.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var c=i[s];t=t.replace(new RegExp(c,"g"),e[c])}return t}var Kh=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Hh(t)}},Gh=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Vh=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var c=n[s],u=t[c];(i?e.indexOf(c)!==-1:e(c,u,t))&&(r[c]=u)}return r};(function(t){const e=Bh,r=Kh,n=Gh,i=Vh,s=S=>S==null,c=Symbol("encodeFragmentIdentifier");function u(S){switch(S.arrayFormat){case"index":return R=>(b,v)=>{const d=b.length;return v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,[_(R,S),"[",d,"]"].join("")]:[...b,[_(R,S),"[",_(d,S),"]=",_(v,S)].join("")]};case"bracket":return R=>(b,v)=>v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,[_(R,S),"[]"].join("")]:[...b,[_(R,S),"[]=",_(v,S)].join("")];case"colon-list-separator":return R=>(b,v)=>v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,[_(R,S),":list="].join("")]:[...b,[_(R,S),":list=",_(v,S)].join("")];case"comma":case"separator":case"bracket-separator":{const R=S.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(v,d)=>d===void 0||S.skipNull&&d===null||S.skipEmptyString&&d===""?v:(d=d===null?"":d,v.length===0?[[_(b,S),R,_(d,S)].join("")]:[[v,_(d,S)].join(S.arrayFormatSeparator)])}default:return R=>(b,v)=>v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,_(R,S)]:[...b,[_(R,S),"=",_(v,S)].join("")]}}function l(S){let R;switch(S.arrayFormat){case"index":return(b,v,d)=>{if(R=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!R){d[b]=v;return}d[b]===void 0&&(d[b]={}),d[b][R[1]]=v};case"bracket":return(b,v,d)=>{if(R=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!R){d[b]=v;return}if(d[b]===void 0){d[b]=[v];return}d[b]=[].concat(d[b],v)};case"colon-list-separator":return(b,v,d)=>{if(R=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!R){d[b]=v;return}if(d[b]===void 0){d[b]=[v];return}d[b]=[].concat(d[b],v)};case"comma":case"separator":return(b,v,d)=>{const o=typeof v=="string"&&v.includes(S.arrayFormatSeparator),h=typeof v=="string"&&!o&&O(v,S).includes(S.arrayFormatSeparator);v=h?O(v,S):v;const L=o||h?v.split(S.arrayFormatSeparator).map(P=>O(P,S)):v===null?v:O(v,S);d[b]=L};case"bracket-separator":return(b,v,d)=>{const o=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!o){d[b]=v&&O(v,S);return}const h=v===null?[]:v.split(S.arrayFormatSeparator).map(L=>O(L,S));if(d[b]===void 0){d[b]=h;return}d[b]=[].concat(d[b],h)};default:return(b,v,d)=>{if(d[b]===void 0){d[b]=v;return}d[b]=[].concat(d[b],v)}}}function f(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(S,R){return R.encode?R.strict?e(S):encodeURIComponent(S):S}function O(S,R){return R.decode?r(S):S}function p(S){return Array.isArray(S)?S.sort():typeof S=="object"?p(Object.keys(S)).sort((R,b)=>Number(R)-Number(b)).map(R=>S[R]):S}function E(S){const R=S.indexOf("#");return R!==-1&&(S=S.slice(0,R)),S}function C(S){let R="";const b=S.indexOf("#");return b!==-1&&(R=S.slice(b)),R}function A(S){S=E(S);const R=S.indexOf("?");return R===-1?"":S.slice(R+1)}function U(S,R){return R.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):R.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function W(S,R){R=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},R),f(R.arrayFormatSeparator);const b=l(R),v=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return v;for(const d of S.split("&")){if(d==="")continue;let[o,h]=n(R.decode?d.replace(/\+/g," "):d,"=");h=h===void 0?null:["comma","separator","bracket-separator"].includes(R.arrayFormat)?h:O(h,R),b(O(o,R),h,v)}for(const d of Object.keys(v)){const o=v[d];if(typeof o=="object"&&o!==null)for(const h of Object.keys(o))o[h]=U(o[h],R);else v[d]=U(o,R)}return R.sort===!1?v:(R.sort===!0?Object.keys(v).sort():Object.keys(v).sort(R.sort)).reduce((d,o)=>{const h=v[o];return h&&typeof h=="object"&&!Array.isArray(h)?d[o]=p(h):d[o]=h,d},Object.create(null))}t.extract=A,t.parse=W,t.stringify=(S,R)=>{if(!S)return"";R=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},R),f(R.arrayFormatSeparator);const b=h=>R.skipNull&&s(S[h])||R.skipEmptyString&&S[h]==="",v=u(R),d={};for(const h of Object.keys(S))b(h)||(d[h]=S[h]);const o=Object.keys(d);return R.sort!==!1&&o.sort(R.sort),o.map(h=>{const L=S[h];return L===void 0?"":L===null?_(h,R):Array.isArray(L)?L.length===0&&R.arrayFormat==="bracket-separator"?_(h,R)+"[]":L.reduce(v(h),[]).join("&"):_(h,R)+"="+_(L,R)}).filter(h=>h.length>0).join("&")},t.parseUrl=(S,R)=>{R=Object.assign({decode:!0},R);const[b,v]=n(S,"#");return Object.assign({url:b.split("?")[0]||"",query:W(A(S),R)},R&&R.parseFragmentIdentifier&&v?{fragmentIdentifier:O(v,R)}:{})},t.stringifyUrl=(S,R)=>{R=Object.assign({encode:!0,strict:!0,[c]:!0},R);const b=E(S.url).split("?")[0]||"",v=t.extract(S.url),d=t.parse(v,{sort:!1}),o=Object.assign(d,S.query);let h=t.stringify(o,R);h&&(h=`?${h}`);let L=C(S.url);return S.fragmentIdentifier&&(L=`#${R[c]?_(S.fragmentIdentifier,R):S.fragmentIdentifier}`),`${b}${h}${L}`},t.pick=(S,R,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[c]:!1},b);const{url:v,query:d,fragmentIdentifier:o}=t.parseUrl(S,b);return t.stringifyUrl({url:v,query:i(d,R),fragmentIdentifier:o},b)},t.exclude=(S,R,b)=>{const v=Array.isArray(R)?d=>!R.includes(d):(d,o)=>!R(d,o);return t.pick(S,v,b)}})(lr);const qh={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Gs="base10",st="base16",Mn="base64pad",jn="utf8",Vs=0,qt=1,Wh=0,qs=1,$n=12,Fn=32;function Yh(){const t=Pn.generateKeyPair();return{privateKey:nt(t.secretKey,st),publicKey:nt(t.publicKey,st)}}function Bn(){const t=Gt.randomBytes(Fn);return nt(t,st)}function kh(t,e){const r=Pn.sharedKey(it(t,st),it(e,st)),n=new _h(Lr.SHA256,r).expand(Fn);return nt(n,st)}function Xh(t){const e=Lr.hash(it(t,st));return nt(e,st)}function zn(t){const e=Lr.hash(it(t,jn));return nt(e,st)}function Jh(t){return it(`${t}`,Gs)}function hr(t){return Number(nt(t,Gs))}function Zh(t){const e=Jh(typeof t.type<"u"?t.type:Vs);if(hr(e)===qt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?it(t.senderPublicKey,st):void 0,n=typeof t.iv<"u"?it(t.iv,st):Gt.randomBytes($n),i=new Rn.ChaCha20Poly1305(it(t.symKey,st)).seal(n,it(t.message,jn));return ed({type:e,sealed:i,iv:n,senderPublicKey:r})}function Qh(t){const e=new Rn.ChaCha20Poly1305(it(t.symKey,st)),{sealed:r,iv:n}=Nr(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return nt(i,jn)}function ed(t){if(hr(t.type)===qt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return nt(On([t.type,t.senderPublicKey,t.iv,t.sealed]),Mn)}return nt(On([t.type,t.iv,t.sealed]),Mn)}function Nr(t){const e=it(t,Mn),r=e.slice(Wh,qs),n=qs;if(hr(r)===qt){const u=n+Fn,l=u+$n,f=e.slice(n,u),_=e.slice(u,l),O=e.slice(l);return{type:r,sealed:O,iv:_,senderPublicKey:f}}const i=n+$n,s=e.slice(n,i),c=e.slice(i);return{type:r,sealed:c,iv:s}}function td(t,e){const r=Nr(t);return Ws({type:hr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?nt(r.senderPublicKey,st):void 0,receiverPublicKey:e?.receiverPublicKey})}function Ws(t){const e=t?.type||Vs;if(e===qt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ys(t){return t.type===qt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var rd=Object.defineProperty,ks=Object.getOwnPropertySymbols,nd=Object.prototype.hasOwnProperty,id=Object.prototype.propertyIsEnumerable,Xs=(t,e,r)=>e in t?rd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Js=(t,e)=>{for(var r in e||(e={}))nd.call(e,r)&&Xs(t,r,e[r]);if(ks)for(var r of ks(e))id.call(e,r)&&Xs(t,r,e[r]);return t};const sd="ReactNative",Wt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},od="js";function Hn(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Zs(){return!$s()&&!!Ln()&&navigator.product===sd}function Qs(){return!Hn()&&!!Ln()}function eo(){return Zs()?Wt.reactNative:Hn()?Wt.node:Qs()?Wt.browser:Wt.unknown}function ad(t,e){let r=lr.parse(t);return r=Js(Js({},r),e),t=lr.stringify(r),t}function cd(){if(eo()===Wt.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=Sh();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function ud(){var t;const e=eo();return e===Wt.browser?[e,((t=Fs())==null?void 0:t.host)||"unknown"].join(":"):e}function fd(t,e,r){const n=cd(),i=ud();return[[t,e].join("-"),[od,r].join("-"),n,i].join("/")}function ld({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:c}){const u=r.split("?"),l=fd(t,e,n),f={auth:i,ua:l,projectId:s,useOnCloseEvent:c||void 0},_=ad(u[1]||"",f);return u[0]+"?"+_}function to(t){return Object.fromEntries(t.entries())}function ro(t){return new Map(Object.entries(t))}function hd(t=oe.FIVE_MINUTES,e){const r=oe.toMiliseconds(t||oe.FIVE_MINUTES);let n,i,s;return{resolve:c=>{s&&n&&(clearTimeout(s),n(c))},reject:c=>{s&&i&&(clearTimeout(s),i(c))},done:()=>new Promise((c,u)=>{s=setTimeout(()=>{u(new Error(e))},r),n=c,i=u})}}function Ur(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const c=await t;n(c)}catch(c){i(c)}clearTimeout(s)})}function no(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function dd(t){return no("topic",t)}function gd(t){return no("id",t)}function _d(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Mr(t,e){return oe.fromMiliseconds((e||Date.now())+oe.toMiliseconds(t))}function io(t){return Date.now()>=oe.toMiliseconds(t)}function Kn(t,e){return`${t}${e?`:${e}`:""}`}const yd="irn";function Gn(t){return t?.relay||{protocol:yd}}function jr(t){const e=qh[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var pd=Object.defineProperty,so=Object.getOwnPropertySymbols,bd=Object.prototype.hasOwnProperty,vd=Object.prototype.propertyIsEnumerable,oo=(t,e,r)=>e in t?pd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ed=(t,e)=>{for(var r in e||(e={}))bd.call(e,r)&&oo(t,r,e[r]);if(so)for(var r of so(e))vd.call(e,r)&&oo(t,r,e[r]);return t};function wd(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),c=t[i];r[s]=c}}),r}function md(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",c=lr.parse(s);return{protocol:n,topic:Dd(i[0]),version:parseInt(i[1],10),symKey:c.symKey,relay:wd(c)}}function Dd(t){return t.startsWith("//")?t.substring(2):t}function Sd(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function Od(t){return`${t.protocol}:${t.topic}@${t.version}?`+lr.stringify(Ed({symKey:t.symKey},Sd(t.relay)))}const Td={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},xd={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function xe(t,e){const{message:r,code:n}=xd[t];return{message:e?`${r} ${e}`:r,code:n}}function dr(t,e){const{message:r,code:n}=Td[t];return{message:e?`${r} ${e}`:r,code:n}}function Id(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function $r(t){return typeof t>"u"}function ao(t,e){return e&&$r(t)?!0:typeof t=="string"&&!!t.trim().length}function Rd(t){if(ao(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Cd(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Ad(t){return t?.topic}function Vn(t){return typeof t<"u"&&typeof t!==null}const qn="wc",co=2,Fr="core",vt=`${qn}@2:${Fr}:`,uo={name:Fr,logger:"error"},fo={database:":memory:"},lo="crypto",Wn="client_ed25519_seed",ho=oe.ONE_DAY,go="keychain",_o="0.3",yo="messages",po="0.3",bo=oe.SIX_HOURS,vo="publisher",Eo="irn",wo="error",Yn="wss://relay.walletconnect.com",kn="wss://relay.walletconnect.org",mo="relayer",ze={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Do="_subscription",Yt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},So=oe.ONE_SECOND/2,Pd={database:":memory:"},Oo="2.9.2",To=1e4,xo="0.3",Io="WALLETCONNECT_CLIENT_ID",dt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Ld=oe.THIRTY_DAYS,Ro="subscription",Co="0.3",Ao=oe.FIVE_SECONDS*1e3,Po="pairing",Lo="0.3",Nd=oe.THIRTY_DAYS,kt={wc_pairingDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:0},res:{ttl:oe.ONE_DAY,prompt:!1,tag:0}}},gt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},No="history",Uo="0.3",Mo="expirer",ft={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},jo="0.3",Ud=oe.ONE_DAY,Br="verify-api",Xn="https://verify.walletconnect.com";class $o{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=go,this.version=_o,this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=xe("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,to(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ro(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Fo{constructor(e,r,n){this.core=e,this.logger=r,this.name=lo,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Ts(i);return Os(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Yh();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),c=Ts(s),u=Bn();return await rh(u,i,ho,c)},this.generateSharedKey=(i,s,c)=>{this.isInitialized();const u=this.getPrivateKey(i),l=kh(u,s);return this.setSymKey(l,c)},this.setSymKey=async(i,s)=>{this.isInitialized();const c=s||Xh(i);return await this.keychain.set(c,i),c},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,c)=>{this.isInitialized();const u=Ws(c),l=bn(s);if(Ys(u)){const p=u.senderPublicKey,E=u.receiverPublicKey;i=await this.generateSharedKey(p,E)}const f=this.getSymKey(i),{type:_,senderPublicKey:O}=u;return Zh({type:_,symKey:f,message:l,senderPublicKey:O})},this.decode=async(i,s,c)=>{this.isInitialized();const u=td(s,c);if(Ys(u)){const l=u.receiverPublicKey,f=u.senderPublicKey;i=await this.generateSharedKey(l,f)}try{const l=this.getSymKey(i),f=Qh({symKey:l,encoded:s});return ki(f)}catch(l){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(l)}},this.getPayloadType=i=>{const s=Nr(i);return hr(s.type)},this.getPayloadSenderPublicKey=i=>{const s=Nr(i);return s.senderPublicKey?nt(s.senderPublicKey,st):void 0},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=n||new $o(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Wn)}catch{e=Bn(),await this.keychain.set(Wn,e)}return it(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Bo extends ju{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=yo,this.version=po,this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=zn(i);let c=this.messages.get(n);return typeof c>"u"&&(c={}),typeof c[s]<"u"||(c[s]=i,this.messages.set(n,c),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),c=zn(i);return typeof s[c]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,to(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ro(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}const Md="PARSE_ERROR",jd="INVALID_REQUEST",$d="METHOD_NOT_FOUND",Fd="INVALID_PARAMS",zo="INTERNAL_ERROR",Jn="SERVER_ERROR",Bd=[-32700,-32600,-32601,-32602,-32603],gr={[Md]:{code:-32700,message:"Parse error"},[jd]:{code:-32600,message:"Invalid Request"},[$d]:{code:-32601,message:"Method not found"},[Fd]:{code:-32602,message:"Invalid params"},[zo]:{code:-32603,message:"Internal error"},[Jn]:{code:-32e3,message:"Server error"}},Ho=Jn;function zd(t){return Bd.includes(t)}function Ko(t){return Object.keys(gr).includes(t)?gr[t]:gr[Ho]}function Hd(t){const e=Object.values(gr).find(r=>r.code===t);return e||gr[Ho]}function Kd(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Go={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Zn=function(t,e){return Zn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Zn(t,e)};function Gd(t,e){Zn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Qn=function(){return Qn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Qn.apply(this,arguments)};function Vd(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function qd(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Wd(t,e){return function(r,n){e(r,n,t)}}function Yd(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function kd(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function l(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,l)}f((n=n.apply(t,e||[])).next())})}function Xd(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return l([f,_])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Jd(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Zd(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ei(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Vo(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Qd(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Vo(arguments[e]));return t}function e0(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function _r(t){return this instanceof _r?(this.v=t,this):new _r(t)}function t0(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{l(n[p](E))}catch(C){O(s[0][3],C)}}function l(p){p.value instanceof _r?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function r0(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:_r(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function n0(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ei=="function"?ei(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,l){c=t[s](c),i(u,l,c.done,c.value)})}}function i(s,c,u,l){Promise.resolve(l).then(function(f){s({value:f,done:u})},c)}}function i0(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function s0(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function o0(t){return t&&t.__esModule?t:{default:t}}function a0(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function c0(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var u0=Object.freeze({__proto__:null,__extends:Gd,get __assign(){return Qn},__rest:Vd,__decorate:qd,__param:Wd,__metadata:Yd,__awaiter:kd,__generator:Xd,__createBinding:Jd,__exportStar:Zd,__values:ei,__read:Vo,__spread:Qd,__spreadArrays:e0,__await:_r,__asyncGenerator:t0,__asyncDelegator:r0,__asyncValues:n0,__makeTemplateObject:i0,__importStar:s0,__importDefault:o0,__classPrivateFieldGet:a0,__classPrivateFieldSet:c0}),f0=Rt(u0),Et={},qo;function l0(){if(qo)return Et;qo=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.isBrowserCryptoAvailable=Et.getSubtleCrypto=Et.getBrowerCrypto=void 0;function t(){return Je?.crypto||Je?.msCrypto||{}}Et.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Et.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Et.isBrowserCryptoAvailable=r,Et}var wt={},Wo;function h0(){if(Wo)return wt;Wo=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.isBrowser=wt.isNode=wt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}wt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}wt.isNode=e;function r(){return!t()&&!e()}return wt.isBrowser=r,wt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=f0;e.__exportStar(l0(),t),e.__exportStar(h0(),t)})(Go);function Yo(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function ko(t=6){return BigInt(Yo(t))}function ti(t,e,r){return{id:r||Yo(),jsonrpc:"2.0",method:t,params:e}}function Xo(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Jo(t,e,r){return{id:t,jsonrpc:"2.0",error:d0(e,r)}}function d0(t,e){return typeof t>"u"?Ko(zo):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ko(Jn)),{message:t})),typeof e<"u"&&(t.data=e),zd(t.code)&&(t=Hd(t.code)),t)}class g0{}class _0 extends g0{constructor(){super()}}class y0 extends _0{constructor(e){super()}}const p0="^wss?:";function b0(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function v0(t,e){const r=b0(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Zo(t){return v0(t,p0)}function E0(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Qo(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function ea(t){return Qo(t)&&"method"in t}function ri(t){return Qo(t)&&(ta(t)||zr(t))}function ta(t){return"result"in t}function zr(t){return"error"in t}class w0 extends y0{constructor(e){super(e),this.events=new ut.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ti(e.method,e.params||[],e.id||ko().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{zr(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ri(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const m0=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),D0=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ra=t=>t.split("?")[0],na=10,S0=m0();class O0{constructor(e){if(this.url=e,this.events=new ut.exports.EventEmitter,this.registering=!1,!Zo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(bn(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Zo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Go.isReactNative()?void 0:{rejectUnauthorized:!E0(e)},s=new S0(e,[],i);D0()?s.onerror=c=>{const u=c;n(this.emitError(u.error))}:s.on("error",c=>{n(this.emitError(c))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?ki(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Jo(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return Kd(e,ra(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>na&&this.events.setMaxListeners(na)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${ra(this.url)}`));return this.events.emit("register_error",r),r}}class T0 extends $u{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ut.exports.EventEmitter,this.name=vo,this.queue=new Map,this.publishTimeout=oe.toMiliseconds(oe.TEN_SECONDS),this.queueTimeout=oe.toMiliseconds(oe.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const c=s?.ttl||bo,u=Gn(s),l=s?.prompt||!1,f=s?.tag||0,_=s?.id||ko().toString(),O={topic:n,message:i,opts:{ttl:c,relay:u,prompt:l,tag:f,id:_}},p=setTimeout(()=>this.queue.set(_,O),this.queueTimeout);try{await await Ur(this.rpcPublish(n,i,c,u,l,f,_),this.publishTimeout),clearTimeout(p),this.relayer.events.emit(ze.publish,O)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(c){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(c),c}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,c,u){var l,f,_,O;const p={method:jr(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:c},id:u};return $r((l=p.params)==null?void 0:l.prompt)&&((f=p.params)==null||delete f.prompt),$r((_=p.params)==null?void 0:_.tag)&&((O=p.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p}),this.relayer.request(p)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ht.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ze.connection_stalled);return}this.checkQueue()}),this.relayer.on(ze.message_ack,e=>{this.onPublish(e.id.toString())})}}class x0{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var I0=Object.defineProperty,R0=Object.defineProperties,C0=Object.getOwnPropertyDescriptors,ia=Object.getOwnPropertySymbols,A0=Object.prototype.hasOwnProperty,P0=Object.prototype.propertyIsEnumerable,sa=(t,e,r)=>e in t?I0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yr=(t,e)=>{for(var r in e||(e={}))A0.call(e,r)&&sa(t,r,e[r]);if(ia)for(var r of ia(e))P0.call(e,r)&&sa(t,r,e[r]);return t},ni=(t,e)=>R0(t,C0(e));class oa extends zu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new x0,this.events=new ut.exports.EventEmitter,this.name=Ro,this.version=Co,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=vt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Gn(i),c={topic:n,relay:s};this.pending.set(n,c);const u=await this.rpcSubscribe(n,s);return this.onSubscribe(u,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const c=new oe.Watch;c.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),i(!0)),c.elapsed(this.pendingSubscriptionWatchLabel)>=Ao&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Gn(n);await this.rpcUnsubscribe(e,r,i);const s=dr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:jr(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Ur(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ze.connection_stalled)}return zn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:jr(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Ur(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ze.connection_stalled)}}rpcUnsubscribe(e,r,n){const i={method:jr(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,ni(yr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,yr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,yr({},r)),this.topicMap.set(r.topic,e),this.events.emit(dt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(dt.deleted,ni(yr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(dt.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(dt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Id(r)&&this.onBatchSubscribe(r.map((n,i)=>ni(yr({},e[i]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Ht.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(ze.connect,async()=>{await this.onConnect()}),this.relayer.on(ze.disconnect,()=>{this.onDisconnect()}),this.events.on(dt.created,async e=>{const r=dt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(dt.deleted,async e=>{const r=dt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var L0=Object.defineProperty,aa=Object.getOwnPropertySymbols,N0=Object.prototype.hasOwnProperty,U0=Object.prototype.propertyIsEnumerable,ca=(t,e,r)=>e in t?L0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,M0=(t,e)=>{for(var r in e||(e={}))N0.call(e,r)&&ca(t,r,e[r]);if(aa)for(var r of aa(e))U0.call(e,r)&&ca(t,r,e[r]);return t};class ua extends Fu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ut.exports.EventEmitter,this.name=mo,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Se.pino(Se.getDefaultLoggerOptions({level:e.logger||wo})),this.messages=new Bo(this.logger,e.core),this.subscriber=new oa(this,this.logger),this.publisher=new T0(this,this.logger),this.relayUrl=e?.relayUrl||Yn,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${kn}...`),await this.restartTransport(kn)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},To)}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var n;this.isInitialized();let i=((n=this.subscriber.topicMap.get(e))==null?void 0:n[0])||"";return i||(await Promise.all([new Promise(s=>{this.subscriber.once(dt.created,c=>{c.topic===e&&s()})}),new Promise(async s=>{i=await this.subscriber.subscribe(e,r),s()})]),i)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(ze.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(dt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,n)=>{await Ur(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(i=>n(i)).then(()=>r()).finally(()=>this.removeListener(ze.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(ze.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.events.emit(ze.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(Yt.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new w0(new O0(ld({sdkVersion:Oo,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const i=this.messages.has(r,n);return i&&this.logger.debug(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ea(e)){if(!e.method.endsWith(Do))return;const r=e.params,{topic:n,message:i,publishedAt:s}=r.data,c={topic:n,message:i,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(M0({type:"event",event:r.id},c)),this.events.emit(r.id,c),await this.acknowledgePayload(e),await this.onMessageEvent(c)}else ri(e)&&this.events.emit(ze.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(ze.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Xo(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Yt.payload,e=>this.onProviderPayload(e)),this.provider.on(Yt.connect,()=>{this.events.emit(ze.connect)}),this.provider.on(Yt.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Yt.error,e=>{this.logger.error(e),this.events.emit(ze.error,e)})}registerEventListeners(){this.events.on(ze.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(ze.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},oe.toMiliseconds(So))}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var ii={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,c=9007199254740991,u="[object Arguments]",l="[object Array]",f="[object AsyncFunction]",_="[object Boolean]",O="[object Date]",p="[object Error]",E="[object Function]",C="[object GeneratorFunction]",A="[object Map]",U="[object Number]",W="[object Null]",S="[object Object]",R="[object Promise]",b="[object Proxy]",v="[object RegExp]",d="[object Set]",o="[object String]",h="[object Symbol]",L="[object Undefined]",P="[object WeakMap]",H="[object ArrayBuffer]",G="[object DataView]",J="[object Float32Array]",D="[object Float64Array]",I="[object Int8Array]",V="[object Int16Array]",F="[object Int32Array]",M="[object Uint8Array]",$="[object Uint8ClampedArray]",N="[object Uint16Array]",B="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[D]=Y[I]=Y[V]=Y[F]=Y[M]=Y[$]=Y[N]=Y[B]=!0,Y[u]=Y[l]=Y[H]=Y[_]=Y[G]=Y[O]=Y[p]=Y[E]=Y[A]=Y[U]=Y[S]=Y[v]=Y[d]=Y[o]=Y[P]=!1;var Q=typeof Je=="object"&&Je&&Je.Object===Object&&Je,x=typeof self=="object"&&self&&self.Object===Object&&self,T=Q||x||Function("return this")(),w=e&&!e.nodeType&&e,a=w&&!0&&t&&!t.nodeType&&t,y=a&&a.exports===w,K=y&&Q.process,q=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),le=q&&q.isTypedArray;function pe(g,m){for(var j=-1,k=g==null?0:g.length,Ie=0,ie=[];++j<k;){var Ne=g[j];m(Ne,j,g)&&(ie[Ie++]=Ne)}return ie}function de(g,m){for(var j=-1,k=m.length,Ie=g.length;++j<k;)g[Ie+j]=m[j];return g}function Ee(g,m){for(var j=-1,k=g==null?0:g.length;++j<k;)if(m(g[j],j,g))return!0;return!1}function Ue(g,m){for(var j=-1,k=Array(g);++j<g;)k[j]=m(j);return k}function Ae(g){return function(m){return g(m)}}function ye(g,m){return g.has(m)}function ge(g,m){return g?.[m]}function he(g){var m=-1,j=Array(g.size);return g.forEach(function(k,Ie){j[++m]=[Ie,k]}),j}function ue(g,m){return function(j){return g(m(j))}}function ce(g){var m=-1,j=Array(g.size);return g.forEach(function(k){j[++m]=k}),j}var ae=Array.prototype,se=Function.prototype,te=Object.prototype,fe=T["__core-js_shared__"],_e=se.toString,ne=te.hasOwnProperty,be=function(){var g=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),ve=te.toString,me=RegExp("^"+_e.call(ne).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=y?T.Buffer:void 0,we=T.Symbol,_t=T.Uint8Array,bt=te.propertyIsEnumerable,Ot=ae.splice,at=we?we.toStringTag:void 0,Mt=Object.getOwnPropertySymbols,pr=De?De.isBuffer:void 0,Kr=ue(Object.keys,Object),Me=Xt(T,"DataView"),Pe=Xt(T,"Map"),je=Xt(T,"Promise"),$e=Xt(T,"Set"),Fe=Xt(T,"WeakMap"),Le=Xt(Object,"create"),Ke=$t(Me),Ge=$t(Pe),Ve=$t(je),qe=$t($e),We=$t(Fe),He=we?we.prototype:void 0,Be=He?He.valueOf:void 0;function Re(g){var m=-1,j=g==null?0:g.length;for(this.clear();++m<j;){var k=g[m];this.set(k[0],k[1])}}function Ye(){this.__data__=Le?Le(null):{},this.size=0}function ke(g){var m=this.has(g)&&delete this.__data__[g];return this.size-=m?1:0,m}function V0(g){var m=this.__data__;if(Le){var j=m[g];return j===n?void 0:j}return ne.call(m,g)?m[g]:void 0}function q0(g){var m=this.__data__;return Le?m[g]!==void 0:ne.call(m,g)}function W0(g,m){var j=this.__data__;return this.size+=this.has(g)?0:1,j[g]=Le&&m===void 0?n:m,this}Re.prototype.clear=Ye,Re.prototype.delete=ke,Re.prototype.get=V0,Re.prototype.has=q0,Re.prototype.set=W0;function mt(g){var m=-1,j=g==null?0:g.length;for(this.clear();++m<j;){var k=g[m];this.set(k[0],k[1])}}function Y0(){this.__data__=[],this.size=0}function k0(g){var m=this.__data__,j=Vr(m,g);if(j<0)return!1;var k=m.length-1;return j==k?m.pop():Ot.call(m,j,1),--this.size,!0}function X0(g){var m=this.__data__,j=Vr(m,g);return j<0?void 0:m[j][1]}function J0(g){return Vr(this.__data__,g)>-1}function Z0(g,m){var j=this.__data__,k=Vr(j,g);return k<0?(++this.size,j.push([g,m])):j[k][1]=m,this}mt.prototype.clear=Y0,mt.prototype.delete=k0,mt.prototype.get=X0,mt.prototype.has=J0,mt.prototype.set=Z0;function jt(g){var m=-1,j=g==null?0:g.length;for(this.clear();++m<j;){var k=g[m];this.set(k[0],k[1])}}function Q0(){this.size=0,this.__data__={hash:new Re,map:new(Pe||mt),string:new Re}}function eg(g){var m=qr(this,g).delete(g);return this.size-=m?1:0,m}function tg(g){return qr(this,g).get(g)}function rg(g){return qr(this,g).has(g)}function ng(g,m){var j=qr(this,g),k=j.size;return j.set(g,m),this.size+=j.size==k?0:1,this}jt.prototype.clear=Q0,jt.prototype.delete=eg,jt.prototype.get=tg,jt.prototype.has=rg,jt.prototype.set=ng;function Gr(g){var m=-1,j=g==null?0:g.length;for(this.__data__=new jt;++m<j;)this.add(g[m])}function ig(g){return this.__data__.set(g,n),this}function sg(g){return this.__data__.has(g)}Gr.prototype.add=Gr.prototype.push=ig,Gr.prototype.has=sg;function Tt(g){var m=this.__data__=new mt(g);this.size=m.size}function og(){this.__data__=new mt,this.size=0}function ag(g){var m=this.__data__,j=m.delete(g);return this.size=m.size,j}function cg(g){return this.__data__.get(g)}function ug(g){return this.__data__.has(g)}function fg(g,m){var j=this.__data__;if(j instanceof mt){var k=j.__data__;if(!Pe||k.length<r-1)return k.push([g,m]),this.size=++j.size,this;j=this.__data__=new jt(k)}return j.set(g,m),this.size=j.size,this}Tt.prototype.clear=og,Tt.prototype.delete=ag,Tt.prototype.get=cg,Tt.prototype.has=ug,Tt.prototype.set=fg;function lg(g,m){var j=Wr(g),k=!j&&Tg(g),Ie=!j&&!k&&si(g),ie=!j&&!k&&!Ie&&Ra(g),Ne=j||k||Ie||ie,Xe=Ne?Ue(g.length,String):[],Qe=Xe.length;for(var Ce in g)(m||ne.call(g,Ce))&&!(Ne&&(Ce=="length"||Ie&&(Ce=="offset"||Ce=="parent")||ie&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||wg(Ce,Qe)))&&Xe.push(Ce);return Xe}function Vr(g,m){for(var j=g.length;j--;)if(Oa(g[j][0],m))return j;return-1}function hg(g,m,j){var k=m(g);return Wr(g)?k:de(k,j(g))}function br(g){return g==null?g===void 0?L:W:at&&at in Object(g)?vg(g):Og(g)}function wa(g){return vr(g)&&br(g)==u}function ma(g,m,j,k,Ie){return g===m?!0:g==null||m==null||!vr(g)&&!vr(m)?g!==g&&m!==m:dg(g,m,j,k,ma,Ie)}function dg(g,m,j,k,Ie,ie){var Ne=Wr(g),Xe=Wr(m),Qe=Ne?l:xt(g),Ce=Xe?l:xt(m);Qe=Qe==u?S:Qe,Ce=Ce==u?S:Ce;var ct=Qe==S,yt=Ce==S,tt=Qe==Ce;if(tt&&si(g)){if(!si(m))return!1;Ne=!0,ct=!1}if(tt&&!ct)return ie||(ie=new Tt),Ne||Ra(g)?Da(g,m,j,k,Ie,ie):pg(g,m,Qe,j,k,Ie,ie);if(!(j&i)){var lt=ct&&ne.call(g,"__wrapped__"),ht=yt&&ne.call(m,"__wrapped__");if(lt||ht){var It=lt?g.value():g,Dt=ht?m.value():m;return ie||(ie=new Tt),Ie(It,Dt,j,k,ie)}}return tt?(ie||(ie=new Tt),bg(g,m,j,k,Ie,ie)):!1}function gg(g){if(!Ia(g)||Dg(g))return!1;var m=Ta(g)?me:z;return m.test($t(g))}function _g(g){return vr(g)&&xa(g.length)&&!!Y[br(g)]}function yg(g){if(!Sg(g))return Kr(g);var m=[];for(var j in Object(g))ne.call(g,j)&&j!="constructor"&&m.push(j);return m}function Da(g,m,j,k,Ie,ie){var Ne=j&i,Xe=g.length,Qe=m.length;if(Xe!=Qe&&!(Ne&&Qe>Xe))return!1;var Ce=ie.get(g);if(Ce&&ie.get(m))return Ce==m;var ct=-1,yt=!0,tt=j&s?new Gr:void 0;for(ie.set(g,m),ie.set(m,g);++ct<Xe;){var lt=g[ct],ht=m[ct];if(k)var It=Ne?k(ht,lt,ct,m,g,ie):k(lt,ht,ct,g,m,ie);if(It!==void 0){if(It)continue;yt=!1;break}if(tt){if(!Ee(m,function(Dt,Ft){if(!ye(tt,Ft)&&(lt===Dt||Ie(lt,Dt,j,k,ie)))return tt.push(Ft)})){yt=!1;break}}else if(!(lt===ht||Ie(lt,ht,j,k,ie))){yt=!1;break}}return ie.delete(g),ie.delete(m),yt}function pg(g,m,j,k,Ie,ie,Ne){switch(j){case G:if(g.byteLength!=m.byteLength||g.byteOffset!=m.byteOffset)return!1;g=g.buffer,m=m.buffer;case H:return!(g.byteLength!=m.byteLength||!ie(new _t(g),new _t(m)));case _:case O:case U:return Oa(+g,+m);case p:return g.name==m.name&&g.message==m.message;case v:case o:return g==m+"";case A:var Xe=he;case d:var Qe=k&i;if(Xe||(Xe=ce),g.size!=m.size&&!Qe)return!1;var Ce=Ne.get(g);if(Ce)return Ce==m;k|=s,Ne.set(g,m);var ct=Da(Xe(g),Xe(m),k,Ie,ie,Ne);return Ne.delete(g),ct;case h:if(Be)return Be.call(g)==Be.call(m)}return!1}function bg(g,m,j,k,Ie,ie){var Ne=j&i,Xe=Sa(g),Qe=Xe.length,Ce=Sa(m),ct=Ce.length;if(Qe!=ct&&!Ne)return!1;for(var yt=Qe;yt--;){var tt=Xe[yt];if(!(Ne?tt in m:ne.call(m,tt)))return!1}var lt=ie.get(g);if(lt&&ie.get(m))return lt==m;var ht=!0;ie.set(g,m),ie.set(m,g);for(var It=Ne;++yt<Qe;){tt=Xe[yt];var Dt=g[tt],Ft=m[tt];if(k)var Ca=Ne?k(Ft,Dt,tt,m,g,ie):k(Dt,Ft,tt,g,m,ie);if(!(Ca===void 0?Dt===Ft||Ie(Dt,Ft,j,k,ie):Ca)){ht=!1;break}It||(It=tt=="constructor")}if(ht&&!It){var Yr=g.constructor,kr=m.constructor;Yr!=kr&&"constructor"in g&&"constructor"in m&&!(typeof Yr=="function"&&Yr instanceof Yr&&typeof kr=="function"&&kr instanceof kr)&&(ht=!1)}return ie.delete(g),ie.delete(m),ht}function Sa(g){return hg(g,Rg,Eg)}function qr(g,m){var j=g.__data__;return mg(m)?j[typeof m=="string"?"string":"hash"]:j.map}function Xt(g,m){var j=ge(g,m);return gg(j)?j:void 0}function vg(g){var m=ne.call(g,at),j=g[at];try{g[at]=void 0;var k=!0}catch{}var Ie=ve.call(g);return k&&(m?g[at]=j:delete g[at]),Ie}var Eg=Mt?function(g){return g==null?[]:(g=Object(g),pe(Mt(g),function(m){return bt.call(g,m)}))}:Cg,xt=br;(Me&&xt(new Me(new ArrayBuffer(1)))!=G||Pe&&xt(new Pe)!=A||je&&xt(je.resolve())!=R||$e&&xt(new $e)!=d||Fe&&xt(new Fe)!=P)&&(xt=function(g){var m=br(g),j=m==S?g.constructor:void 0,k=j?$t(j):"";if(k)switch(k){case Ke:return G;case Ge:return A;case Ve:return R;case qe:return d;case We:return P}return m});function wg(g,m){return m=m??c,!!m&&(typeof g=="number"||Z.test(g))&&g>-1&&g%1==0&&g<m}function mg(g){var m=typeof g;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?g!=="__proto__":g===null}function Dg(g){return!!be&&be in g}function Sg(g){var m=g&&g.constructor,j=typeof m=="function"&&m.prototype||te;return g===j}function Og(g){return ve.call(g)}function $t(g){if(g!=null){try{return _e.call(g)}catch{}try{return g+""}catch{}}return""}function Oa(g,m){return g===m||g!==g&&m!==m}var Tg=wa(function(){return arguments}())?wa:function(g){return vr(g)&&ne.call(g,"callee")&&!bt.call(g,"callee")},Wr=Array.isArray;function xg(g){return g!=null&&xa(g.length)&&!Ta(g)}var si=pr||Ag;function Ig(g,m){return ma(g,m)}function Ta(g){if(!Ia(g))return!1;var m=br(g);return m==E||m==C||m==f||m==b}function xa(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=c}function Ia(g){var m=typeof g;return g!=null&&(m=="object"||m=="function")}function vr(g){return g!=null&&typeof g=="object"}var Ra=le?Ae(le):_g;function Rg(g){return xg(g)?lg(g):yg(g)}function Cg(){return[]}function Ag(){return!1}t.exports=Ig})(ii,ii.exports);var j0=ii.exports,$0=Object.defineProperty,fa=Object.getOwnPropertySymbols,F0=Object.prototype.hasOwnProperty,B0=Object.prototype.propertyIsEnumerable,la=(t,e,r)=>e in t?$0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ha=(t,e)=>{for(var r in e||(e={}))F0.call(e,r)&&la(t,r,e[r]);if(fa)for(var r of fa(e))B0.call(e,r)&&la(t,r,e[r]);return t};class da extends Bu{constructor(e,r,n,i=vt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=xo,this.cached=[],this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(c=>{this.getKey&&c!==null&&!$r(c)?this.map.set(this.getKey(c),c):Cd(c)?this.map.set(c.id,c):Ad(c)&&this.map.set(c.topic,c)}),this.cached=[],this.initialized=!0)},this.set=async(c,u)=>{this.isInitialized(),this.map.has(c)?await this.update(c,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:c,value:u}),this.map.set(c,u),await this.persist())},this.get=c=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:c}),this.getData(c)),this.getAll=c=>(this.isInitialized(),c?this.values.filter(u=>Object.keys(c).every(l=>j0(u[l],c[l]))):this.values),this.update=async(c,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:c,update:u});const l=ha(ha({},this.getData(c)),u);this.map.set(c,l),await this.persist()},this.delete=async(c,u)=>{this.isInitialized(),this.map.has(c)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:c,reason:u}),this.map.delete(c),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ga{constructor(e,r){this.core=e,this.logger=r,this.name=Po,this.version=Lo,this.events=new ut.exports,this.initialized=!1,this.storagePrefix=vt,this.ignoredPayloadTypes=[qt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Bn(),i=await this.core.crypto.setSymKey(n),s=Mr(oe.FIVE_MINUTES),c={protocol:Eo},u={topic:i,expiry:s,relay:c,active:!1},l=Od({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:c});return await this.pairings.set(i,u),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:l}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:c}=md(n.uri);if(this.pairings.keys.includes(i))throw new Error(`Pairing already exists: ${i}`);if(this.core.crypto.hasKeys(i))throw new Error(`Keychain already exists: ${i}`);const u=Mr(oe.FIVE_MINUTES),l={topic:i,relay:c,expiry:u,active:!1};return await this.pairings.set(i,l),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:c}),this.core.expirer.set(i,u),n.activatePairing&&await this.activate({topic:i}),l},this.activate=async({topic:n})=>{this.isInitialized();const i=Mr(oe.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:c,resolve:u,reject:l}=hd();this.events.once(Kn("pairing_ping",s),({error:f})=>{f?l(f):u()}),await c()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",dr("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const c=ti(i,s),u=await this.core.crypto.encode(n,c),l=kt[i].req;return this.core.history.set(n,c),this.core.relayer.publish(n,u,l),c.id},this.sendResult=async(n,i,s)=>{const c=Xo(n,s),u=await this.core.crypto.encode(i,c),l=await this.core.history.get(i,n),f=kt[l.request.method].res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.sendError=async(n,i,s)=>{const c=Jo(n,s),u=await this.core.crypto.encode(i,c),l=await this.core.history.get(i,n),f=kt[l.request.method]?kt[l.request.method].res:kt.unregistered_method.res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,dr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>io(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,c=(await this.core.history.get(i,s.id)).request.method;switch(c){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(c)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{ta(i)?this.events.emit(Kn("pairing_ping",s),{}):zr(i)&&this.events.emit(Kn("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:c}=i;try{if(this.registeredMethods.includes(c))return;const u=dr("WC_METHOD_UNSUPPORTED",c);await this.sendError(s,n,u),this.logger.error(u)}catch(u){await this.sendError(s,n,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(dr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!Vn(n)){const{message:i}=xe("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!Rd(n.uri)){const{message:i}=xe("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!Vn(n)){const{message:s}=xe("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!Vn(n)){const{message:s}=xe("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!ao(n,!1)){const{message:i}=xe("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=xe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(io(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=xe("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new da(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ze.message,async e=>{const{topic:r,message:n}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);try{ea(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):ri(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:r,payload:i}),this.core.history.delete(r,i.id))}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(ft.expired,async e=>{const{topic:r}=_d(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class _a extends Mu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ut.exports.EventEmitter,this.name=No,this.version=Uo,this.cached=[],this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const c={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s,expiry:Mr(oe.THIRTY_DAYS)};this.records.set(c.id,c),this.events.emit(gt.created,c)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=zr(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(gt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(gt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ti(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(gt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(gt.created,e=>{const r=gt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(gt.updated,e=>{const r=gt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(gt.deleted,e=>{const r=gt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(Ht.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{oe.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ya extends Hu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ut.exports.EventEmitter,this.name=Mo,this.version=jo,this.cached=[],this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),c={target:s,expiry:i};this.expirations.set(s,c),this.checkExpiry(s,c),this.events.emit(ft.created,{target:s,expiration:c})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(ft.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return dd(e);if(typeof e=="number")return gd(e);const{message:r}=xe("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ft.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;oe.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(ft.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Ht.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ft.created,e=>{const r=ft.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ft.expired,e=>{const r=ft.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ft.deleted,e=>{const r=ft.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class pa extends Ku{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=Br,this.initialized=!1,this.init=async n=>{Zs()||!Qs()||(this.verifyUrl=n?.verifyUrl||Xn,await this.createIframe())},this.register=async n=>{var i;if(this.initialized||await this.init(),!!this.iframe)try{(i=this.iframe.contentWindow)==null||i.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var i;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const s=this.startAbortTimer(oe.FIVE_SECONDS),c=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(s),c.status===200?(i=await c.json())==null?void 0:i.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,i)=>{if(document.getElementById(Br))return n();const s=document.createElement("iframe");s.setAttribute("id",Br),s.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),s.style.display="none",s.addEventListener("load",()=>{this.initialized=!0,n()}),s.addEventListener("error",c=>{i(c)}),document.body.append(s),this.iframe=s}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),oe.toMiliseconds(oe.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Se.generateChildLogger(r,this.name),this.verifyUrl=Xn,this.abortController=new AbortController,this.isDevEnv=Hn()&&process.env.IS_VITEST}get context(){return Se.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),oe.toMiliseconds(e))}}var z0=Object.defineProperty,ba=Object.getOwnPropertySymbols,H0=Object.prototype.hasOwnProperty,K0=Object.prototype.propertyIsEnumerable,va=(t,e,r)=>e in t?z0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ea=(t,e)=>{for(var r in e||(e={}))H0.call(e,r)&&va(t,r,e[r]);if(ba)for(var r of ba(e))K0.call(e,r)&&va(t,r,e[r]);return t};class Hr extends Uu{constructor(e){super(e),this.protocol=qn,this.version=co,this.name=Fr,this.events=new ut.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Yn;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Se.pino(Se.getDefaultLoggerOptions({level:e?.logger||uo.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new Ht.HeartBeat,this.crypto=new Fo(this,this.logger,e?.keychain),this.history=new _a(this,this.logger),this.expirer=new ya(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new lc(Ea(Ea({},fo),e?.storageOptions)),this.relayer=new ua({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ga(this,this.logger),this.verify=new pa(this.projectId||"",this.logger)}static async init(e){const r=new Hr(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(Io,n),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const G0=Hr;X.CORE_CONTEXT=Fr,X.CORE_DEFAULT=uo,X.CORE_PROTOCOL=qn,X.CORE_STORAGE_OPTIONS=fo,X.CORE_STORAGE_PREFIX=vt,X.CORE_VERSION=co,X.CRYPTO_CLIENT_SEED=Wn,X.CRYPTO_CONTEXT=lo,X.CRYPTO_JWT_TTL=ho,X.Core=G0,X.Crypto=Fo,X.EXPIRER_CONTEXT=Mo,X.EXPIRER_DEFAULT_TTL=Ud,X.EXPIRER_EVENTS=ft,X.EXPIRER_STORAGE_VERSION=jo,X.Expirer=ya,X.HISTORY_CONTEXT=No,X.HISTORY_EVENTS=gt,X.HISTORY_STORAGE_VERSION=Uo,X.JsonRpcHistory=_a,X.KEYCHAIN_CONTEXT=go,X.KEYCHAIN_STORAGE_VERSION=_o,X.KeyChain=$o,X.MESSAGES_CONTEXT=yo,X.MESSAGES_STORAGE_VERSION=po,X.MessageTracker=Bo,X.PAIRING_CONTEXT=Po,X.PAIRING_DEFAULT_TTL=Nd,X.PAIRING_RPC_OPTS=kt,X.PAIRING_STORAGE_VERSION=Lo,X.PENDING_SUB_RESOLUTION_TIMEOUT=Ao,X.PUBLISHER_CONTEXT=vo,X.PUBLISHER_DEFAULT_TTL=bo,X.Pairing=ga,X.RELAYER_CONTEXT=mo,X.RELAYER_DEFAULT_LOGGER=wo,X.RELAYER_DEFAULT_PROTOCOL=Eo,X.RELAYER_DEFAULT_RELAY_URL=Yn,X.RELAYER_EVENTS=ze,X.RELAYER_FAILOVER_RELAY_URL=kn,X.RELAYER_PROVIDER_EVENTS=Yt,X.RELAYER_RECONNECT_TIMEOUT=So,X.RELAYER_SDK_VERSION=Oo,X.RELAYER_STORAGE_OPTIONS=Pd,X.RELAYER_SUBSCRIBER_SUFFIX=Do,X.RELAYER_TRANSPORT_CUTOFF=To,X.Relayer=ua,X.STORE_STORAGE_VERSION=xo,X.SUBSCRIBER_CONTEXT=Ro,X.SUBSCRIBER_DEFAULT_TTL=Ld,X.SUBSCRIBER_EVENTS=dt,X.SUBSCRIBER_STORAGE_VERSION=Co,X.Store=da,X.Subscriber=oa,X.VERIFY_CONTEXT=Br,X.VERIFY_SERVER=Xn,X.Verify=pa,X.WALLETCONNECT_CLIENT_ID=Io,X.default=Hr,Object.defineProperty(X,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
